var Pe,x,ne,et=Object.defineProperty,tt=Object.defineProperties,nt=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertySymbols,st=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable,Fe=(e,t,n)=>t in e?et(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t=t||{})st.call(t,n)&&Fe(e,n,t[n]);if(De)for(var n of De(t))ot.call(t,n)&&Fe(e,n,t[n]);return e},D=(e,t)=>tt(e,nt(t));import{r as c,c as y,R as s,f as Ae,E as Le,a as le,b as at,d as _,e as fe,u as Ie,g as rt,h as $,i as Be,j as he,Z as G,k as lt,l as Ee,m as ct,n as xe,o as it,p as ut,q as mt,s as ee,t as dt,A as pt,F as ft,v as ht,N as Et,S as xt,w as Te,x as yt,H as gt}from"./vendor.ca4c5569.js";const vt=function(){var e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const n of t.addedNodes)"LINK"===n.tagName&&"modulepreload"===n.rel&&s(n)}).observe(document,{childList:!0,subtree:!0})}function s(e){var t,n;e.ep||(e.ep=!0,n={},(t=e).integrity&&(n.integrity=t.integrity),t.referrerpolicy&&(n.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?n.credentials="include":"anonymous"===t.crossorigin?n.credentials="omit":n.credentials="same-origin",fetch(e.href,n))}};function X(){return"ClashX Runtime"===navigator.userAgent}vt();let N=null;class wt{constructor(t){(this.instance=null)!=window.WebViewJavascriptBridge&&(this.instance=window.WebViewJavascriptBridge),this.initBridge(e=>{this.instance=e,t()})}initBridge(e){if(!X())return null==e?void 0:e(null);if(null!=window.WebViewJavascriptBridge)return e(window.WebViewJavascriptBridge);if(null!=window.WVJBCallbacks)return window.WVJBCallbacks.push(e);window.WVJBCallbacks=[e];const t=document.createElement("iframe");t.style.display="none",t.src="https://__bridge_loaded__",document.documentElement.appendChild(t),setTimeout(()=>document.documentElement.removeChild(t),0)}async callHandler(n,s){return new Promise(e=>{var t;null!=(t=this.instance)&&t.callHandler(n,s,e)})}async ping(){return this.callHandler("ping")}async readConfigString(){return this.callHandler("readConfigString")}async getPasteboard(){return this.callHandler("getPasteboard")}async getAPIInfo(){return this.callHandler("apiInfo")}async setPasteboard(e){return this.callHandler("setPasteboard",e)}async writeConfigWithString(e){return this.callHandler("writeConfigWithString",e)}async setSystemProxy(e){return this.callHandler("setSystemProxy",e)}async getStartAtLogin(){return this.callHandler("getStartAtLogin")}async getProxyDelay(e){return this.callHandler("speedTest",e)}async setStartAtLogin(e){return this.callHandler("setStartAtLogin",e)}async isSystemProxySet(){return this.callHandler("isSystemProxySet")}}function Ct(e){null!=N?e():N=new wt(e)}function z(e){var{title:e,children:t,className:n,style:s}=e;return c.exports.createElement("header",{className:y("header",n),style:s},c.exports.createElement("h1",{className:"md:text-xl"},e),c.exports.createElement("div",{className:"flex flex-auto items-center justify-end"},t))}function R(e){var{type:t,size:n=14,className:s,style:a}=e,t=y("clash-iconfont","icon-"+t,s),s=b({fontSize:n},a),n=D(b({},e),{className:t,style:s});return c.exports.createElement("i",b({},n))}function W(){}function bt(e,t){var n=[],s=[];for(const a of e)(t(a)?n:s).push(a);return[n,s]}function M(e){var t=["B","KB","MB","GB","TB"];let n=0;for(;~~(e/1024)&&n<t.length;)e/=1024,n++;return`${0===n?e:e.toFixed(2)} `+t[n]}function ye(e){const{className:t,checked:n=!1,disabled:s=!1,onChange:a=W}=e,o=y("switch",{checked:n,disabled:s},t);return c.exports.createElement("div",{className:o,onClick:function(){s||a(!n)}},c.exports.createElement(R,{className:"switch-icon font-bold",type:"check",size:20}))}const H=c.exports.forwardRef((e,t)=>{var{className:e,style:n,children:a}=e;return s.createElement("div",{className:y("card",e),style:n,ref:t},a)});function $e(e){const{options:t,value:n,onSelect:s}=e;return c.exports.createElement("div",{className:"button-select"},t.map(e=>c.exports.createElement("button",{value:e.value,key:e.value,className:y("button-select-options",{actived:n===e.value}),onClick:()=>null==s?void 0:s(e.value)},e.label)))}const Nt={SideBar:{Proxies:"Proxies",Overview:"Overview",Logs:"Logs",Rules:"Rules",Settings:"Setting",Connections:"Connections",Version:"Version"},Settings:{title:"Settings",labels:{startAtLogin:"Start at login",language:"language",setAsSystemProxy:"Set as system proxy",allowConnectFromLan:"Allow connect from Lan",proxyMode:"Mode",socks5ProxyPort:"Socks5 proxy port",httpProxyPort:"HTTP proxy port",mixedProxyPort:"Mixed proxy port",externalController:"External controller"},values:{cn:"中文",en:"English",global:"Global",rules:"Rules",direct:"Direct",script:"Script"},versionString:"Current ClashX is the latest version：{{version}}",checkUpdate:"Check Update",externalControllerSetting:{title:"External Controller",note:"Please note that modifying this configuration will only configure Dashboard. Will not modify your Clash configuration file. Please make sure that the external controller address matches the address in the Clash configuration file, otherwise, Dashboard will not be able to connect to Clash.",host:"Host",port:"Port",secret:"Secret"}},Logs:{title:"Logs"},Rules:{title:"Rules",providerTitle:"Providers",providerUpdateTime:"Last updated at",ruleCount:"Rule count"},Connections:{title:"Connections",keepClosed:"Keep closed connections",total:{text:"total",upload:"upload",download:"download"},closeAll:{title:"Warning",content:"This would close all connections"},filter:{all:"All"},columns:{host:"Host",network:"Network",type:"Type",chains:"Chains",rule:"Rule",time:"Time",speed:"Speed",upload:"Upload",download:"Download",sourceIP:"Source IP"},info:{title:"Connection",id:"ID",host:"Host",hostEmpty:"Empty",dstIP:"IP",dstIPEmpty:"Empty",srcIP:"Source",upload:"Upload",download:"Download",network:"Network",inbound:"Inbound",rule:"Rule",chains:"Chains",status:"Status",opening:"Open",closed:"Closed",closeConnection:"Close"}},Proxies:{title:"Proxies",editDialog:{title:"Edit Proxy",color:"Color",name:"Name",type:"Type",server:"Server",port:"Port",password:"Password",cipher:"Cipher",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"Policy Group",providerTitle:"Providers",providerUpdateTime:"Last updated at",expandText:"Expand",collapseText:"Collapse",speedTestText:"Speed Test",breakConnectionsText:"Close connections which include the group"},Modal:{ok:"Ok",cancel:"Cancel"}},Pt={SideBar:{Proxies:"代理",Overview:"总览",Logs:"日志",Rules:"规则",Settings:"设置",Connections:"连接",Version:"版本"},Settings:{title:"设置",labels:{startAtLogin:"开机时启动",language:"语言",setAsSystemProxy:"设置为系统代理",allowConnectFromLan:"允许来自局域网的连接",proxyMode:"代理模式",socks5ProxyPort:"Socks5 代理端口",httpProxyPort:"HTTP 代理端口",mixedProxyPort:"混合代理端口",externalController:"外部控制设置"},values:{cn:"中文",en:"English",global:"全局",rules:"规则",direct:"直连",script:"脚本"},versionString:"当前 ClashX 已是最新版本：{{version}}",checkUpdate:"检查更新",externalControllerSetting:{title:"编辑外部控制设置",note:"请注意，修改该配置项并不会修改你的 Clash 配置文件，请确认修改后的外部控制地址和 Clash 配置文件内的地址一致，否则会导致 Dashboard 无法连接。",host:"Host",port:"端口",secret:"密钥"}},Logs:{title:"日志"},Rules:{title:"规则",providerTitle:"规则集",providerUpdateTime:"最后更新于",ruleCount:"规则条数"},Connections:{title:"连接",keepClosed:"保留关闭连接",total:{text:"总量",upload:"上传",download:"下载"},closeAll:{title:"警告",content:"将会关闭所有连接"},filter:{all:"全部"},columns:{host:"域名",network:"网络",type:"类型",chains:"节点链",rule:"规则",time:"连接时间",speed:"速率",upload:"上传",download:"下载",sourceIP:"来源 IP"},info:{title:"连接信息",id:"ID",host:"域名",hostEmpty:"空",dstIP:"IP",dstIPEmpty:"空",srcIP:"来源",upload:"上传",download:"下载",network:"网络",inbound:"入口",rule:"规则",chains:"代理",status:"状态",opening:"连接中",closed:"已关闭",closeConnection:"关闭连接"}},Proxies:{title:"代理",editDialog:{title:"编辑代理",color:"颜色",name:"名字",type:"类型",server:"服务器",port:"端口",password:"密码",cipher:"加密方式",obfs:"Obfs","obfs-host":"Obfs-host",uuid:"UUID",alterId:"AlterId",tls:"TLS"},groupTitle:"策略组",providerTitle:"代理集",providerUpdateTime:"最后更新于",expandText:"展开",collapseText:"收起",speedTestText:"测速",breakConnectionsText:"切换时打断包含策略组的连接"},Modal:{ok:"确 定",cancel:"取 消"}},Re={en_US:Nt,zh_CN:Pt},St=Object.keys(Re);function kt(){for(const e of window.navigator.languages){if(e.includes("zh"))return"zh_CN";if(e.includes("us"))return"en_US"}return"en_US"}function ge(e){return c.exports.useMemo(()=>{return function(a,t){if("string"==typeof a)e(e=>{e[a]=t});else if("function"==typeof a){const n=a;e(e=>n(e))}else"object"==typeof a&&e(e=>Ae(e,e=>{var t=a;for(const s of Object.keys(t)){var n=s;e[n]=t[n]}}))}},[e])}class Me{constructor(e){this.EE=new Le,this.innerBuffer=[],this.isClose=!1,this.config=Object.assign({bufferLength:0,retryInterval:5e3,headers:{}},e),this.config.useWebsocket?this.websocketLoop():this.loop()}websocketLoop(){var e=new URL(this.config.url),t=(e.protocol="http:"===e.protocol?"ws:":"wss:",e.searchParams.set("token",null!=(t=this.config.token)?t:""),new WebSocket(e.toString()));t.addEventListener("message",e=>{e=JSON.parse(e.data);this.EE.emit("data",[e]),0<this.config.bufferLength&&(this.innerBuffer.push(e),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}),t.addEventListener("close",()=>setTimeout(this.websocketLoop,this.config.retryInterval)),t.addEventListener("error",e=>{this.EE.emit("error",e),setTimeout(this.websocketLoop,this.config.retryInterval)})}async loop(){var e=await le.fromPromise(fetch(this.config.url,{mode:"cors",headers:this.config.token?{Authorization:"Bearer "+this.config.token}:{}}),e=>e);if(e.isErr())this.retry(e.error);else if(null==e.value.body)this.retry(new Error("fetch body error"));else for(var t=e.value.body.getReader(),n=new TextDecoder;!this.isClose;){var s=await le.fromPromise(null==t?void 0:t.read(),e=>e);if(s.isErr()){this.retry(s.error);break}s=n.decode(s.value.value).trim().split(`
`).map(e=>JSON.parse(e));this.EE.emit("data",s),0<this.config.bufferLength&&(this.innerBuffer.push(...s),this.innerBuffer.length>this.config.bufferLength&&this.innerBuffer.splice(0,this.innerBuffer.length-this.config.bufferLength))}}retry(e){this.isClose||(this.EE.emit("error",e),window.setTimeout(()=>{this.loop()},this.config.retryInterval))}subscribe(e,t){this.EE.addListener(e,t)}unsubscribe(e,t){this.EE.removeListener(e,t)}buffer(){return this.innerBuffer.slice()}destory(){this.EE.removeAllListeners(),this.isClose=!0}}class Dt{constructor(e,t){this.axiosClient=at.create({baseURL:e,headers:t?{Authorization:"Bearer "+t}:{}})}async getConfig(){return this.axiosClient.get("configs")}async updateConfig(e){return this.axiosClient.patch("configs",e)}async getRules(){return this.axiosClient.get("rules")}async getProxyProviders(){var e=await this.axiosClient.get("providers/proxies",{validateStatus(e){return 200<=e&&e<300||404===e}});return 404===e.status&&(e.data={providers:{}}),e}async getRuleProviders(){return this.axiosClient.get("providers/rules")}async updateProvider(e){return this.axiosClient.put("providers/proxies/"+encodeURIComponent(e))}async updateRuleProvider(e){return this.axiosClient.put("providers/rules/"+encodeURIComponent(e))}async healthCheckProvider(e){return this.axiosClient.get(`providers/proxies/${encodeURIComponent(e)}/healthcheck`)}async getProxies(){return this.axiosClient.get("proxies")}async getProxy(e){return this.axiosClient.get("proxies/"+encodeURIComponent(e))}async getVersion(){return this.axiosClient.get("version")}async getProxyDelay(e){return this.axiosClient.get(`proxies/${encodeURIComponent(e)}/delay`,{params:{timeout:5e3,url:"http://www.gstatic.com/generate_204"}})}async closeAllConnections(){return this.axiosClient.delete("connections")}async closeConnection(e){return this.axiosClient.delete("connections/"+e)}async getConnections(){return this.axiosClient.get("connections")}async changeProxySelected(e,t){return this.axiosClient.put("proxies/"+encodeURIComponent(e),{name:t})}}const Ft=_(async()=>{var e;return X()?{hostname:(e=await N.getAPIInfo()).host,port:e.port,secret:e.secret,protocol:"http:"}:null}),He=fe("externalControllers",[]);function te(){var e=Ie(Ft),t=rt(),n=Ie(He);if(null!=e)return e;let s;var e=document.querySelector('meta[name="external-controller"]'),a=(null!=(null==(a=null==e?void 0:e.content)?void 0:a.match(/^https?:/))&&(s=new URL(e.content)),new URLSearchParams(t.search)),e=null!=(t=null!=(e=null!=(e=a.get("host"))?e:null==(t=null==n?void 0:n[0])?void 0:t.hostname)?e:null==s?void 0:s.hostname)?t:"127.0.0.1";return{hostname:e,port:null!=(t=null!=(t=null!=(t=a.get("port"))?t:null==(t=null==n?void 0:n[0])?void 0:t.port)?t:null==s?void 0:s.port)?t:"9090",secret:null!=(t=null!=(n=null!=(t=a.get("secret"))?t:null==(t=null==n?void 0:n[0])?void 0:t.secret)?n:null==s?void 0:s.username)?t:"",protocol:(null!=(n=a.get("protocol"))?n:"127.0.0.1"===e)?"http:":null!=(t=null==s?void 0:s.protocol)?t:window.location.protocol}}const At=_({key:"",instance:null});function L(){var{hostname:e,port:t,secret:n,protocol:s}=te(),[a,o]=$(At),l=s+`//${e}:${t}?secret=`+n;return a.key===l?a.instance:(o({key:l,instance:a=new Dt(s+`//${e}:`+t,n)}),a)}const ve=_(!0),Lt=fe("language",void 0);function S(){const[e,t]=$(Lt),n=c.exports.useMemo(()=>null!=e?e:kt(),[e]),s=c.exports.useCallback(function(t){return{t:function(e){return lt(Re[n][t],e)}}},[n]);return{lang:n,locales:St,setLang:t,translation:s}}const Ue=_({version:"",premium:!1});function ce(){const[e,t]=$(Ue),n=L(),s=he(ve);return G([n],async function(){var e=await le.fromPromise(n.getVersion(),e=>e);s(e.isOk()),t(e.isErr()?{version:"",premium:!1}:{version:e.value.data.version,premium:!!e.value.data.premium})}),e}function Oe(){const[{premium:e}]=$(Ue),n=L(),{data:t,mutate:s}=G(["/providers/rule",n,e],async()=>{if(!e)return[];const t=await n.getRuleProviders();return Object.keys(t.data.providers).map(e=>t.data.providers[e])});return{providers:null!=t?t:[],update:s}}const It=fe("profile",{breakConnections:!1});function ze(){const[t,n]=$(It),e=c.exports.useCallback(e=>{n(Ae(t,e))},[t,n]);return{data:t,set:ge(e)}}const We=_([]);function je(){const[e,t]=$(We),n=L(),{data:s,mutate:a}=G(["/providers/proxy",n],async()=>{const t=await n.getProxyProviders();return Object.keys(t.data.providers).map(e=>t.data.providers[e]).filter(e=>"default"!==e.name).filter(e=>"Compatible"!==e.vehicleType)});return c.exports.useEffect(()=>t(null!=s?s:[]),[s,t]),{providers:e,update:a}}function we(){const n=L(),{data:e,mutate:t}=G(["/config",n],async()=>{var e,t=(await n.getConfig()).data;return{port:t.port,socksPort:t["socks-port"],mixedPort:null!=(e=t["mixed-port"])?e:0,redirPort:t["redir-port"],mode:t.mode.toLowerCase(),logLevel:t["log-level"],allowLan:t["allow-lan"]}});return{general:null!=e?e:{},update:t}}const _e=Be({proxies:[],groups:[],global:{name:"GLOBAL",type:"Selector",now:"",history:[],all:[]}});function ie(){const[e,t]=$(_e),r=ge(t),i=L(),n=G(["/proxies",i],async()=>{const t=await i.getProxies(),e=t.data.proxies.GLOBAL,n=(e.name="GLOBAL",new Set(["Selector","URLTest","Fallback","LoadBalance"])),s=new Set(["DIRECT","REJECT","GLOBAL"]),a=e.all.filter(e=>!s.has(e)).map(e=>D(b({},t.data.proxies[e]),{name:e})),[o,l]=bt(a,e=>!n.has(e.type));r({proxies:o,groups:l,global:e})})["mutate"],s=c.exports.useCallback((n,s)=>{r(e=>{"GLOBAL"===n&&(e.global.now=s);for(const t of e.groups)t.name===n&&(t.now=s)})},[r]);return{proxies:e.proxies,groups:e.groups,global:e.global,update:n,markProxySelected:s,set:r}}const Bt=_(e=>{var t=e(_e),e=e(We),n=new Map;for(const s of t.proxies)n.set(s.name,s);for(const a of e)for(const o of a.proxies)n.set(o.name,o);return n});function Ge(){var{data:e,mutate:t}=G("/clashx",async()=>{var e;return X()?{startAtLogin:null!=(e=await(null==N?void 0:N.getStartAtLogin()))&&e,systemProxy:null!=(e=await(null==N?void 0:N.isSystemProxySet()))&&e,isClashX:!0}:{isClashX:!1,startAtLogin:!1,systemProxy:!1}});return{data:e,update:t}}const Tt=Be([]);function $t(){const[e,t]=$(Tt),n=ge(t),s=L();return{rules:e,update:async function(){var e=await s.getRules();n(e.data.rules)}}}const Rt=_({key:"",instance:null});function Ve(){var e,t=te(),n=we()["general"],s=ce(),[a,o]=$(Rt);return s.version&&n.logLevel?(s=!!s.version||!0,e=`${t.protocol}//${t.hostname}:${t.port}/logs?level=${null!=(e=n.logLevel)?e:""}&useWebsocket=${s}&secret=`+t.secret,a.key===e?a.instance:(a=a.instance,n=`${t.protocol}//${t.hostname}:${t.port}/logs?level=`+(null!=(n=n.logLevel)?n:""),o({key:e,instance:o=new Me({url:n,bufferLength:200,token:t.secret,useWebsocket:s})}),null!=a&&a.destory(),o)):null}function Mt(){const e=te(),t=ce(),n=!!t.version||!0,s=`${e.protocol}//${e.hostname}:${e.port}/connections`;return c.exports.useMemo(()=>t.version?new Me({url:s,bufferLength:200,token:e.secret,useWebsocket:n}):null,[e.secret,s,n,t.version])}function Ht(e){const{className:t,data:n,onClick:a,select:o,canClick:l,errSet:r,rowHeight:i}=e,m=S()["translation"],d=m("Proxies")["t"],[u,p]=c.exports.useState(!1),[f,x]=c.exports.useState(!1),h=c.exports.useRef(null),v=(c.exports.useLayoutEffect(()=>{var e;x(30<(null!=(e=null==(e=null==h?void 0:h.current)?void 0:e.offsetHeight)?e:0))},[]),u?"auto":i),g=l?a:W;e=n.map(e=>{var t=y({"tags-selected":o===e,"cursor-pointer":l,error:null==r?void 0:r.has(e)});return s.createElement("li",{className:t,key:e,onClick:()=>g(e)},e)});return s.createElement("div",{className:y("flex items-start overflow-y-hidden",t),style:{height:v}},s.createElement("ul",{ref:h,className:y("tags",{expand:u})},e),f&&s.createElement("span",{className:"h-7 px-5 select-none cursor-pointer leading-7",onClick:function(){p(!u)}},d(u?"collapseText":"expandText")))}function Y(e){const{className:t,style:n,value:s="",align:a="center",inside:o=!1,autoFocus:l=!1,type:r="text",disabled:i=!1,onChange:m=W,onBlur:d=W}=e,u=y("input","text-"+a,{"focus:shadow-none":o},t);return c.exports.createElement("input",{disabled:i,className:u,style:n,value:s,autoFocus:l,type:r,onChange:e=>m(e.target.value,e),onBlur:d})}function Je(e){const{show:t=!0,title:n="Modal",size:a="small",footer:o=!0,onOk:l=W,onClose:r=W,bodyClassName:i,bodyStyle:m,className:d,style:u,children:p}=e,f=S()["translation"],x=f("Modal")["t"],h=c.exports.useRef(document.createElement("div")),v=c.exports.useRef(null);c.exports.useLayoutEffect(()=>{const e=h.current;return document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);e=s.createElement("div",{className:y("modal-mask",{"modal-show":t}),ref:v,onMouseDown:function(e){e.target===v.current&&r()}},s.createElement("div",{className:y("modal","modal-"+a,d),style:u},s.createElement("div",{className:"modal-title"},n),s.createElement("div",{className:y("modal-body",i),style:m},p),o&&s.createElement("div",{className:"footer"},s.createElement(Ce,{onClick:()=>r()},x("cancel")),s.createElement(Ce,{type:"primary",onClick:()=>l()},x("ok")))));return Ee.exports.createPortal(e,h.current)}const Ut={success:"check",info:"info",warning:"info",error:"close"};function Ot(e){var{message:e="",type:t="info",inside:n=!1,children:a,className:o,style:l}=e,n=y("alert",`alert-${n?"note":"box"}-`+t,o);return s.createElement("div",{className:n,style:l},s.createElement("span",{className:"alert-icon"},s.createElement(R,{type:Ut[t],size:26})),e?s.createElement("p",{className:"alert-message"},e):s.createElement("div",{className:"alert-message"},a))}function Ce(e){var{type:e="normal",onClick:t=W,children:n,className:a,style:o,disiabled:l}=e,e=y("button","button-"+e,a,{"button-disabled":l});return s.createElement("button",{className:e,style:o,onClick:t,disabled:l},n)}function ue(e){const[t,n]=ct(e),s=c.exports.useMemo(()=>{return function(a,t){"string"==typeof a?n(e=>{e[a]=t}):"function"==typeof a?n(a):"object"==typeof a&&n(e=>{var t=a;for(const s of Object.keys(t)){var n=s;e[n]=t[n]}})}},[n]);return[t,s]}function zt(e,t=0){if(e.length<2)throw new Error("List requires at least two elements");const[n,s]=c.exports.useState(t);return{current:c.exports.useMemo(()=>e[n],[e,n]),next:function(){s((n+1)%e.length)}}}function be(e=!1){const[t,n]=c.exports.useState(e);return{visible:t,hide:function(){n(!1)},show:function(){n(!0)}}}function Xe(e){const{className:t,checked:n=!1,onChange:s=W}=e,a=y("checkbox",{checked:n},t);return c.exports.createElement("div",{className:a,onClick:function(){s(!n)}},c.exports.createElement(R,{className:"checkbox-icon",type:"check",size:18}),c.exports.createElement("div",null,e.children))}function me(e){var{color:t,className:n,style:s}=e,n=y("tag",n),t=b({color:t},s),s=D(b({},e),{className:n,style:t});return c.exports.createElement("span",b({},s),e.children)}function Wt(e){e=y("spinner",e.className);return c.exports.createElement("div",{className:e},c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})),c.exports.createElement("div",{className:"spinner-circle"},c.exports.createElement("div",{className:"spinner-inner"})))}function Ye(e){var t=y("loading","visible",e.className);return e.visible?s.createElement("div",{className:t},s.createElement(Wt,{className:e.spinnerClassName})):null}function jt(e){const t=c.exports.useRef(document.createElement("div"));c.exports.useLayoutEffect(()=>{const e=t.current;return document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);var n=s.createElement("div",{className:y(e.className,"absolute inset-0 pointer-events-none z-9999")},s.createElement(H,{className:y("absolute h-full right-0 transition-transform transform translate-x-full duration-100 pointer-events-auto",{"translate-x-0":e.visible}),style:{width:null!=(n=e.width)?n:400}},e.children));return Ee.exports.createPortal(n,null!=(e=null==(n=e.containerRef)?void 0:n.current)?e:t.current)}function Ne(e,t){t="en_US"===t?"en":"zh-cn";return xe().locale(t).from(e)}function _t(n){const e=S()["translation"],t=c.exports.useMemo(()=>e("Connections").t,[e]),{className:a,style:o}=n,l=y("flex flex-wrap px-1",a);function r(e){var t;null!=(t=n.onChange)&&t.call(n,e)}return s.createElement("div",{className:l,style:o},s.createElement("div",{className:y("connections-devices-item pt-2 mb-2",{selected:""===n.selected}),onClick:()=>r("")},t("filter.all")),n.devices.map(e=>s.createElement("div",{key:e.label,className:y("connections-devices-item pt-2 mb-2",{selected:n.selected===e.label}),onClick:()=>r(e.label)},e.label," (",e.number,")")))}function Gt(e){var t;const n=S()["translation"],a=c.exports.useMemo(()=>n("Connections").t,[n]);return s.createElement("div",{className:y(e.className,"text-sm flex flex-col")},s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.id")),s.createElement("span",{className:"font-mono"},e.connection.id)),s.createElement("div",{className:"flex justify-between my-3"},s.createElement("div",{className:"flex flex-1"},s.createElement("span",{className:"w-14 font-bold"},a("info.network")),s.createElement("span",{className:"font-mono"},null==(t=e.connection.metadata)?void 0:t.network)),s.createElement("div",{className:"flex flex-1"},s.createElement("span",{className:"w-14 font-bold"},a("info.inbound")),s.createElement("span",{className:"font-mono"},null==(t=e.connection.metadata)?void 0:t.type))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.host")),s.createElement("span",{className:"font-mono flex-1 break-all"},null!=(t=e.connection.metadata)&&t.host?e.connection.metadata.host+":"+(null==(t=e.connection.metadata)?void 0:t.destinationPort):a("info.hostEmpty"))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.dstIP")),s.createElement("span",{className:"font-mono"},null!=(t=e.connection.metadata)&&t.destinationIP?e.connection.metadata.destinationIP+":"+(null==(t=e.connection.metadata)?void 0:t.destinationPort):a("info.hostEmpty"))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.srcIP")),s.createElement("span",{className:"font-mono"},`${null==(t=e.connection.metadata)?void 0:t.sourceIP}:`+(null==(t=e.connection.metadata)?void 0:t.sourcePort))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.rule")),s.createElement("span",{className:"font-mono"},e.connection.rule&&""+e.connection.rule+(e.connection.rulePayload&&`(${e.connection.rulePayload})`))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.chains")),s.createElement("span",{className:"font-mono flex-1 break-all"},null==(t=e.connection.chains)?void 0:t.slice().reverse().join(" / "))),s.createElement("div",{className:"flex justify-between my-3"},s.createElement("div",{className:"flex flex-1"},s.createElement("span",{className:"w-14 font-bold"},a("info.upload")),s.createElement("span",{className:"font-mono"},M(null!=(t=e.connection.upload)?t:0))),s.createElement("div",{className:"flex flex-1"},s.createElement("span",{className:"w-14 font-bold"},a("info.download")),s.createElement("span",{className:"font-mono"},M(null!=(t=e.connection.download)?t:0)))),s.createElement("div",{className:"flex my-3"},s.createElement("span",{className:"w-14 font-bold"},a("info.status")),s.createElement("span",{className:"font-mono"},e.connection.completed?s.createElement("span",{className:"text-red"},a("info.closed")):s.createElement("span",{className:"text-green"},a("info.opening")))))}xe.extend(it),function(e){e.Domain="Domain",e.DomainSuffix="DomainSuffix",e.DomainKeyword="DomainKeyword",e.GeoIP="GeoIP",e.IPCIDR="IPCIDR",e.SrcIPCIDR="SrcIPCIDR",e.SrcPort="SrcPort",e.DstPort="DstPort",e.MATCH="MATCH",e.RuleSet="RuleSet"}(Pe=Pe||{});class Vt{constructor(){this.connections=new Map,this.saveDisconnection=!1}appendToSet(e){var t,n,s,a,o=e.reduce((e,t)=>e.set(t.id,t),new Map);for(const l of this.connections.keys())o.has(l)||(this.saveDisconnection?null!=(n=this.connections.get(l))&&(n.completed=!0,n.uploadSpeed=0,n.downloadSpeed=0):this.connections.delete(l));for(const r of o.keys())this.connections.has(r)?(s=this.connections.get(r),a=o.get(r),null!=(t=this.connections)&&t.set(r,D(b({},a),{uploadSpeed:a.upload-s.upload,downloadSpeed:a.download-s.download}))):this.connections.set(r,D(b({},o.get(r)),{uploadSpeed:0,downloadSpeed:0}))}toggleSave(){var e;if(this.saveDisconnection){this.saveDisconnection=!1;for(const t of this.connections.keys())null!=(e=null==(e=this.connections)?void 0:e.get(t))&&e.completed&&this.connections.delete(t)}else this.saveDisconnection=!0;return this.saveDisconnection}getConnections(){return[...this.connections.values()]}}function Jt(){const t=c.exports.useMemo(()=>new Vt,[]),n=c.exports.useRef(!0),[e,s]=c.exports.useState([]),[a,o]=c.exports.useState(!1),l=c.exports.useCallback(function(e){t.appendToSet(e),n.current&&s(t.getConnections()),n.current=!n.current},[t]),r=c.exports.useCallback(function(){var e=t.toggleSave();o(e),e||s(t.getConnections()),n.current=!0},[t]);return{connections:e,feed:l,toggleSave:r,save:a}}!function(e){e.Host="host",e.Network="network",e.Type="type",e.Chains="chains",e.Rule="rule",e.Speed="speed",e.Upload="upload",e.Download="download",e.SourceIP="sourceIP",e.Time="time"}(x=x||{});const Xt=new Set([x.Network,x.Type,x.Rule,x.Speed,x.Upload,x.Download,x.SourceIP,x.Time]);function Yt(e,t){switch(!0){case 0===e&&0===t:return"-";case 0!==e&&0!==t:return`↑ ${M(e)}/s ↓ ${M(t)}/s`;case 0!==e:return`↑ ${M(e)}/s`;default:return`↓ ${M(t)}/s`}}function qt(){const{translation:e,lang:t}=S(),n=c.exports.useMemo(()=>e("Connections").t,[e]),a=Mt(),o=L(),l=c.exports.useRef(null),[r,i]=ue({uploadTotal:0,downloadTotal:0}),{visible:m,show:d,hide:u}=be();const{connections:p,feed:f,save:h,toggleSave:v}=Jt(),g=c.exports.useMemo(()=>p.map(e=>({id:e.id,host:`${e.metadata.host||e.metadata.destinationIP}:`+e.metadata.destinationPort,chains:e.chains.slice().reverse().join(" / "),rule:e.rule===Pe.RuleSet?`${e.rule}(${e.rulePayload})`:e.rule,time:new Date(e.start).getTime(),upload:e.upload,download:e.download,sourceIP:e.metadata.sourceIP,type:e.metadata.type,network:e.metadata.network.toUpperCase(),speed:{upload:e.uploadSpeed,download:e.downloadSpeed},completed:!!e.completed,original:e})),[p]),E=c.exports.useMemo(()=>{const t=ut(p,"metadata.sourceIP");return Object.keys(t).map(e=>({label:e,number:t[e].length})).sort((e,t)=>e.label.localeCompare(t.label))},[p]),w=c.exports.useRef(null),N=mt(w)["x"],C=c.exports.useMemo(()=>[{Header:n("columns."+x.Host),accessor:x.Host,minWidth:260,width:260},{Header:n("columns."+x.Network),accessor:x.Network,minWidth:80,width:80},{Header:n("columns."+x.Type),accessor:x.Type,minWidth:120,width:120},{Header:n("columns."+x.Chains),accessor:x.Chains,minWidth:200,width:200},{Header:n("columns."+x.Rule),accessor:x.Rule,minWidth:140,width:140},{id:x.Speed,Header:n("columns."+x.Speed),accessor(e){return[e.speed.upload,e.speed.download]},sortType(e,t){e=e.original.speed,t=t.original.speed;return e.download===t.download?e.upload-t.upload:e.download-t.download},minWidth:200,width:200,sortDescFirst:!0},{Header:n("columns."+x.Upload),accessor:x.Upload,minWidth:100,width:100,sortDescFirst:!0},{Header:n("columns."+x.Download),accessor:x.Download,minWidth:100,width:100,sortDescFirst:!0},{Header:n("columns."+x.SourceIP),accessor:x.SourceIP,minWidth:140,width:140,filter:"equals"},{Header:n("columns."+x.Time),accessor:x.Time,minWidth:120,width:120,sortType(e,t){return t.original.time-e.original.time}}],[n]),{getTableProps:P,getTableBodyProps:k,headerGroups:T,rows:I,prepareRow:A,setFilter:B}=(c.exports.useLayoutEffect(()=>{function e(e){for(const t of e)i({uploadTotal:t.uploadTotal,downloadTotal:t.downloadTotal}),f(t.connections)}return null!=a&&a.subscribe("data",e),()=>{null!=a&&a.unsubscribe("data",e),null!=a&&a.destory()}},[a,f,i]),ee.exports.useTable({columns:C,data:g,autoResetSortBy:!1,autoResetFilters:!1,initialState:{sortBy:[{id:x.Time,desc:!1}]}},ee.exports.useResizeColumns,ee.exports.useBlockLayout,ee.exports.useFilters,ee.exports.useSortBy)),$=c.exports.useMemo(()=>T[0],[T]),O=c.exports.useCallback(function(e){switch(e.column.id){case x.Speed:return Yt(e.value[0],e.value[1]);case x.Upload:case x.Download:return M(e.value);case x.Time:return Ne(new Date(e.value),t);default:return e.value}},[t]),[j,U]=c.exports.useState("");const[W,_]=ue({visible:!1,selectedID:"",connection:{}});const F=dt(W.connection);return c.exports.useEffect(()=>{var e;const t=null==(e=g.find(e=>e.id===W.selectedID))?void 0:e.original;t?_(e=>{e.connection=t,W.selectedID===F.current.id&&(e.connection.completed=F.current.completed)}):0===Object.keys(F.current).length||F.current.completed||_(e=>{e.connection.completed=!0})},[g,W.selectedID,F,_]),s.createElement("div",{className:"page"},s.createElement(z,{title:n("title")},s.createElement("span",{className:"connections-filter flex-1 cursor-default"},`(${n("total.text")}: ${n("total.upload")} ${M(r.uploadTotal)} ${n("total.download")} ${M(r.downloadTotal)})`),s.createElement(Xe,{className:"connections-filter",checked:h,onChange:v},n("keepClosed")),s.createElement(R,{className:"connections-filter dangerous",onClick:d,type:"close-all",size:20})),1<E.length&&s.createElement(_t,{devices:E,selected:j,onChange:function(e){U(e),null!=B&&B(x.SourceIP,e||void 0)}}),s.createElement(H,{ref:l,className:"connections-card relative"},s.createElement("div",D(b({},P()),{className:"flex flex-col w-full flex-1 overflow-auto",style:{flexBasis:0},ref:w}),s.createElement("div",D(b({},$.getHeaderGroupProps()),{className:"connections-header"}),$.headers.map((e,t)=>{var n=e,a=n.id;return s.createElement("div",D(b({},n.getHeaderProps()),{className:y("connections-th",{resizing:n.isResizing,fixed:0<N&&n.id===x.Host}),key:a}),s.createElement("div",b({},n.getSortByToggleProps()),e.render("Header"),n.isSorted?n.isSortedDesc?" ↓":" ↑":null),t!==$.headers.length-1&&s.createElement("div",D(b({},n.getResizerProps()),{className:"connections-resizer"})))})),s.createElement("div",D(b({},k()),{className:"flex-1"}),I.map(n=>(A(n),s.createElement("div",D(b({},n.getRowProps()),{className:"connections-item cursor-default select-none",key:n.original.id,onClick:()=>{var e;e=n.original.id,_({visible:!0,selectedID:e})}}),n.cells.map(e=>{var t=y("connections-block",{"text-center":Xt.has(e.column.id),completed:n.original.completed},{fixed:0<N&&e.column.id===x.Host});return s.createElement("div",D(b({},e.getCellProps()),{className:t,key:e.column.id}),O(e))}))))))),s.createElement(Je,{title:n("closeAll.title"),show:m,onClose:u,onOk:function(){o.closeAllConnections().finally(()=>u())}},n("closeAll.content")),s.createElement(jt,{containerRef:l,visible:W.visible,width:450},s.createElement("div",{className:"flex justify-between items-center h-8"},s.createElement("span",{className:"pl-3 font-bold"},n("info.title")),s.createElement(R,{type:"close",size:16,className:"cursor-pointer",onClick:()=>_("visible",!1)})),s.createElement(Gt,{className:"px-5 mt-3",connection:W.connection}),s.createElement("div",{className:"flex justify-end mt-3 pr-3"},s.createElement(Ce,{type:"danger",disiabled:W.connection.completed,onClick:()=>{_(e=>{e.connection.completed=!0}),o.closeConnection(W.selectedID)}},n("info.closeConnection")))))}function Kt(){const e=S()["translation"],t=e("Settings")["t"],{hostname:n,port:a,secret:o}=te(),[l,r]=$(ve),[i,m]=ue({hostname:"",port:"",secret:""}),d=(c.exports.useEffect(()=>{m({hostname:n,port:a,secret:o})},[n,a,o,m]),he(He));return s.createElement(Je,{show:!l,title:t("externalControllerSetting.title"),bodyClassName:"external-controller",onClose:()=>r(!0),onOk:function(){var{hostname:e,port:t,secret:n}=i;d([{hostname:e,port:t,secret:n}])}},s.createElement(Ot,{type:"info",inside:!0},s.createElement("p",null,t("externalControllerSetting.note"))),s.createElement("div",{className:"flex items-center"},s.createElement("span",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.host")),s.createElement(Y,{className:"md:my-3 flex-1 my-1",align:"left",inside:!0,value:i.hostname,onChange:e=>m("hostname",e)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.port")),s.createElement(Y,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.port,onChange:e=>m("port",e)})),s.createElement("div",{className:"flex items-center"},s.createElement("div",{className:"md:my-3 w-14 my-1 font-bold"},t("externalControllerSetting.secret")),s.createElement(Y,{className:"md:my-3 w-14 my-1 flex-1",align:"left",inside:!0,value:i.secret,onChange:e=>m("secret",e)})))}function Zt(){const t=c.exports.useRef(null),n=c.exports.useRef([]),[e,a]=c.exports.useState([]),o=S()["translation"],l=o("Logs")["t"],r=Ve();return c.exports.useLayoutEffect(()=>{var e=t.current;null!=e&&(e.scrollTop=e.scrollHeight)}),c.exports.useEffect(()=>{function e(e){n.current=n.current.slice().concat(e.map(e=>D(b({},e),{time:new Date}))),a(n.current)}return null!=r&&(r.subscribe("data",e),n.current=r.buffer(),a(n.current)),()=>null==r?void 0:r.unsubscribe("data",e)},[r]),s.createElement("div",{className:"page"},s.createElement(z,{title:l("title")}),s.createElement(H,{className:"flex flex-col flex-1 mt-2.5 md:mt-4"},s.createElement("ul",{className:"logs-panel",ref:t},e.map((e,t)=>s.createElement("li",{className:"leading-5 inline-block",key:t},s.createElement("span",{className:"mr-4 text-gray-400 text-opacity-90"},xe(e.time).format("YYYY-MM-DD HH:mm:ss")),s.createElement("span",null,"[",e.type,"] ",e.payload))))))}(ne=ne||{}).SPEED_NOTIFY="speed-notify";class Qt{constructor(){this.EE=new Le}notifySpeedTest(){this.EE.emit(ne.SPEED_NOTIFY)}subscribe(e,t){this.EE.addListener(e,t)}unsubscribe(e,t){this.EE.removeListener(e,t)}}var Ze,Se=new Qt;const qe={"#909399":0,"#00c520":260,"#ff9a28":600,"#ff3e5e":1/0};function Ke(e){const{config:n,className:t}=e,a=ie()["set"],o=L(),l=c.exports.useCallback(async e=>{var t;return X()?null!=(t=await(null==N?void 0:N.getProxyDelay(e)))?t:0:({delay:t}=(await o.getProxyDelay(e))["data"],t)},[o]),r=c.exports.useCallback(async function(){const e=await le.fromPromise(l(n.name),e=>e),t=e.isErr()?0:e.value;a(e=>{e=e.proxies.find(e=>e.name===n.name);null!=e&&e.history.push({time:Date.now().toString(),delay:t})})},[n.name,l,a]),i=c.exports.useMemo(()=>{var e;return null!=(e=n.history)&&e.length?n.history.slice(-1)[0].delay:0},[n]);c.exports.useLayoutEffect(()=>{const e=()=>{r()};return Se.subscribe(ne.SPEED_NOTIFY,e),()=>Se.unsubscribe(ne.SPEED_NOTIFY,e)},[r]);var e=c.exports.useMemo(()=>0===i,[i]),m=c.exports.useMemo(()=>Object.keys(qe).find(e=>i<=qe[e]),[i]),m=e?void 0:m;return s.createElement("div",{className:y("proxy-item",{"proxy-error":e},t)},s.createElement("span",{className:"proxy-type",style:{backgroundColor:m}},n.type),s.createElement("p",{className:"proxy-name"},n.name),s.createElement("p",{className:"proxy-delay"},0===i?"-":i+"ms"))}function en(a){const o=ie()["markProxySelected"],[l]=$(Bt),r=ze()["data"],i=L(),m=a["config"];var e=c.exports.useMemo(()=>{var e=new Set;for(const n of m.all){var t=null==(t=l.get(n))?void 0:t.history;null!=t&&t.length&&0===t.slice(-1)[0].delay&&e.add(n)}return e},[m.all,l]),t="Selector"===m.type;return s.createElement("div",{className:"proxy-group"},s.createElement("div",{className:"w-full h-10 mt-4 flex items-center justify-between md:h-15 md:mt-0 md:w-auto"},s.createElement("span",{className:"overflow-hidden overflow-ellipsis whitespace-nowrap px-5 h-6 w-35 md:w-30"},m.name),s.createElement(me,{className:"mr-5 md:mr-0"},m.type)),s.createElement("div",{className:"py-2 md:py-4 flex-1"},s.createElement(Ht,{className:"ml-5 md:ml-8",data:m.all,onClick:async function(e){if(await i.changeProxySelected(a.config.name,e),o(a.config.name,e),r.breakConnections){var t=[];for(const n of(await i.getConnections()).data.connections)n.chains.includes(a.config.name)&&t.push(n.id);await Promise.all(t.map(e=>i.closeConnection(e)))}},errSet:e,select:m.now,canClick:t,rowHeight:30})))}function tn(e){const t=je()["update"],{translation:n,lang:a}=S(),o=L(),l=e["provider"],r=n("Proxies")["t"],{visible:i,hide:m,show:d}=be();e=c.exports.useMemo(()=>l.proxies.slice().sort((e,t)=>-1*ke(e,t)),[l.proxies]);return s.createElement(H,{className:"proxy-provider"},s.createElement(Ye,{visible:i}),s.createElement("div",{className:"flex justify-between flex-col md:flex-row md:items-center"},s.createElement("div",{className:"flex items-center"},s.createElement("span",{className:"mr-6"},l.name),s.createElement(me,null,l.vehicleType)),s.createElement("div",{className:"flex items-center pt-3 md:pt-0"},l.updatedAt&&s.createElement("span",{className:"text-sm"},r("providerUpdateTime")+": "+Ne(new Date(l.updatedAt),a)),s.createElement(R,{className:"pl-5 cursor-pointer text-red",type:"healthcheck",size:18,onClick:function(){d(),o.healthCheckProvider(l.name).then(async()=>t()).finally(()=>m())}}),s.createElement(R,{className:"pl-5 cursor-pointer",type:"update",size:18,onClick:function(){d(),o.updateProvider(l.name).then(async()=>t()).finally(()=>m())}}))),s.createElement("ul",{className:"proxies-list"},e.map(e=>s.createElement("li",{key:e.name},s.createElement(Ke,{className:"proxy-provider-item",config:e})))))}!function(e){e[e.None=0]="None",e[e.Asc=1]="Asc",e[e.Desc=2]="Desc"}(Ze=Ze||{});const nn={[0]:"sort",1:"sort-ascending",2:"sort-descending"};function ke(e,t){e=0<e.history.length?e.history.slice(-1)[0].delay:0;return((0<t.history.length?t.history.slice(-1)[0].delay:0)||Number.MAX_SAFE_INTEGER)-(e||Number.MAX_SAFE_INTEGER)}function sn(){const{groups:e,global:t}=ie(),{data:n,set:a}=ze(),o=we()["general"],l=S()["translation"],r=l("Proxies")["t"],i=c.exports.useMemo(()=>"global"===o.mode?[t]:e,[o,e,t]);return s.createElement(s.Fragment,null,0!==i.length&&s.createElement("div",{className:"flex flex-col"},s.createElement(z,{title:r("groupTitle")},s.createElement(Xe,{className:"text-primary-600 text-sm text-shadow-primary cursor-pointer",checked:n.breakConnections,onChange:e=>a("breakConnections",e)},r("breakConnectionsText"))),s.createElement(H,{className:"my-2.5 md:my-4 p-0"},s.createElement("ul",{className:"list-none"},i.map(e=>s.createElement("li",{className:"proxies-group-item",key:e.name},s.createElement(en,{config:e})))))))}function on(){var e=je()["providers"],t=S()["translation"],t=t("Proxies")["t"];return s.createElement(s.Fragment,null,0!==e.length&&s.createElement("div",{className:"flex flex-col"},s.createElement(z,{title:t("providerTitle")}),s.createElement("ul",{className:"list-none"},e.map(e=>s.createElement("li",{className:"my-2.5 md:my-4",key:e.name},s.createElement(tn,{provider:e}))))))}function an(){const e=ie()["proxies"],t=S()["translation"],n=t("Proxies")["t"];const{current:a,next:o}=zt([1,2,0]),l=c.exports.useMemo(()=>{switch(a){case 2:return e.slice().sort((e,t)=>ke(e,t));case 1:return e.slice().sort((e,t)=>-1*ke(e,t));default:return e.slice()}},[a,e]),r=o;return s.createElement(s.Fragment,null,0!==l.length&&s.createElement("div",{className:"flex flex-col"},s.createElement(z,{title:n("title")},s.createElement(R,{className:"ml-3",type:nn[a],onClick:r,size:20}),s.createElement(R,{className:"ml-3",type:"speed",size:20}),s.createElement("span",{className:"proxies-speed-test",onClick:function(){Se.notifySpeedTest()}},n("speedTestText"))),s.createElement("ul",{className:"proxies-list"},l.map(e=>s.createElement("li",{key:e.name},s.createElement(Ke,{config:e}))))))}function rn(){return s.createElement("div",{className:"page"},s.createElement(sn,null),s.createElement(on,null),s.createElement(an,null))}function ln(e){const t=Oe()["update"],{translation:n,lang:s}=S(),a=L(),o=e["provider"],l=n("Rules")["t"],{visible:r,hide:i,show:m}=be();e=y("rule-provider-icon",{"rule-provider-loading":r});return c.exports.createElement("div",{className:"rule-provider"},c.exports.createElement("div",{className:"rule-provider-header"},c.exports.createElement("div",{className:"rule-provider-header-part"},c.exports.createElement("span",{className:"rule-provider-name"},o.name),c.exports.createElement(me,null,o.vehicleType),c.exports.createElement(me,{className:"rule-provider-behavior"},o.behavior),c.exports.createElement("span",{className:"rule-provider-update"},l("ruleCount")+": "+o.ruleCount)),c.exports.createElement("div",{className:"rule-provider-header-part"},o.updatedAt&&c.exports.createElement("span",{className:"rule-provider-update"},l("providerUpdateTime")+": "+Ne(new Date(o.updatedAt),s)),c.exports.createElement(R,{className:e,type:"update",size:18,onClick:function(){m(),a.updateRuleProvider(o.name).then(async()=>t()).finally(()=>i())}}))))}function cn(){var e=Oe()["providers"],t=S()["translation"],t=t("Rules")["t"];return s.createElement(s.Fragment,null,0!==e.length&&s.createElement("div",{className:"flex flex-col"},s.createElement(z,{title:t("providerTitle")}),s.createElement(H,{className:"rounded shadow-primary p-0 divide-y mt-4"},e.map(e=>s.createElement(ln,{key:e.name,provider:e})))))}function un(){const{rules:n,update:e}=$t(),t=S()["translation"],a=t("Rules")["t"];function o({index:e,style:t}){e=n[e];return s.createElement("li",{className:"rule-item",style:t},s.createElement("div",{className:"py-1 flex"},s.createElement("div",{className:"rule-type w-40 text-center"},e.type),s.createElement("div",{className:"payload flex-1 text-center"},e.payload),s.createElement("div",{className:"rule-proxy w-40 text-center"},e.proxy)))}return G("rules",e),s.createElement("div",{className:"page"},s.createElement(cn,null),s.createElement(z,{className:"not-first:mt-7.5",title:a("title")}),s.createElement(H,{className:"flex flex-col flex-1 mt-2.5 md:mt-4 p-0 focus:outline-none"},s.createElement(pt,{className:"min-h-120"},({height:e,width:t})=>s.createElement(ft,{height:e,width:t,itemCount:n.length,itemSize:50},o))))}const mn=[{label:"中文",value:"zh_CN"},{label:"English",value:"en_US"}];function dn(){var e;const t=ce()["premium"],{data:n,update:a}=Ge(),{general:o,update:l}=we(),r=he(ve),i=te(),{translation:m,setLang:d,lang:u}=S(),p=m("Settings")["t"],f=L(),[x,h]=ue({socks5ProxyPort:7891,httpProxyPort:7890,mixedProxyPort:0});c.exports.useEffect(()=>{var e;h("socks5ProxyPort",null!=(e=null==o?void 0:o.socksPort)?e:0),h("httpProxyPort",null!=(e=null==o?void 0:o.port)?e:0),h("mixedProxyPort",null!=(e=null==o?void 0:o.mixedPort)?e:0)},[o,h]);const{hostname:v,port:g}=i,{allowLan:E,mode:b}=o,w=null!=(e=null==n?void 0:n.startAtLogin)&&e,C=null!=(e=null==n?void 0:n.systemProxy)&&e,P=null!=(e=null==n?void 0:n.isClashX)&&e,k=c.exports.useMemo(()=>{var e=[{label:p("values.global"),value:"Global"},{label:p("values.rules"),value:"Rule"},{label:p("values.direct"),value:"Direct"}];return t&&e.push({label:p("values.script"),value:"Script"}),e},[p,t]);return s.createElement("div",{className:"page"},s.createElement(z,{title:p("title")}),s.createElement(H,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.startAtLogin")),s.createElement(ye,{disabled:!(null!=n&&n.isClashX),checked:w,onChange:async function(e){await(null==N?void 0:N.setStartAtLogin(e)),await a()}})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.language")),s.createElement($e,{options:mn,value:u,onSelect:e=>{e=e,d(e)}}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.setAsSystemProxy")),s.createElement(ye,{disabled:!P,checked:C,onChange:async function(e){await(null==N?void 0:N.setSystemProxy(e)),await a()}})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.allowConnectFromLan")),s.createElement(ye,{checked:E,onChange:async function(e){await f.updateConfig({"allow-lan":e}),await l()}})))),s.createElement(H,{className:"settings-card"},s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.proxyMode")),s.createElement($e,{options:k,value:ht(b),onSelect:async function(e){await f.updateConfig({mode:e}),await l()}})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.socks5ProxyPort")),s.createElement(Y,{className:"w-28",disabled:P,value:x.socks5ProxyPort,onChange:e=>h("socks5ProxyPort",+e),onBlur:async function(){await f.updateConfig({"socks-port":x.socks5ProxyPort}),await l()}}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.httpProxyPort")),s.createElement(Y,{className:"w-28",disabled:P,value:x.httpProxyPort,onChange:e=>h("httpProxyPort",+e),onBlur:async function(){await f.updateConfig({port:x.httpProxyPort}),await l()}})),s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.mixedProxyPort")),s.createElement(Y,{className:"w-28",disabled:P,value:x.mixedProxyPort,onChange:e=>h("mixedProxyPort",+e),onBlur:async function(){await f.updateConfig({"mixed-port":x.mixedProxyPort}),await l()}}))),s.createElement("div",{className:"flex flex-wrap"},s.createElement("div",{className:"w-full flex md:w-1/2 items-center justify-between px-8 py-3"},s.createElement("span",{className:"label font-bold"},p("labels.externalController")),s.createElement("span",{className:y({"modify-btn":!P},"external-controller"),onClick:()=>!P&&r(!1)},v+":"+g)),s.createElement("div",{className:"w-1/2 px-8"}))))}var pn="./assets/logo.b453e72f.png";function fn(e){const t=e["routes"],n=S()["translation"],{version:s,premium:a}=ce(),o=Ge()["data"],l=n("SideBar")["t"],r=t.map(({path:e,name:t,exact:n,noMobile:s})=>c.exports.createElement("li",{className:y("item",{"no-mobile":s}),key:t},c.exports.createElement(Et,{to:e,activeClassName:"active",exact:!!n},l(t))));return c.exports.createElement("div",{className:"sidebar"},c.exports.createElement("img",{src:pn,alt:"logo",className:"sidebar-logo"}),c.exports.createElement("ul",{className:"sidebar-menu"},r),c.exports.createElement("div",{className:"sidebar-version"},c.exports.createElement("span",{className:"sidebar-version-label"},"Clash",(null==o?void 0:o.isClashX)&&"X"," ",l("Version")),c.exports.createElement("span",{className:"sidebar-version-text"},s),a&&c.exports.createElement("span",{className:"sidebar-version-label"},"Premium")))}function hn(){Ve();var e=[{path:"/proxies",name:"Proxies",component:rn},{path:"/logs",name:"Logs",component:Zt},{path:"/rules",name:"Rules",component:un,noMobile:!0},{path:"/connections",name:"Connections",component:qt,noMobile:!0},{path:"/settings",name:"Settings",component:dn}];return s.createElement("div",{className:y("app",{"not-clashx":!X()})},s.createElement(fn,{routes:e}),s.createElement("div",{className:"page-container"},s.createElement(xt,null,s.createElement(Te,{exact:!0,path:"/",component:()=>s.createElement(yt,{to:"/proxies"})}),e.map(e=>s.createElement(Te,{exact:!1,path:e.path,key:e.path,component:e.component})))),s.createElement(Kt,null))}function Qe(){var e=document.getElementById("root"),t=s.createElement(gt,null,s.createElement(c.exports.Suspense,{fallback:s.createElement(Ye,{visible:!0})},s.createElement(hn,null)));Ee.exports.render(t,e)}X()?Ct(()=>Qe()):Qe();