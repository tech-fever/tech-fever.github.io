<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Rainbow</title>
  
  <subtitle>blog</subtitle>
  <link href="https://pawswrite.xyz/atom.xml" rel="self"/>
  
  <link href="https://pawswrite.xyz/"/>
  <updated>2022-10-12T12:09:39.509Z</updated>
  <id>https://pawswrite.xyz/</id>
  
  <author>
    <name>Rainbow</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>免费的 Azure 数据库和 Web 应用搭建 Waline 评论系统</title>
    <link href="https://pawswrite.xyz/posts/f1b701c3.html"/>
    <id>https://pawswrite.xyz/posts/f1b701c3.html</id>
    <published>2022-10-12T04:28:23.000Z</published>
    <updated>2022-10-12T12:09:39.509Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://azure.microsoft.com/zh-cn/free/students/">Azure 学生订阅</a> 和其他大部分订阅都提供了免费的 <code>MySQL</code> 数据库和 应用服务(10 个 Web、移动或 API 应用，提供 1 GB 存储空间)，刚好可以用来托管博客的评论系统 Waline。</p><span id="more"></span><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><ul><li><a href="https://waline.js.org/">关于 Waline</a></li><li><a href="https://hexo.com/">关于 Hexo</a></li><li><a href="https://azure.microsoft.com/zh-cn/free/students/">关于Azure学生订阅</a></li></ul><p>参考文章：</p><ol><li><a href="https://blog.amjac.cn/2021/09/deploy-waline-in-azure/">【hexo博客】在Azure上搭建Waline评论服务</a></li></ol><h1 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h1><div class="note note-info">            <p>waline 支持 <code>MySQL</code> 和 <code>PostgreSQL</code> ，<code>Azure</code> 的学生订阅二者都支持。本文选择的是 <code>MySQL</code> 。</p>          </div><p>进入 <a href="https://portal.azure.com/#home">Azure 首页</a> ，选择 <a href="https://portal.azure.com/#create/hub">创建资源</a>。搜索 <code>Azure Database for MySQL</code> 或 【推荐】 <code>Azure Database for MySQL Flexible Server</code> 。</p><p>如果选择了 <code>Azure Database for MySQL</code> 记得在点击创建以后，再选择 <strong>灵活服务器</strong> </p><p><img src="/posts/f1b701c3/sql.png"><br><img src="/posts/f1b701c3/sql3.png"></p><p>或者直接选择 <code>Azure Database for MySQL Flexible Server</code> ：<br><img src="/posts/f1b701c3/sql2.png"></p><div class="note note-info">            <p>注意是 <code>Azure Database for MySQL</code> 而不是 <code>SQL Database</code> !<br>后者对学生订阅有免费额度。</p>          </div><p>填写创建配置：<br><img src="/posts/f1b701c3/sql_create.png"></p><p>资源组和服务器名称可以随便写，MySQL版本有 8.0 和 5.7 两种，区域推荐填写 east asia，距离中国更近。</p><span class="label label-info">提示</span> 计算 + 储存这里一定要选择 **B1ms** ，这样才是免费的。学生订阅有个 `B1s` 计算同样也免费，但它可以用于创建服务器，且配置低于 `B1ms` ，拿来创建数据库浪费了。<span class="label label-primary">重要</span> 下面的管理员用户名和密码，就是你访问SQL数据库的用户名密码，设置后**一定要记住**。<p>免费计划里，数据库最多有32 GB免费存储。需要的话可以点击 <strong>配置服务器</strong> ，然后拉满<br><img src="/posts/f1b701c3/sql_storage.png"></p><p>点击，<code>下一步：网络</code> ，为了能够让 <code>waline-server</code> 访问到数据库，在防火墙规则这里选择，<div>            <input type="checkbox" disabled checked="checked">允许从任何 Azure 内的任何 Azure 服务公开访问此服务器          </div><br><img src="https://blog.amjac.cn/2021/09/deploy-waline-in-azure/image-20210903141548743.png"></p><span class="label label-default">可选</span> 如果你需要从其他位置连接数据库，那么在下面填写相应的 IP 地址即可。比如说一键添加你当前使用的 IP到白名单： **+ 添加当前客户端 IP 地址(xxx.xxx.xxx.xxx)**。<div class="note note-danger">            <p>添加 0.0.0.0 - 255.255.255.255 可以使得数据库直接对公网开放，但这是危险的操作。</p>          </div><p>最后看一下网页右边的估计成本，点击创建即可。过程大概需要5分钟左右。静待完成后，点击 <code>转到资源</code>。</p><h1 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h1><p>根据 <code>Waline</code> 官方文档，使用时请先导入 <a href="https://github.com/walinejs/waline/blob/main/assets/waline.sql">waline.sql</a> 以完成表和表结构的创建。这里我们连接数据库后导入即可。</p><h2 id="创建数据库-1"><a href="#创建数据库-1" class="headerlink" title="创建数据库"></a>创建数据库</h2><p>在数据库资源界面，按照下图操作即可（我用的英文，大家注意对应）<br><img src="/posts/f1b701c3/db_create.png"></p><h2 id="使用-Azure-Cloud-shell-连接数据库"><a href="#使用-Azure-Cloud-shell-连接数据库" class="headerlink" title="使用 Azure Cloud shell 连接数据库"></a>使用 Azure Cloud shell 连接数据库</h2><p>首先连接数据库。有很多连接方式，只要连接 IP 在白名单内即可。（白名单除了在创建的时候配置，还可以在 <code>网络</code> 这里进行配置）</p><p>这里推荐使用 Azure 自带的 <code>Azure Cloud shell</code> 来进行连接。</p><p>进入 <a href="https://portal.azure.com/#home">Azure 首页</a> ，找到如下图标并点击。<br><img src="/posts/f1b701c3/AzureCloudshell.png"></p><p>页面下方会出现如下控制台，选择 <code>Bash</code> ，第一次使用需要选择订阅，并创建存储，之后等待创建完成：</p><p><img src="/posts/f1b701c3/AzureCloudshell2.png"><br><img src="/posts/f1b701c3/AzureCloudshell3.png"></p><h2 id="导入数据库"><a href="#导入数据库" class="headerlink" title="导入数据库"></a>导入数据库</h2><p>连接 + 初始化 数据库的命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://raw.githubusercontent.com/walinejs/waline/main/assets/waline.sql<br>mysql -h 数据库名称.mysql.database.azure.com -u 管理员账户 -p waline&lt;waline.sql<br></code></pre></td></tr></table></figure><p>解释一下， <code>数据库名称.mysql.database.azure.com</code> 是数据库的 <code>hostname</code> ，管理员用户名是你设置的。 <code>waline</code> 是导入后的数据库库名，可以随便写，建议写 <code>waline</code></p><p>如果不清楚上面说的这些，就去 <code>所有资源 - 刚刚创建的数据库 - 连接</code> 这里查看。<br><img src="/posts/f1b701c3/sql4.png"></p><p>之后会出现类似下面的界面让你输入密码，注意你输入密码的时候，控制台是<strong>不显示密码</strong>的，直接键盘输入然后回车即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">azureusername [ ~ ]$ mysql -h waline.mysql.database.azure.com -u waline -p waline&lt;waline.sql <br>Enter password:<br></code></pre></td></tr></table></figure><p>【可选】删除 Azure Cloud shell 中的 waline.sql 文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">rm</span> waline.sql<br></code></pre></td></tr></table></figure><h1 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h1><p>注册好 Azure 账户后，在 <a href="https://portal.azure.com/#home">Azure Portal</a> 中<a href="https://portal.azure.com/#create/hub">创建一个 Web 应用</a>：<br><img src="/posts/f1b701c3/web.png"></p><p>Docker 这里，按下图配置：<br><img src="/posts/f1b701c3/docker.png"><br>1<a href="https://blog.amjac.cn/2021/09/deploy-waline-in-azure/image-20210902154929384.png"></a></p><p>之后点击 <code>创建</code> 就好了。</p><h1 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h1><p>等 Web 应用创建完成，按照下面的步骤一个个填写下面表格里带 ✅ 的环境变量，全部填写完后记得点击<strong>保存</strong>。<br><img src="/posts/f1b701c3/env.png"></p><p>在项目中配置如下环境变量，其中有 ✅ 的是必须填写的。</p><table><thead><tr><th>环境变量名称</th><th>必填</th><th>填写的值</th><th>备注</th></tr></thead><tbody><tr><td><code>MYSQL_HOST</code></td><td>✅</td><td>上面说过的 hostname</td><td>MySQL 服务的地址</td></tr><tr><td><code>MYSQL_PORT</code></td><td></td><td><code>3306</code></td><td>MySQL 服务的端口</td></tr><tr><td><code>MYSQL_DB</code></td><td>✅</td><td><code>waline</code></td><td>MySQL 数据库库名</td></tr><tr><td><code>MYSQL_USER</code></td><td>✅</td><td>数据库的管理员用户名（waline）</td><td>MySQL 数据库的用户名</td></tr><tr><td><code>MYSQL_PASSWORD</code></td><td>✅</td><td>创建数据库的时候设定的</td><td>MySQL 数据库的密码</td></tr><tr><td><code>MYSQL_PREFIX</code></td><td></td><td><code>wl_</code></td><td>MySQL 数据表的表前缀</td></tr><tr><td><code>MYSQL_CHARSET</code></td><td></td><td><code>utf8mb4</code></td><td>MySQL 数据表的字符集</td></tr><tr><td><code>MYSQL_SSL</code></td><td>✅</td><td><code>true</code></td><td>是否使用 SSL MYSQL 连接数据库</td></tr></tbody></table><p>填写后效果如下<br><img src="https://blog.amjac.cn/2021/09/deploy-waline-in-azure/image-20210903142519857.png"></p><p>更多环境变量配置查看<a href="https://waline.js.org/reference/env.html">官方文档</a></p><h1 id="博客端配置"><a href="#博客端配置" class="headerlink" title="博客端配置"></a>博客端配置</h1><p>Hexo 有几个主题已经直接嵌入了 waline 评论系统。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;//cdn.jsdelivr.net/npm/@waline/client&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;waline&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-title class_">Waline</span>(&#123;</span><br><span class="language-javascript">      <span class="hljs-attr">el</span>: <span class="hljs-string">&#x27;#waline&#x27;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">serverURL</span>: <span class="hljs-string">&#x27;https://xxxxxxxxxxxxx&#x27;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">dark</span>: <span class="hljs-string">&#x27;body.dark&#x27;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">meta</span>: [<span class="hljs-string">&#x27;nick&#x27;</span>, <span class="hljs-string">&#x27;mail&#x27;</span>],</span><br><span class="language-javascript">      <span class="hljs-attr">requiredMeta</span>: [<span class="hljs-string">&#x27;nick&#x27;</span>],</span><br><span class="language-javascript">    &#125;);</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://azure.microsoft.com/zh-cn/free/students/&quot;&gt;Azure 学生订阅&lt;/a&gt; 和其他大部分订阅都提供了免费的 &lt;code&gt;MySQL&lt;/code&gt; 数据库和 应用服务(10 个 Web、移动或 API 应用，提供 1 GB 存储空间)，刚好可以用来托管博客的评论系统 Waline。&lt;/p&gt;</summary>
    
    
    
    <category term="Hexo" scheme="https://pawswrite.xyz/categories/Hexo/"/>
    
    <category term="Waline" scheme="https://pawswrite.xyz/categories/Hexo/Waline/"/>
    
    
    <category term="Azure" scheme="https://pawswrite.xyz/tags/Azure/"/>
    
  </entry>
  
  <entry>
    <title>绿云9999服务器测评</title>
    <link href="https://pawswrite.xyz/posts/24829.html"/>
    <id>https://pawswrite.xyz/posts/24829.html</id>
    <published>2022-10-10T13:01:52.000Z</published>
    <updated>2022-10-10T14:14:35.831Z</updated>
    
    <content type="html"><![CDATA[<p>绿云9999服务器脚本跑分解锁结果</p><span id="more"></span><p>benchmark 跑分结果</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">root<span class="hljs-meta">@GreenCloud:~#</span> curl -sL yabs.sh |<span class="hljs-string"> bash</span><br><span class="hljs-string"># ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## #</span><br><span class="hljs-string">#              Yet-Another-Bench-Script              #</span><br><span class="hljs-string">#                     v2022-08-20                    #</span><br><span class="hljs-string"># https://github.com/masonr/yet-another-bench-script #</span><br><span class="hljs-string"># ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## ## #</span><br><span class="hljs-string"></span><br><span class="hljs-string">Mon 10 Oct 2022 01:46:42 PM BST</span><br><span class="hljs-string"></span><br><span class="hljs-string">Basic System Information:</span><br><span class="hljs-string">---------------------------------</span><br><span class="hljs-string">Uptime     : 0 days, 0 hours, 41 minutes</span><br><span class="hljs-string">Processor  : Intel(R) Xeon(R) CPU E5-2698 v4 @ 2.20GHz</span><br><span class="hljs-string">CPU cores  : 9 @ 2199.986 MHz</span><br><span class="hljs-string">AES-NI     : ✔ Enabled</span><br><span class="hljs-string">VM-x/AMD-V : ✔ Enabled</span><br><span class="hljs-string">RAM        : 8.7 GiB</span><br><span class="hljs-string">Swap       : 1024.0 MiB</span><br><span class="hljs-string">Disk       : 96.5 GiB</span><br><span class="hljs-string">Distro     : Ubuntu 20.04 LTS</span><br><span class="hljs-string">Kernel     : 5.4.0-28-generic</span><br><span class="hljs-string"></span><br><span class="hljs-string">fio Disk Speed Tests (Mixed R/W 50/50):</span><br><span class="hljs-string">---------------------------------</span><br><span class="hljs-string">Block Size </span>|<span class="hljs-string"> 4k            (IOPS) </span>|<span class="hljs-string"> 64k           (IOPS)</span><br><span class="hljs-string">  ------   </span>|<span class="hljs-string"> ---            ----  </span>|<span class="hljs-string"> ----           ----</span><br><span class="hljs-string">Read       </span>|<span class="hljs-string"> 90.70 MB/s   (22.6k) </span>|<span class="hljs-string"> 1.25 GB/s    (19.6k)</span><br><span class="hljs-string">Write      </span>|<span class="hljs-string"> 90.94 MB/s   (22.7k) </span>|<span class="hljs-string"> 1.26 GB/s    (19.7k)</span><br><span class="hljs-string">Total      </span>|<span class="hljs-string"> 181.64 MB/s  (45.4k) </span>|<span class="hljs-string"> 2.51 GB/s    (39.3k)</span><br><span class="hljs-string">           </span>|<span class="hljs-string">                      </span>|<br>Block Size |<span class="hljs-string"> 512k          (IOPS) </span>|<span class="hljs-string"> 1m            (IOPS)</span><br><span class="hljs-string">  ------   </span>|<span class="hljs-string"> ---            ----  </span>|<span class="hljs-string"> ----           ----</span><br><span class="hljs-string">Read       </span>|<span class="hljs-string"> 1.94 GB/s     (3.8k) </span>|<span class="hljs-string"> 1.99 GB/s     (1.9k)</span><br><span class="hljs-string">Write      </span>|<span class="hljs-string"> 2.04 GB/s     (4.0k) </span>|<span class="hljs-string"> 2.13 GB/s     (2.0k)</span><br><span class="hljs-string">Total      </span>|<span class="hljs-string"> 3.99 GB/s     (7.8k) </span>|<span class="hljs-string"> 4.12 GB/s     (4.0k)</span><br><span class="hljs-string"></span><br><span class="hljs-string">iperf3 Network Speed Tests (IPv4):</span><br><span class="hljs-string">---------------------------------</span><br><span class="hljs-string">Provider        </span>|<span class="hljs-string"> Location (Link)           </span>|<span class="hljs-string"> Send Speed      </span>|<span class="hljs-string"> Recv Speed</span><br><span class="hljs-string">                </span>|<span class="hljs-string">                           </span>|<span class="hljs-string">                 </span>|<br>Clouvider       |<span class="hljs-string"> London, UK (10G)          </span>|<span class="hljs-string"> 665 Mbits/sec   </span>|<span class="hljs-string"> 924 Mbits/sec</span><br><span class="hljs-string">Online.net      </span>|<span class="hljs-string"> Paris, FR (10G)           </span>|<span class="hljs-string"> 1.36 Gbits/sec  </span>|<span class="hljs-string"> 1.08 Gbits/sec</span><br><span class="hljs-string">Hybula          </span>|<span class="hljs-string"> The Netherlands (40G)     </span>|<span class="hljs-string"> 1.00 Gbits/sec  </span>|<span class="hljs-string"> 1.04 Gbits/sec</span><br><span class="hljs-string">Uztelecom       </span>|<span class="hljs-string"> Tashkent, UZ (10G)        </span>|<span class="hljs-string"> 1.08 Gbits/sec  </span>|<span class="hljs-string"> 874 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> NYC, NY, US (10G)         </span>|<span class="hljs-string"> 607 Mbits/sec   </span>|<span class="hljs-string"> 749 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> Dallas, TX, US (10G)      </span>|<span class="hljs-string"> 541 Mbits/sec   </span>|<span class="hljs-string"> 716 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> Los Angeles, CA, US (10G) </span>|<span class="hljs-string"> 694 Mbits/sec   </span>|<span class="hljs-string"> 734 Mbits/sec</span><br><span class="hljs-string"></span><br><span class="hljs-string">iperf3 Network Speed Tests (IPv6):</span><br><span class="hljs-string">---------------------------------</span><br><span class="hljs-string">Provider        </span>|<span class="hljs-string"> Location (Link)           </span>|<span class="hljs-string"> Send Speed      </span>|<span class="hljs-string"> Recv Speed</span><br><span class="hljs-string">                </span>|<span class="hljs-string">                           </span>|<span class="hljs-string">                 </span>|<br>Clouvider       |<span class="hljs-string"> London, UK (10G)          </span>|<span class="hljs-string"> 929 Mbits/sec   </span>|<span class="hljs-string"> 1.06 Gbits/sec</span><br><span class="hljs-string">Online.net      </span>|<span class="hljs-string"> Paris, FR (10G)           </span>|<span class="hljs-string"> 741 Mbits/sec   </span>|<span class="hljs-string"> 699 Mbits/sec</span><br><span class="hljs-string">Hybula          </span>|<span class="hljs-string"> The Netherlands (40G)     </span>|<span class="hljs-string"> 673 Mbits/sec   </span>|<span class="hljs-string"> 683 Mbits/sec</span><br><span class="hljs-string">Uztelecom       </span>|<span class="hljs-string"> Tashkent, UZ (10G)        </span>|<span class="hljs-string"> 1.18 Gbits/sec  </span>|<span class="hljs-string"> 959 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> NYC, NY, US (10G)         </span>|<span class="hljs-string"> 705 Mbits/sec   </span>|<span class="hljs-string"> 783 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> Dallas, TX, US (10G)      </span>|<span class="hljs-string"> 694 Mbits/sec   </span>|<span class="hljs-string"> 856 Mbits/sec</span><br><span class="hljs-string">Clouvider       </span>|<span class="hljs-string"> Los Angeles, CA, US (10G) </span>|<span class="hljs-string"> 676 Mbits/sec   </span>|<span class="hljs-string"> 1.05 Gbits/sec</span><br><span class="hljs-string"></span><br><span class="hljs-string">Geekbench 5 Benchmark Test:</span><br><span class="hljs-string">---------------------------------</span><br><span class="hljs-string">Test            </span>|<span class="hljs-string"> Value</span><br><span class="hljs-string">                </span>|<br>Single Core     |<span class="hljs-string"> 695</span><br><span class="hljs-string">Multi Core      </span>|<span class="hljs-string"> 5607</span><br><span class="hljs-string">Full Test       </span>|<span class="hljs-string"> https://browser.geekbench.com/v5/cpu/17860694</span><br></code></pre></td></tr></table></figure><p>解锁结果：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">============[</span> <span class="hljs-string">Multination</span> <span class="hljs-string">]============</span><br> <span class="hljs-attr">Dazn:</span>                                  <span class="hljs-literal">No</span><br> <span class="hljs-attr">HotStar:</span>                               <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">US)</span><br> <span class="hljs-string">Disney+:</span>                               <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">US)</span><br> <span class="hljs-attr">Netflix:</span>                               <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">US)</span><br> <span class="hljs-attr">YouTube Premium:</span>                       <span class="hljs-literal">No</span><br> <span class="hljs-attr">Amazon Prime Video:</span>                    <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">US)</span><br> <span class="hljs-string">TVBAnywhere+:</span>                          <span class="hljs-literal">Yes</span><br> <span class="hljs-attr">iQyi Oversea Region:</span>                   <span class="hljs-string">US</span><br> <span class="hljs-attr">Viu.com:</span>                               <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">SG)</span><br> <span class="hljs-attr">YouTube CDN:</span>                           <span class="hljs-string">Singapore</span><br> <span class="hljs-attr">Netflix Preferred CDN:</span>                 <span class="hljs-string">Hong</span> <span class="hljs-string">Kong</span><br> <span class="hljs-attr">Spotify Registration:</span>                  <span class="hljs-literal">No</span><br> <span class="hljs-attr">Steam Currency:</span>                        <span class="hljs-string">SGD</span><br><span class="hljs-string">=======================================</span><br><br><br> <span class="hljs-string">**</span> <span class="hljs-string">正在测试IPv6解锁情况</span><br><span class="hljs-string">--------------------------------</span><br> <span class="hljs-string">**</span> <span class="hljs-string">您的网络为:</span> <span class="hljs-string">Leaseweb</span> <span class="hljs-string">Asia</span> <span class="hljs-string">(2402:a7c0:8100:*:*)</span><br><br><br><span class="hljs-string">============[</span> <span class="hljs-string">Multination</span> <span class="hljs-string">]============</span><br> <span class="hljs-attr">Dazn:</span>                                  <span class="hljs-string">Failed</span> <span class="hljs-string">(Network</span> <span class="hljs-string">Connection)</span><br> <span class="hljs-attr">HotStar:</span>                               <span class="hljs-literal">Yes</span> <span class="hljs-string">(Region:</span> <span class="hljs-string">SG)</span><br> <span class="hljs-string">Disney+:</span>                               <span class="hljs-literal">No</span><br> <span class="hljs-attr">Netflix:</span>                               <span class="hljs-string">Originals</span> <span class="hljs-string">Only</span><br> <span class="hljs-attr">YouTube Premium:</span>                       <span class="hljs-literal">No</span><br> <span class="hljs-attr">Amazon Prime Video:</span>                    <span class="hljs-string">Unsupported</span><br> <span class="hljs-string">TVBAnywhere+:</span>                          <span class="hljs-string">Failed</span> <span class="hljs-string">(Network</span> <span class="hljs-string">Connection)</span><br> <span class="hljs-attr">iQyi Oversea Region:</span>                   <span class="hljs-string">Failed</span><br> <span class="hljs-attr">Viu.com:</span>                               <span class="hljs-string">Failed</span><br> <span class="hljs-attr">YouTube CDN:</span>                           <span class="hljs-string">Singapore</span><br> <span class="hljs-attr">Netflix Preferred CDN:</span>                 <span class="hljs-string">Singapore</span><br> <span class="hljs-attr">Spotify Registration:</span>                  <span class="hljs-literal">No</span><br> <span class="hljs-attr">Steam Currency:</span>                        <span class="hljs-string">Failed</span> <span class="hljs-string">(Network</span> <span class="hljs-string">Connection)</span><br><span class="hljs-string">=======================================</span><br><span class="hljs-string">本次测试已结束，感谢使用此脚本</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;绿云9999服务器脚本跑分解锁结果&lt;/p&gt;</summary>
    
    
    
    <category term="VPS" scheme="https://pawswrite.xyz/categories/VPS/"/>
    
    
  </entry>
  
  <entry>
    <title>给对象安排微信早安推送</title>
    <link href="https://pawswrite.xyz/posts/21.html"/>
    <id>https://pawswrite.xyz/posts/21.html</id>
    <published>2022-09-29T11:28:26.000Z</published>
    <updated>2022-10-04T15:51:38.667Z</updated>
    
    <content type="html"><![CDATA[<p>最近对象给我看了小红书上挺火的那个程序员做的早安公众号。试了下，碍于微信限制，只有服务号能发模板消息，如果用测试号，收到的消息很不显眼。本文实现了测试号和pushplus来发送早安推送。</p><span id="more"></span><h1 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h1><p>GitHub: <a class="btn" href="https://github.com/tech-fever/wechat_push"  title="点此打开项目" target="_blank">项目地址</a></p><p><a href="https://github.com/tech-fever/wechat_push">https://github.com/tech-fever/wechat_push</a></p><p>首先将项目下载到本地，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/tech-fever/wechat_push.git<br><span class="hljs-built_in">cd</span> wechat_push<br></code></pre></td></tr></table></figure><p>将 <code>config.json.example</code> 复制一份命名为 <code>config.json</code></p><p>如果你 测试号 和 pushplus 都需要，那就都填，如果有不需要的，就在 <code>config.json</code> 删除对应的部分。</p><h1 id="测试号-x2F-服务号"><a href="#测试号-x2F-服务号" class="headerlink" title="测试号&#x2F;服务号"></a>测试号&#x2F;服务号</h1><div class="note note-primary">            <p>个人公众号无法发送模板消息，只能48小时内回复，不能主动给用户发消息。服务号需要营业执照需要法人身份需要公章，还需要300块，所以直接放弃。</p>          </div><p>测试号获取：<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login">https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login</a></p><p>先登录，找到app_id，app_secret，再添加模板，拿到模板id</p><a class="btn" href="https://raw.githubusercontent.com/tech-fever/wechat_push/main/template"  title="模板链接" target="_blank">点此打开模板</a><p>再让对象关注公众号，关注后在用户列表里获取对象微信号。</p><p>编辑 <code>config.json</code> 填入 <code>app_id app_secret template_id touser</code>。</p><h1 id="pushplus"><a href="#pushplus" class="headerlink" title="pushplus"></a>pushplus</h1><p>pushplus: <a class="btn" href="https://www.pushplus.plus/login.html"  title="pushplus" target="_blank">点此登录pushplus</a></p><p>登录后获取token，填入 <code>config.json</code> </p><h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><p>friends 下面支持添加多个收信息的朋友，<code>birthday</code> 和 <code>love_date</code> 可以留空，<code>to</code> 是pushplus好友token，可以留空， <code>touser</code> 是好友关注测试公众号后用户列表里的微信号，可以留空。</p><h1 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h1><p>需要python3以上</p><p>Linux:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install python3<br></code></pre></td></tr></table></figure><p>Windows : <a class="btn" href="https://www.python.org/downloads/"  title="python3 官网" target="_blank">python3 下载</a></p><p>运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">python3 main.py<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;最近对象给我看了小红书上挺火的那个程序员做的早安公众号。试了下，碍于微信限制，只有服务号能发模板消息，如果用测试号，收到的消息很不显眼。本文实现了测试号和pushplus来发送早安推送。&lt;/p&gt;</summary>
    
    
    
    <category term="有趣的小项目" scheme="https://pawswrite.xyz/categories/%E6%9C%89%E8%B6%A3%E7%9A%84%E5%B0%8F%E9%A1%B9%E7%9B%AE/"/>
    
    
    <category term="学习" scheme="https://pawswrite.xyz/tags/%E5%AD%A6%E4%B9%A0/"/>
    
    <category term="Python" scheme="https://pawswrite.xyz/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>机场推荐</title>
    <link href="https://pawswrite.xyz/posts/33840.html"/>
    <id>https://pawswrite.xyz/posts/33840.html</id>
    <published>2022-09-25T05:11:47.000Z</published>
    <updated>2022-10-04T15:51:38.643Z</updated>
    
    <content type="html"><![CDATA[<p>全年稳定高速解锁Netflix的机场很少，大部分都很贵。推荐一个我自用了挺久的高性价比机场。</p><p>注册GLaDOS(<a href="https://glados.rocks/register">注册地址</a>), 并输入邀请码激活:</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-symbol">N3</span>CMR<span class="hljs-number">-9</span>H<span class="hljs-number">4</span>SV-RE<span class="hljs-number">0</span>Z<span class="hljs-number">6</span>-<span class="hljs-keyword">LE</span><span class="hljs-number">1</span>RZ<br></code></pre></td></tr></table></figure><span id="more"></span><div class="note note-info">            <p>机场：简单理解就是全平台可用的梯子。</p>          </div><h1 id="测速结果"><a href="#测速结果" class="headerlink" title="测速结果"></a>测速结果</h1><p>Speedtest stair高峰期测速结果（多线程测速），我本地带宽在500Mbps：<br><img src="/posts/33840/speedtest-stair.png"></p><p>Youtube 高峰期（下午六点多）测速，能稳定在十万左右：<br><img src="/posts/33840/youtube.png"></p><h1 id="节点价格"><a href="#节点价格" class="headerlink" title="节点价格"></a>节点价格</h1><p>他家有三个套餐，写着限速但实际我使用并没发现限速。<br><img src="/posts/33840/price.png"></p><p>用 <code>PORTALGUN</code> 优惠码可以满100-20：<br><img src="/posts/33840/pricing.png"></p><p>支持Paypal、Visa&#x2F;MasterCard信用卡和支付宝三种支付方式，其中Paypal和信用卡可以9折，7天内可退款（通过 PayPal 支付的需要支付每笔 5 美元手续费）。<br><img src="/posts/33840/payment.png"></p><p>也就是说200天套餐仅需 (119 - 20) * 0.9 &#x3D; 88 ，大概13一月。</p><p>但我说这个机场性价比极高的原因在于，他家可以<strong>无限签到</strong>，付费用户每次签到100%延长一天（免费用户好像不能无限延长）。</p><p>而签到呢，又是可以用脚本自动的。所以。。。一次付费，<del>理论上无限使用，只要机场不改变政策</del>。</p><p>脚本自动签到看我的</p><h1 id="注册流程"><a href="#注册流程" class="headerlink" title="注册流程"></a>注册流程</h1><ul><li>官网：<a href="https://glados.rocks/">https://glados.rocks</a></li><li>注册：<a href="https://glados.rocks/register">https://glados.rocks/register</a></li></ul><p>首先进入 <a href="https://glados.rocks/register">GLaDOS 注册 </a>：<br><img src="/posts/33840/register.png"></p><p>输入自己的邮箱，点击send passcode to email，再进入邮箱查看收到的验证码，将验证码填入 Passcode 输入框。最后点击 <strong>Register</strong> 按钮：<br><img src="/posts/33840/CD-KEY.PNG"></p><p>在这里输入笔者的邀请码，点击Next，即可获得<strong>三天免费</strong>，</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-symbol">N3</span>CMR<span class="hljs-number">-9</span>H<span class="hljs-number">4</span>SV-RE<span class="hljs-number">0</span>Z<span class="hljs-number">6</span>-<span class="hljs-keyword">LE</span><span class="hljs-number">1</span>RZ<br></code></pre></td></tr></table></figure><p>之后就等待账号设置完成：<br><img src="/posts/33840/setup.png"></p><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>机场不仅有工作日工作时间在线的客服，还有详尽的教程。照着使用就好啦。</p><h1 id="Netflix解锁"><a href="#Netflix解锁" class="headerlink" title="Netflix解锁"></a>Netflix解锁</h1><p>机场提供 Netflix 美国、台湾解锁节点，平均速度大于40MB&#x2F;s，看4k毫无压力。<br><img src="/posts/33840/netflix.png"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;全年稳定高速解锁Netflix的机场很少，大部分都很贵。推荐一个我自用了挺久的高性价比机场。&lt;/p&gt;
&lt;p&gt;注册GLaDOS(&lt;a href=&quot;https://glados.rocks/register&quot;&gt;注册地址&lt;/a&gt;), 并输入邀请码激活:&lt;/p&gt;
&lt;figure class=&quot;highlight gcode&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;code class=&quot;hljs gcode&quot;&gt;&lt;span class=&quot;hljs-symbol&quot;&gt;N3&lt;/span&gt;CMR&lt;span class=&quot;hljs-number&quot;&gt;-9&lt;/span&gt;H&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;SV-RE&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;Z&lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;-&lt;span class=&quot;hljs-keyword&quot;&gt;LE&lt;/span&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;RZ&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="科学上网" scheme="https://pawswrite.xyz/categories/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
    
  </entry>
  
  <entry>
    <title>笔记：Django时区问题【非原创】</title>
    <link href="https://pawswrite.xyz/posts/13647.html"/>
    <id>https://pawswrite.xyz/posts/13647.html</id>
    <published>2022-09-25T05:04:12.000Z</published>
    <updated>2022-10-04T15:51:38.651Z</updated>
    
    <content type="html"><![CDATA[<p>Python的时区问题一直很烦，找到篇讲Django时区讲的很好的文章，存档一下。</p><p>《<a href="https://www.leavesongs.com/PYTHON/django-timezone-detail.html">Django中与时区相关的安全问题</a>》</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;Python的时区问题一直很烦，找到篇讲Django时区讲的很好的文章，存档一下。&lt;/p&gt;
&lt;p&gt;《&lt;a href=&quot;https://www.leavesongs.com/PYTHON/django-timezone-detail.html&quot;&gt;Django中与时区相关的安全</summary>
      
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Django" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Django/"/>
    
    
    <category term="Python" scheme="https://pawswrite.xyz/tags/Python/"/>
    
    <category term="Django" scheme="https://pawswrite.xyz/tags/Django/"/>
    
  </entry>
  
  <entry>
    <title>【git实战入门】2. 小白的第一次提交</title>
    <link href="https://pawswrite.xyz/posts/10342.html"/>
    <id>https://pawswrite.xyz/posts/10342.html</id>
    <published>2022-09-24T09:24:40.000Z</published>
    <updated>2022-10-04T15:51:38.669Z</updated>
    
    <content type="html"><![CDATA[<p>上一篇教程已经将远程的repository clone到了本地并进行了配置，我们来进行第一次提交和修改。</p><span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>要成功将修改提交到仓库，前提是要证明你对仓库有修改的权力，毕竟不是什么阿猫阿狗都能随便改的。</p><p>一般验证的方式有三种：<br>验证你是你（对你所有的仓库都可以进行修改）：</p><ul><li><a href="https://github.com/settings/tokens">Personal access tokens</a></li><li><a href="https://github.com/settings/keys">SSH keys</a></li><li>账号密码（已经弃用）</li></ul><p>验证你可以修改这个仓库（仅针对这一个仓库）</p><ul><li>Deploy keys</li></ul><p>本文先讲如何优雅地配置SSH keys</p><h1 id="通过SSH-keys连接到GitHub"><a href="#通过SSH-keys连接到GitHub" class="headerlink" title="通过SSH keys连接到GitHub"></a>通过SSH keys连接到GitHub</h1><p>官方文档：《<a href="https://docs.github.com/cn/authentication/connecting-to-github-with-ssh">通过 SSH 连接到 GitHub</a>》</p><h2 id="检查SSH-keys"><a href="#检查SSH-keys" class="headerlink" title="检查SSH keys"></a>检查SSH keys</h2><p>打开终端或者 git bash：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -al ~/.ssh<br></code></pre></td></tr></table></figure><p>检查有没有 id_dsa 和 id_dsa.pub 文件。免得之后将其覆盖。</p><p>如果有的话，你可以跳过下一步。</p><h2 id="生成密钥对"><a href="#生成密钥对" class="headerlink" title="生成密钥对"></a>生成密钥对</h2><p>打开终端输入以下命令（修改你的邮箱）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh-keygen -t rsa -C <span class="hljs-string">&quot;your_email@example.com&quot;</span><br></code></pre></td></tr></table></figure><p>会出现下面的内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">Generating public/private rsa key pair.<br>Enter file <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> to save the key (/c/Users/user/.ssh/id_rsa): 回车<br>Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): 回车<br></code></pre></td></tr></table></figure><p>这里你可以重新命名密钥名字，也可以用<code>id_rsa</code>默认的密钥名，所以直接回车两次就好。</p><p>然后如果输出下面内容，表示key创建成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Your identification has been saved <span class="hljs-keyword">in</span> /home/you/.ssh/id_rsa<br></code></pre></td></tr></table></figure><h2 id="添加ssh-agent"><a href="#添加ssh-agent" class="headerlink" title="添加ssh-agent"></a>添加ssh-agent</h2><p>Windows上，如果生成的是默认的id-rsa，那么无需执行此步。</p><p>首先我们要把密钥添加到后台的ssh-agent代理，让他帮我们在需要的时候完成授权任务，运行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">eval</span> <span class="hljs-string">&quot;<span class="hljs-subst">$(ssh-agent -s)</span>&quot;</span><br>ssh-add ~/.ssh/id_rsa<br></code></pre></td></tr></table></figure><h2 id="SSH公钥加入Github账号"><a href="#SSH公钥加入Github账号" class="headerlink" title="SSH公钥加入Github账号"></a>SSH公钥加入Github账号</h2><p>最后一步，我们需要把公钥信息加入到Github的SSH管理中，使用如入命令查看ssh公钥信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> ~/.ssh/id_rsa.pub<br></code></pre></td></tr></table></figure><p>复制公钥信息后，点此<a href="https://github.com/settings/ssh/new">添加SSH密钥</a>：<br><img src="/posts/10342/pub-key.png"></p><p>粘贴公钥到此处即可。</p><p>随后测试下有没有授权成功，运行如下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ssh -T git@github.com<br></code></pre></td></tr></table></figure><p>出现以下信息则算成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Hi 你的用户名! You<span class="hljs-string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></code></pre></td></tr></table></figure><h1 id="修改并提交"><a href="#修改并提交" class="headerlink" title="修改并提交"></a>修改并提交</h1><p>clone下来仓库，用 vscode 进行编辑 README 文件。</p><p>提交的方式太多了，VSCode可以就可以提交并push，GitHub Desktop也可以。但既然是教程，那还是先讲命令行方式。</p><div class="note note-info">            <p>vscode 有很多有意思的插件，比如说 Git Lens ，让你快速使用 git blame，也就是找到每一行代码最后编辑的人是谁。<br>GitHub desktop可以让你直观看到有哪些文件进行了修改，以前的commit记录，等等。</p>          </div><h2 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h2><h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h3><p>所谓commit，就是我某个功能改完啦，暂时不需要改了。那么我先把这个修改提交到暂存区，也就是commit。</p><p>修改后，在项目目录下打开Git Bash，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git commit -m [message]<br></code></pre></td></tr></table></figure><p>[message] 可以是一些备注信息。</p><p>那如果我改了三个文件，但只有两个想提交，第三个还妹改完咋整，可以提交暂存区的指定文件到仓库区：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git commit [file1] [file2] ... -m [message]<br></code></pre></td></tr></table></figure><p>如果你没有设置 -m 选项，Git 会尝试为你打开一个编辑器以填写提交信息。 如果 Git 在你对它的配置中找不到相关信息，默认会打开 vim。屏幕会像这样：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Please enter the commit message for your changes. Lines starting</span><br><span class="hljs-comment"># with &#x27;#&#x27; will be ignored, and an empty message aborts the commit.</span><br><span class="hljs-comment"># On branch master</span><br><span class="hljs-comment"># Changes to be committed:</span><br><span class="hljs-comment">#   (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># modified:   hello.php</span><br><span class="hljs-comment">#</span><br>~<br>~<br><span class="hljs-string">&quot;.git/COMMIT_EDITMSG&quot;</span> 9L, 257C<br></code></pre></td></tr></table></figure><p>这时就使用vim来编辑这里的提交信息就好了，先按i来编辑，编辑好后按esc，然后输入 :wq 按回车退出。</p><p>如果我的修改是新增文件，怎么办？需要先将文件加入git仓库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git add 文件名<br></code></pre></td></tr></table></figure><p>你觉得 git add 提交缓存的流程太过繁琐，Git 也允许你用 -a 选项跳过这一步。命令格式如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git commit -a<br></code></pre></td></tr></table></figure><p>比如说</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git commit -am <span class="hljs-string">&#x27;小白的第一次提交，修改README文件&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p>所谓push，就是把之前用commit保存下来的改变，推送到远程仓库。可以多次commit，然后一次push上去。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git push<br></code></pre></td></tr></table></figure><p>查看远程仓库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git remote --verbose<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;上一篇教程已经将远程的repository clone到了本地并进行了配置，我们来进行第一次提交和修改。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="git" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/git/"/>
    
    
    <category term="git" scheme="https://pawswrite.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>防止GitHub邮箱泄露</title>
    <link href="https://pawswrite.xyz/posts/43272.html"/>
    <id>https://pawswrite.xyz/posts/43272.html</id>
    <published>2022-09-24T08:41:58.000Z</published>
    <updated>2022-10-04T15:51:38.646Z</updated>
    
    <content type="html"><![CDATA[<p>公开仓库的git commit都是可以被查询到用户名和邮箱的，那要如何避免自己邮箱泄露。</p><span id="more"></span><p>当然，在我们进行提交的时候，我们完全可以用一个伪造的邮箱，但这样，当别人查看GitHub上的commit的时候，就不能方便地知道commit是我们提交的。这credit怎能给别人。</p><h1 id="配置匿名邮箱"><a href="#配置匿名邮箱" class="headerlink" title="配置匿名邮箱"></a>配置匿名邮箱</h1><p>首先进入<a href="https://github.com/settings/emails">设置</a>，找到下面这项并勾选：</p><ul><li><input checked="" disabled="" type="checkbox"> Keep my email addresses private</li></ul><p>然后找到下面加粗的电子邮件地址，是一个七位数的 ID 号以及格式为 <code>ID+username@users.noreply.github.com</code> 格式的一串邮箱地址，这就是 GitHub 给你的匿名邮箱地址。</p><blockquote><p> 如果于 2017 年 7 月 18 日之前在 GitHub.com 上创建了帐户，则来自 GitHub 的 noreply 电子邮件地址是 <code>username@users.noreply.github.com</code></p></blockquote><p>根据<a href="https://docs.github.com/cn/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-email-preferences/setting-your-commit-email-address"> GitHub 官方文档</a></p><blockquote><p>如果想将个人电子邮件地址设为私密，则可以使用 GitHub 的 noreply 电子邮件地址作为提交电子邮件地址。 要将 noreply 电子邮件地址用于从命令行推送的提交，请在 Git 中设置提交电子邮件地址时使用该电子邮件地址。 要将 noreply 地址用于基于 Web 的 Git 操作，请在 GitHub 上设置提交电子邮件地址并选择“对我的电子邮件地址保密”。</p></blockquote><p>也就是说，在用命令行提交时，请使用下面命令来全局更改邮箱地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config --global user.email <span class="hljs-string">&quot;ID+username@users.noreply.github.com&quot;</span><br></code></pre></td></tr></table></figure><p>确认一下是不是改成功了：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config --global user.email<br></code></pre></td></tr></table></figure><h1 id="查找过往有没有泄露过信息"><a href="#查找过往有没有泄露过信息" class="headerlink" title="查找过往有没有泄露过信息"></a>查找过往有没有泄露过信息</h1><p>查看一些过往公开信息：<br><code>https://api.github.com/users/用户名</code><br><code>https://api.github.com/users/用户名/events/public</code></p><p>使用Github提供的GraphQL来查询所有提交过的commits来查询用户邮箱：<br>参考：《<a href="https://juejin.cn/post/6951642072935825439">怎么知道Github仓库所有者的联系方式</a>》</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;公开仓库的git commit都是可以被查询到用户名和邮箱的，那要如何避免自己邮箱泄露。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="git" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/git/"/>
    
    
    <category term="git" scheme="https://pawswrite.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>【git实战入门】1. 本地配置git</title>
    <link href="https://pawswrite.xyz/posts/5757.html"/>
    <id>https://pawswrite.xyz/posts/5757.html</id>
    <published>2022-09-24T08:04:35.000Z</published>
    <updated>2022-10-04T15:51:38.668Z</updated>
    
    <content type="html"><![CDATA[<p>Git 是Linus用C语言写的分布式版本管理系统。本文简单讲了如何在windows上安装、配置git，从而进行第一次代码修改提交，并push到GitHub。</p><span id="more"></span><h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><ul><li>Windows 10</li><li>GitHub 账号</li></ul><h1 id="安装-Git"><a href="#安装-Git" class="headerlink" title="安装 Git"></a>安装 Git</h1><h2 id="Linux上安装-Git"><a href="#Linux上安装-Git" class="headerlink" title="Linux上安装 Git"></a>Linux上安装 Git</h2><p>大部分比较新的Linux发行版本都可以用包管理器直接下载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Ubuntu or Debian</span><br>sudo apt install git<br><span class="hljs-comment"># Red Hat or CentOS</span><br>sudo yum install git<br></code></pre></td></tr></table></figure><h2 id="Windows上安装Git"><a href="#Windows上安装Git" class="headerlink" title="Windows上安装Git"></a>Windows上安装Git</h2><p>点此👉<a href="https://git-scm.com/downloads">Git官网下载</a></p><p>官网还可以下载 GitHub Desktop 这类挺好用的软件</p><p>安装完成后，在开始菜单里找到“Git”-&gt;“Git Bash”，蹦出一个类似命令行窗口的东西，就说明Git安装成功！</p><p>也可以在项目文件夹空白处点击右键，来快捷打开Git Bash<br><img src="/posts/5757/git-installed.png"></p><h1 id="GitHub-新建-repository"><a href="#GitHub-新建-repository" class="headerlink" title="GitHub 新建 repository"></a>GitHub 新建 repository</h1><p>登录 <a href="https://github.com/login">GitHub</a>，输入账号密码，点此<a href="https://github.com/new">新建repository</a>，需要输入下列信息：</p><ul><li>Repository name - 仓库名</li><li>Description     - 仓库简要描述（可选）</li><li>Public&#x2F;Private  - 公开或私有仓库</li><li>Add a README file - 是否要添加README文件</li></ul><p><img src="/posts/5757/new-repo.png"></p><p>因为是教程，建议大家选择Public，并勾选README</p><ul><li><input checked="" disabled="" type="checkbox"> Add a README file</li></ul><h2 id="更多（可以不看）"><a href="#更多（可以不看）" class="headerlink" title="更多（可以不看）"></a>更多（可以不看）</h2><h3 id="gitinore-文件"><a href="#gitinore-文件" class="headerlink" title=".gitinore 文件"></a>.gitinore 文件</h3><p>gitignore 就是 git ignore 的意思，当我们写代码的时候，有一些文件是你想添加进仓库，来进行版本管理的，但常常也有一些文件是<strong>没必要加入版本管理</strong>的，比如说，配置文件，比如说代码的编译文件，比如说运行python代码时生成的pyc文件，这些完全没必要加入仓库里。</p><p>.gitinore 就可以帮助我们，忽略这些文件，并且在我们使用命令 <code>git add .</code> （把当前文件夹下所有都加入git）的时候，自动忽略某些文件。</p><h3 id="License"><a href="#License" class="headerlink" title="License"></a>License</h3><p>开源证书，可以自己搜搜不同开源证书的区别和限制。</p><h1 id="克隆仓库"><a href="#克隆仓库" class="headerlink" title="克隆仓库"></a>克隆仓库</h1><p>对于公开仓库，可以直接方便：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/用户名/仓库名.git<br></code></pre></td></tr></table></figure><h1 id="配置-Git"><a href="#配置-Git" class="headerlink" title="配置 Git"></a>配置 Git</h1><p>最基础的配置是，告诉git你的名字和邮箱，这里对应的，你可以写入你GitHub的用户名和邮箱。</p><div class="note note-warning">            <p>如果你在公开的repository进行了任何提交，那么你对应设置的邮箱也将被公开。可以查看另一篇文章来使用 GitHub 匿名邮箱。</p>          </div><h2 id="设置用户名和电子邮件地址"><a href="#设置用户名和电子邮件地址" class="headerlink" title="设置用户名和电子邮件地址"></a>设置用户名和电子邮件地址</h2><h3 id="全局设置"><a href="#全局设置" class="headerlink" title="全局设置"></a>全局设置</h3><p>对于没有设置用户名和电子邮件地址的仓库，将会默认使用全局配置，所以如果是第一次配置，可以直接全局配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config --global user.name <span class="hljs-string">&quot;用户名&quot;</span><br>git config --global user.email <span class="hljs-string">&quot;email@example.com&quot;</span><br></code></pre></td></tr></table></figure><p>如果仅需要对某个本地仓库的配置进行修改，那么就在该仓库目录下打开Git bash:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">git config user.name <span class="hljs-string">&quot;用户名&quot;</span><br>git config user.email <span class="hljs-string">&quot;email@example.com&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;Git 是Linus用C语言写的分布式版本管理系统。本文简单讲了如何在windows上安装、配置git，从而进行第一次代码修改提交，并push到GitHub。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="git" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/git/"/>
    
    
    <category term="git" scheme="https://pawswrite.xyz/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>install chrome in windows server using powershell</title>
    <link href="https://pawswrite.xyz/posts/64311.html"/>
    <id>https://pawswrite.xyz/posts/64311.html</id>
    <published>2022-08-20T04:33:58.000Z</published>
    <updated>2022-10-04T15:51:38.654Z</updated>
    
    <content type="html"><![CDATA[<p>PowerShell 安装 chrome</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bat">$LocalTempDir = $env:TEMP; $ChromeInstaller = &quot;ChromeInstaller.exe&quot;; (new-object    System.<span class="hljs-built_in">Net</span>.WebClient).DownloadFile(&#x27;http://dl.google.com/chrome/install/<span class="hljs-number">375</span>.<span class="hljs-number">126</span>/chrome_installer.exe&#x27;, &quot;$LocalTempDir\$ChromeInstaller&quot;); &amp; &quot;$LocalTempDir\$ChromeInstaller&quot; /silent /install; $Process2Monitor =  &quot;ChromeInstaller&quot;; <span class="hljs-keyword">Do</span> &#123; $ProcessesFound = Get-Process | ?&#123;$Process2Monitor -contains $_.Name&#125; | Select-Object -ExpandProperty Name; <span class="hljs-keyword">If</span> ($ProcessesFound) &#123; &quot;Still running: $($ProcessesFound -join &#x27;, &#x27;)&quot; | Write-Host; <span class="hljs-built_in">Start</span>-Sleep -Seconds <span class="hljs-number">2</span> &#125; <span class="hljs-keyword">else</span> &#123; rm &quot;$LocalTempDir\$ChromeInstaller&quot; -ErrorAction SilentlyContinue -Verbose &#125; &#125; Until (!$ProcessesFound)<br></code></pre></td></tr></table></figure><p>PowerShell 安装 python3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmdlet">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://community.chocolatey.org/install.ps1&#x27;))<br>choco install -y python3<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;PowerShell 安装 chrome&lt;/p&gt;
&lt;figure class=&quot;highlight bat&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td c</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>nginx 反向代理 cloudflare 网站出现 502 报错</title>
    <link href="https://pawswrite.xyz/posts/55676.html"/>
    <id>https://pawswrite.xyz/posts/55676.html</id>
    <published>2022-08-15T18:54:40.000Z</published>
    <updated>2022-10-04T15:51:38.662Z</updated>
    
    <content type="html"><![CDATA[<p><strong>【非原创，学习笔记】</strong><br>反代一个网站，一直502</p><span id="more"></span><p>error_log 输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs log">SSL_do_handshake() failed (SSL: error:14094410:SSL routines:ssl3_read_bytes:sslv3 ale                                 rt handshake failure:SSL alert number 40) while SSL handshaking to upstream, <br></code></pre></td></tr></table></figure><p>解决办法：nginx反代时启动SNI以避免反代CF时出现问题。在反向代理块增加一行<code>proxy_ssl_server_name on;</code>即可解决问题。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;strong&gt;【非原创，学习笔记】&lt;/strong&gt;&lt;br&gt;反代一个网站，一直502&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Nginx/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/tags/Nginx/"/>
    
    <category term="运维" scheme="https://pawswrite.xyz/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>nginx regex rules</title>
    <link href="https://pawswrite.xyz/posts/6732.html"/>
    <id>https://pawswrite.xyz/posts/6732.html</id>
    <published>2022-08-15T17:37:20.000Z</published>
    <updated>2022-10-04T15:51:38.660Z</updated>
    
    <content type="html"><![CDATA[<p>非原创，学习笔记。出处👉<a href="https://blog.csdn.net/weixin_44299027/article/details/107286956">nginx location正则表达式写法</a></p><span id="more"></span><h1 id="常用规则"><a href="#常用规则" class="headerlink" title="常用规则"></a>常用规则</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">location</span>  <span class="hljs-string">=</span> <span class="hljs-string">/</span> &#123;<br>  <span class="hljs-comment"># 精确匹配 / ，主机名后面不能带任何字符串</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">A</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span>  <span class="hljs-string">/</span> &#123;<br>  <span class="hljs-comment"># 因为所有的地址都以 / 开头，所以这条规则将匹配到所有请求</span><br>  <span class="hljs-comment"># 但是正则和最长字符串会优先匹配</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">B</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">/documents/</span> &#123;<br>  <span class="hljs-comment"># 匹配任何以 /documents/ 开头的地址，匹配符合以后，还要继续往下搜索</span><br>  <span class="hljs-comment"># 只有后面的正则表达式没有匹配到时，这一条才会采用这一条</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">C</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">~</span> <span class="hljs-string">/documents/Abc</span> &#123;<br>  <span class="hljs-comment"># 匹配任何以 /documents/ 开头的地址，匹配符合以后，还要继续往下搜索</span><br>  <span class="hljs-comment"># 只有后面的正则表达式没有匹配到时，这一条才会采用这一条</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">CC</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">^~</span> <span class="hljs-string">/images/</span> &#123;<br>  <span class="hljs-comment"># 匹配任何以 /images/ 开头的地址，匹配符合以后，停止往下搜索正则，采用这一条。</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">D</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">~*</span> <span class="hljs-string">\.(gif|jpg|jpeg)$</span> &#123;<br>  <span class="hljs-comment"># 匹配所有以 gif,jpg或jpeg 结尾的请求</span><br>  <span class="hljs-comment"># 然而，所有请求 /images/ 下的图片会被 config D 处理，因为 ^~ 到达不了这一条正则</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">E</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">/images/</span> &#123;<br>  <span class="hljs-comment"># 字符匹配到 /images/，继续往下，会发现 ^~ 存在</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">F</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">/images/abc</span> &#123;<br>  <span class="hljs-comment"># 最长字符匹配到 /images/abc，继续往下，会发现 ^~ 存在</span><br>  <span class="hljs-comment"># F与G的放置顺序是没有关系的</span><br>  [ <span class="hljs-string">configuration</span> <span class="hljs-string">G</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">~</span> <span class="hljs-string">/images/abc/</span> &#123;<br>  <span class="hljs-comment"># 只有去掉 config D 才有效：先最长匹配 config G 开头的地址，继续往下搜索，匹配到这一条正则，采用</span><br>    [ <span class="hljs-string">configuration</span> <span class="hljs-string">H</span> ] <br>&#125;<br> <br><span class="hljs-string">location</span> <span class="hljs-string">~*</span> <span class="hljs-string">/js/.*/\.js</span><br></code></pre></td></tr></table></figure><ul><li>已&#x3D;开头表示精确匹配</li><li>如 A 中只匹配根目录结尾的请求，后面不能带任何字符串。</li><li>^~ 开头表示uri以某个常规字符串开头，不是正则匹配</li><li>~ 开头表示区分大小写的正则匹配;</li><li>~* 开头表示不区分大小写的正则匹配</li><li>&#x2F; 通用匹配, 如果没有其它匹配,任何请求都会匹配到</li></ul><p>顺序和优先级：<br><code>( location = ) &gt; ( location 完整路径 ) &gt; ( location ^~ 路径 ) &gt; ( location ~,~* 正则顺序 ) &gt; ( location 部分起始路径 ) &gt; ( / ) </code></p><p>上面的匹配结果<br>按照上面的location写法，以下的匹配示例成立：</p><ul><li>&#x2F; -&gt; config A<br>精确完全匹配，即使&#x2F;index.html也匹配不了</li><li>&#x2F;downloads&#x2F;download.html -&gt; config B<br>匹配B以后，往下没有任何匹配，采用B</li><li>&#x2F;images&#x2F;1.gif -&gt; configuration D<br>匹配到F，往下匹配到D，停止往下</li><li>&#x2F;images&#x2F;abc&#x2F;def -&gt; config D<br>最长匹配到G，往下匹配D，停止往下<br>你可以看到 任何以&#x2F;images&#x2F;开头的都会匹配到D并停止，FG写在这里是没有任何意义的，H是永远轮不到的，这里只是为了说明匹配顺序</li><li>&#x2F;documents&#x2F;document.html -&gt; config C<br>匹配到C，往下没有任何匹配，采用C</li><li>&#x2F;documents&#x2F;1.jpg -&gt; configuration E<br>匹配到C，往下正则匹配到E</li><li>&#x2F;documents&#x2F;Abc.jpg -&gt; config CC<br>最长匹配到C，往下正则顺序匹配到CC，不会往下到E</li></ul><h1 id="实际使用建议"><a href="#实际使用建议" class="headerlink" title="实际使用建议"></a>实际使用建议</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">所以实际使用中，通常建议至少有三个匹配规则定义，如下：</span><br><span class="hljs-comment">#直接匹配网站根，通过域名访问网站首页比较频繁，使用这个会加速处理，比如说官网。</span><br><span class="hljs-comment">#这里是直接转发给后端应用服务器了，也可以是一个静态首页</span><br><span class="hljs-comment"># 第一个必选规则</span><br><span class="hljs-string">location</span> <span class="hljs-string">=</span> <span class="hljs-string">/</span> &#123;<br>    <span class="hljs-string">proxy_pass</span> <span class="hljs-string">http://localhost:8080/index</span><br>&#125;<br><span class="hljs-comment"># 第二个必选规则是处理静态文件请求，这是nginx作为http服务器的强项</span><br><span class="hljs-comment"># 有两种配置模式，目录匹配或后缀匹配,任选其一或搭配使用</span><br><span class="hljs-string">location</span> <span class="hljs-string">^~</span> <span class="hljs-string">/static/</span> &#123;<br>    <span class="hljs-string">root</span> <span class="hljs-string">/webroot/static/;</span><br>&#125;<br><span class="hljs-string">location</span> <span class="hljs-string">~*</span> <span class="hljs-string">\.(gif|jpg|jpeg|png|css|js|ico)$</span> &#123;<br>    <span class="hljs-string">root</span> <span class="hljs-string">/webroot/res/;</span><br>&#125;<br><span class="hljs-comment">#第三个规则就是通用规则，用来转发动态请求到后端应用服务器</span><br><span class="hljs-comment">#非静态文件请求就默认是动态请求，自己根据实际把握</span><br><span class="hljs-comment">#毕竟目前的一些框架的流行，带.php,.jsp后缀的情况很少了</span><br><span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>    <span class="hljs-string">proxy_pass</span> <span class="hljs-string">http://localhost:8080/</span><br></code></pre></td></tr></table></figure><h1 id="Flag标志位"><a href="#Flag标志位" class="headerlink" title="Flag标志位"></a>Flag标志位</h1><ul><li>last : 相当于Apache的[L]标记，表示完成rewrite</li><li>break : 停止执行当前虚拟主机的后续rewrite指令集</li><li>redirect : 返回302临时重定向，地址栏会显示跳转后的地址</li><li>permanent : 返回301永久重定向，地址栏会显示跳转后的地址</li></ul><p>因为301和302不能简单的只返回状态码，还必须有重定向的URL，这就是return指令无法返回301,302的原因了。这里 last 和 break 区别有点难以理解：</p><ol><li>last一般写在server和if中，而break一般使用在location中</li><li>last不终止重写后的url匹配，即新的url会再从server走一遍匹配流程，而break终止重写后的匹配</li><li>break和last都能组织继续执行后面的rewrite指令</li></ol><h1 id="If-判断指令"><a href="#If-判断指令" class="headerlink" title="If 判断指令"></a>If 判断指令</h1><p>语法为if(condition){…}，对给定的条件condition进行判断。如果为真，大括号内的rewrite指令将被执行，if条件(conditon)可以是如下任何内容：</p><ul><li>当表达式只是一个变量时，如果值为空或任何以0开头的字符串都会当做false</li><li>直接比较变量和内容时，使用&#x3D;或!&#x3D;</li><li><del>正则表达式匹配，</del>*不区分大小写的匹配，!~区分大小写的不匹配</li></ul><p>-f和!-f用来判断是否存在文件<br>-d和!-d用来判断是否存在目录<br>-e和!-e用来判断是否存在文件或目录<br>-x和!-x用来判断文件是否可执行</p><p>比如：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">if</span> <span class="hljs-string">($http_user_agent</span> <span class="hljs-string">~</span> <span class="hljs-string">MSIE)</span> &#123;<br>    <span class="hljs-string">rewrite</span> <span class="hljs-string">^(.*)$</span> <span class="hljs-string">/msie/$1</span> <span class="hljs-string">break;</span><br>&#125; <span class="hljs-string">//如果UA包含&quot;MSIE&quot;，rewrite请求到/msid/目录下</span><br> <br><span class="hljs-string">if</span> <span class="hljs-string">($http_cookie</span> <span class="hljs-string">~*</span> <span class="hljs-string">&quot;id=([^;]+)(?:;|$)&quot;</span><span class="hljs-string">)</span> &#123;<br>    <span class="hljs-string">set</span> <span class="hljs-string">$id</span> <span class="hljs-string">$1;</span><br> &#125; <span class="hljs-string">//如果cookie匹配正则，设置变量$id等于正则引用部分</span><br> <br><span class="hljs-string">if</span> <span class="hljs-string">($request_method</span> <span class="hljs-string">=</span> <span class="hljs-string">POST)</span> &#123;<br>    <span class="hljs-string">return</span> <span class="hljs-number">405</span><span class="hljs-string">;</span><br>&#125; <span class="hljs-string">//如果提交方法为POST，则返回状态405（Method</span> <span class="hljs-string">not</span> <span class="hljs-string">allowed）。return不能返回301,302</span><br> <br><span class="hljs-string">if</span> <span class="hljs-string">($slow)</span> &#123;<br>    <span class="hljs-string">limit_rate</span> <span class="hljs-string">10k;</span><br>&#125; <span class="hljs-string">//限速，$slow可以通过</span> <span class="hljs-string">set</span> <span class="hljs-string">指令设置</span><br> <br><span class="hljs-string">if</span> <span class="hljs-string">(!-f</span> <span class="hljs-string">$request_filename)&#123;</span><br>    <span class="hljs-string">break;</span><br>    <span class="hljs-string">proxy_pass</span>  <span class="hljs-string">http://127.0.0.1;</span> <br><span class="hljs-string">&#125;</span> <span class="hljs-string">//如果请求的文件名不存在，则反向代理到localhost</span> <span class="hljs-string">。这里的break也是停止rewrite检查</span><br> <br><span class="hljs-string">if</span> <span class="hljs-string">($args</span> <span class="hljs-string">~</span> <span class="hljs-string">post=140)&#123;</span><br>    <span class="hljs-string">rewrite</span> <span class="hljs-string">^</span> <span class="hljs-string">http://example.com/</span> <span class="hljs-string">permanent;</span><br><span class="hljs-string">&#125;</span> <span class="hljs-string">//如果query</span> <span class="hljs-string">string中包含&quot;post=140&quot;，永久重定向到example.com</span><br> <br><span class="hljs-string">location</span> <span class="hljs-string">~*</span> <span class="hljs-string">\.(gif|jpg|png|swf|flv)$</span> &#123;<br>    <span class="hljs-string">valid_referers</span> <span class="hljs-string">none</span> <span class="hljs-string">blocked</span> <span class="hljs-string">www.jefflei.com</span> <span class="hljs-string">www.leizhenfang.com;</span><br>    <span class="hljs-string">if</span> <span class="hljs-string">($invalid_referer)</span> &#123;<br>        <span class="hljs-string">return</span> <span class="hljs-number">404</span><span class="hljs-string">;</span><br>    &#125; <span class="hljs-string">//防盗链</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h1><p>下面是可以用作if判断的全局变量</p><ul><li>$args ： #这个变量等于请求行中的参数，同$query_string</li><li>$content_length ： 请求头中的Content-length字段。</li><li>$content_type ： 请求头中的Content-Type字段。</li><li>$document_root ： 当前请求在root指令中指定的值。</li><li>$host ： 请求主机头字段，否则为服务器名称。</li><li>$http_user_agent ： 客户端agent信息</li><li>$http_cookie ： 客户端cookie信息</li><li>$limit_rate ： 这个变量可以限制连接速率。</li><li>$request_method ： 客户端请求的动作，通常为GET或POST。</li><li>$remote_addr ： 客户端的IP地址。</li><li>$remote_port ： 客户端的端口。</li><li>$remote_user ： 已经经过Auth Basic Module验证的用户名。</li><li>$request_filename ： 当前请求的文件路径，由root或alias指令与URI请求生成。</li><li>$scheme ： HTTP方法（如http，https）。</li><li>$server_protocol ： 请求使用的协议，通常是HTTP&#x2F;1.0或HTTP&#x2F;1.1。</li><li>$server_addr ： 服务器地址，在完成一次系统调用后可以确定这个值。</li><li>$server_name ： 服务器名称。</li><li>$server_port ： 请求到达服务器的端口号。</li><li>$request_uri ： 包含请求参数的原始URI，不包含主机名，如：”&#x2F;foo&#x2F;bar.php?arg&#x3D;baz”。</li><li>$uri ： 不带请求参数的当前URI，$uri不包含主机名，如”&#x2F;foo&#x2F;bar.html”。</li><li>$document_uri ： 与$uri相同。</li></ul><h1 id="常用正则"><a href="#常用正则" class="headerlink" title="常用正则"></a>常用正则</h1><p>常用正则<br>. ： 匹配除换行符以外的任意字符<br>? ： 重复0次或1次</p><ul><li>： 重复1次或更多次</li></ul><ul><li>： 重复0次或更多次<br>\d ：匹配数字<br>^ ： 匹配字符串的开始<br>$ ： 匹配字符串的介绍<br>{n} ： 重复n次<br>{n,} ： 重复n次或更多次<br>[c] ： 匹配单个字符c<br>[a-z] ： 匹配a-z小写字母的任意一个</li></ul><p>小括号()之间匹配的内容，可以在后面通过$1来引用，$2表示的是前面第二个()里的内容。正则里面容易让人困惑的是\转义特殊字符。</p><h1 id="Rewrite规则"><a href="#Rewrite规则" class="headerlink" title="Rewrite规则"></a>Rewrite规则</h1><p>rewrite功能就是，使用nginx提供的全局变量或自己设置的变量，结合正则表达式和标志位实现url重写以及重定向。rewrite只能放在server{},location{},if{}中，并且只能对域名后边的除去传递的参数外的字符串起作用，例如 <a href="http://seanlook.com/a/we/index.php?id=1&amp;u=str">http://seanlook.com/a/we/index.php?id=1&amp;u=str</a> 只对&#x2F;a&#x2F;we&#x2F;index.php重写。语法rewrite regex replacement [flag];</p><p>如果相对域名或参数字符串起作用，可以使用全局变量匹配，也可以使用proxy_pass反向代理。</p><p>表明看rewrite和location功能有点像，都能实现跳转，主要区别在于rewrite是在同一域名内更改获取资源的路径，而location是对一类路径做控制访问或反向代理，可以proxy_pass到其他机器。很多情况下rewrite也会写在location里，它们的执行顺序是：</p><ol><li>执行server块的rewrite指令</li><li>执行location匹配</li><li>执行选定的location中的rewrite指令</li></ol><p>如果其中某步URI被重写，则重新循环执行1-3，直到找到真实存在的文件；循环超过10次，则返回500 Internal Server Error错误。</p><h1 id="Rewrite实例"><a href="#Rewrite实例" class="headerlink" title="Rewrite实例"></a>Rewrite实例</h1><p>以下先写两个例子，后续再补充</p><h2 id="实例1"><a href="#实例1" class="headerlink" title="实例1"></a>实例1</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">http</span> &#123;<br>    <span class="hljs-comment"># 定义image日志格式</span><br>    <span class="hljs-string">log_format</span> <span class="hljs-string">imagelog</span> <span class="hljs-string">&#x27;[$time_local] &#x27;</span> <span class="hljs-string">$image_file</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">$image_type</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">$body_bytes_sent</span> <span class="hljs-string">&#x27; &#x27;</span> <span class="hljs-string">$status;</span><br>    <span class="hljs-comment"># 开启重写日志</span><br>    <span class="hljs-string">rewrite_log</span> <span class="hljs-string">on;</span><br> <br>    <span class="hljs-string">server</span> &#123;<br>        <span class="hljs-string">root</span> <span class="hljs-string">/home/www;</span><br> <br>        <span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>                <span class="hljs-comment"># 重写规则信息</span><br>                <span class="hljs-string">error_log</span> <span class="hljs-string">logs/rewrite.log</span> <span class="hljs-string">notice;</span> <br>                <span class="hljs-comment"># 注意这里要用‘’单引号引起来，避免&#123;&#125;</span><br>                <span class="hljs-string">rewrite</span> <span class="hljs-string">&#x27;^/images/([a-z]&#123;2&#125;)/([a-z0-9]&#123;5&#125;)/(.*)\.(png|jpg|gif)$&#x27;</span> <span class="hljs-string">/data?file=$3.$4;</span><br>                <span class="hljs-comment"># 注意不能在上面这条规则后面加上“last”参数，否则下面的set指令不会执行</span><br>                <span class="hljs-string">set</span> <span class="hljs-string">$image_file</span> <span class="hljs-string">$3;</span><br>                <span class="hljs-string">set</span> <span class="hljs-string">$image_type</span> <span class="hljs-string">$4;</span><br>        &#125;<br> <br>        <span class="hljs-string">location</span> <span class="hljs-string">/data</span> &#123;<br>                <span class="hljs-comment"># 指定针对图片的日志格式，来分析图片类型和大小</span><br>                <span class="hljs-string">access_log</span> <span class="hljs-string">logs/images.log</span> <span class="hljs-string">mian;</span><br>                <span class="hljs-string">root</span> <span class="hljs-string">/data/images;</span><br>                <span class="hljs-comment"># 应用前面定义的变量。判断首先文件在不在，不在再判断目录在不在，如果还不在就跳转到最后一个url里</span><br>                <span class="hljs-string">try_files</span> <span class="hljs-string">/$arg_file</span> <span class="hljs-string">/image404.html;</span><br>        &#125;<br>        <span class="hljs-string">location</span> <span class="hljs-string">=</span> <span class="hljs-string">/image404.html</span> &#123;<br>                <span class="hljs-comment"># 图片不存在返回特定的信息</span><br>                <span class="hljs-string">return</span> <span class="hljs-number">404</span> <span class="hljs-string">&quot;image not found\n&quot;</span><span class="hljs-string">;</span><br>        &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>对形如&#x2F;images&#x2F;ef&#x2F;uh7b3&#x2F;test.png的请求，重写到&#x2F;data?file&#x3D;test.png，于是匹配到location &#x2F;data，先看&#x2F;data&#x2F;images&#x2F;test.png文件存不存在，如果存在则正常响应，如果不存在则重写tryfiles到新的image404 location，直接返回404状态码。</p><h2 id="实例二"><a href="#实例二" class="headerlink" title="实例二"></a>实例二</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">rewrite</span> <span class="hljs-string">^/images/(.*)_(\d+)x(\d+)\.(png|jpg|gif)$</span> <span class="hljs-string">/resizer/$1.$4?width=$2&amp;height=$3?</span> <span class="hljs-string">last;</span><br></code></pre></td></tr></table></figure><p>对形如&#x2F;images&#x2F;bla_500x400.jpg的文件请求，重写到&#x2F;resizer&#x2F;bla.jpg?width&#x3D;500&amp;height&#x3D;400地址，并会继续尝试匹配location。</p><h1 id="项目实例"><a href="#项目实例" class="headerlink" title="项目实例"></a>项目实例</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs yaml"> <br><span class="hljs-comment">#user  nobody;</span><br><span class="hljs-string">worker_processes</span>  <span class="hljs-number">1</span><span class="hljs-string">;</span><br> <br><span class="hljs-comment">#error_log  logs/error.log;</span><br><span class="hljs-comment">#error_log  logs/error.log  notice;</span><br><span class="hljs-comment">#error_log  logs/error.log  info;</span><br> <br><span class="hljs-comment">#pid        logs/nginx.pid;</span><br> <br> <br><span class="hljs-string">events</span> &#123;<br>    <span class="hljs-string">worker_connections</span>  <span class="hljs-number">1024</span><span class="hljs-string">;</span><br>&#125;<br> <br><span class="hljs-string">http</span> &#123;<br>    <span class="hljs-string">include</span>       <span class="hljs-string">mime.types;</span><br>    <span class="hljs-string">default_type</span>  <span class="hljs-string">application/octet-stream;</span><br> <br>    <span class="hljs-comment">#access_log  logs/access.log  main;</span><br> <br>    <span class="hljs-string">sendfile</span>        <span class="hljs-string">on;</span><br>    <span class="hljs-comment">#tcp_nopush     on;</span><br> <br>    <span class="hljs-comment">#keepalive_timeout  0;</span><br>    <span class="hljs-string">keepalive_timeout</span>  <span class="hljs-number">65</span><span class="hljs-string">;</span><br> <br>    <span class="hljs-comment">#gzip  on;</span><br> <br>    <span class="hljs-string">server</span> &#123;<br>        <span class="hljs-string">listen</span>       <span class="hljs-number">9000</span><span class="hljs-string">;</span><br>        <span class="hljs-string">server_name</span>  <span class="hljs-string">*.unisiot.com;</span><br> <br>        <span class="hljs-comment">#charset koi8-r;</span><br> <br>        <span class="hljs-comment">#access_log  logs/host.access.log  main;</span><br><br><span class="hljs-string">ssi</span> <span class="hljs-string">on;</span><br><span class="hljs-string">ssi_silent_errors</span> <span class="hljs-string">on;</span><br><span class="hljs-string">ssi_types</span> <span class="hljs-string">text/shtml;</span><br><span class="hljs-string">expires</span> <span class="hljs-string">30d;</span><br><br><span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>   <br>   <span class="hljs-string">if</span> <span class="hljs-string">($host</span> <span class="hljs-string">~</span> <span class="hljs-string">(^\S*?(?=\.\S*)))</span>&#123;<br><span class="hljs-string">set</span> <span class="hljs-string">$dns</span> <span class="hljs-string">$1;</span><br>   &#125;<br>   <span class="hljs-string">alias</span> <span class="hljs-string">F:/upload_file_root/subsite/$dns;</span><br>   <span class="hljs-string">index</span> <span class="hljs-string">index.html;</span><br>   <br>   <span class="hljs-comment">#判断终端</span><br>    <span class="hljs-string">if</span> <span class="hljs-string">($http_user_agent</span> <span class="hljs-string">~*</span> <span class="hljs-string">&#x27;(Android|webOS|iPhone|iPod|BlackBerry|iPad)&#x27;</span><span class="hljs-string">)</span> &#123;<br>               <span class="hljs-string">set</span> <span class="hljs-string">$mobile_request</span> <span class="hljs-string">&#x27;1&#x27;</span><span class="hljs-string">;</span><br>               <span class="hljs-comment">#如果访问UA为移动终端类型则判断为mobile_request=1</span><br>            &#125;<br>            <span class="hljs-string">if</span> <span class="hljs-string">($http_cookie</span> <span class="hljs-string">~</span> <span class="hljs-string">&#x27;mobile_request=full&#x27;</span><span class="hljs-string">)</span> &#123;<br>               <span class="hljs-string">set</span> <span class="hljs-string">$mobile_request</span> <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">;</span><br>            &#125;<br>            <span class="hljs-string">if</span> <span class="hljs-string">($mobile_request</span> <span class="hljs-string">=</span> <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">)</span> &#123;<br>               <span class="hljs-comment">#proxy_pass http://139.196.188.213;</span><br>   <span class="hljs-comment">#判断mobile_request等于空则为PC终端</span><br>   <span class="hljs-string">root</span>   <span class="hljs-string">F:/upload_file_root/subsite/$dns/web;</span><br>            &#125;<br>        <br>            <span class="hljs-comment">#break; </span><br><br><span class="hljs-string">if</span> <span class="hljs-string">($uri</span> <span class="hljs-string">~*</span> <span class="hljs-string">&#x27;(lobby|bedroom|livingroom|lavatory|kitchen|videoroom)&#x27;</span><span class="hljs-string">)</span> &#123;<br><span class="hljs-string">root</span>   <span class="hljs-string">F:/upload_file_root/subsite/$dns;</span><br>&#125;<br>&#125;<br><br><span class="hljs-string">location</span> <span class="hljs-string">/commonHtml</span> &#123;<br>            <span class="hljs-string">alias</span>   <span class="hljs-string">F:/upload_file_root/common/;</span>     <br>        &#125; <br><br><span class="hljs-string">location</span> <span class="hljs-string">~</span> <span class="hljs-string">^/(BJUI|ckeditor4.8|common|images|js|nice-validator|www|static)/</span> &#123;<br>            <span class="hljs-string">root</span>   <span class="hljs-string">F:/upload_file_root/static;</span> <br>            <span class="hljs-string">autoindex</span> <span class="hljs-string">on;</span><br>            <span class="hljs-string">access_log</span>  <span class="hljs-string">off;</span><br>            <span class="hljs-string">expires</span>     <span class="hljs-string">30d;</span>          <br>        &#125;<br><br><span class="hljs-string">location</span> <span class="hljs-string">~</span> <span class="hljs-string">^/(upload)/</span> &#123;<br>            <span class="hljs-string">root</span>   <span class="hljs-string">F:/upload_file_root/;</span> <br>            <span class="hljs-string">autoindex</span> <span class="hljs-string">on;</span><br>            <span class="hljs-string">access_log</span>  <span class="hljs-string">off;</span><br>            <span class="hljs-string">expires</span>     <span class="hljs-string">30d;</span>          <br>        &#125;<br><br>        <span class="hljs-comment">#error_page  404              /404.html;</span><br>        <span class="hljs-comment"># redirect server error pages to the static page /50x.html</span><br>        <span class="hljs-comment">#</span><br>        <span class="hljs-string">error_page</span>   <span class="hljs-number">500</span> <span class="hljs-number">502</span> <span class="hljs-number">503</span> <span class="hljs-number">504</span>  <span class="hljs-string">/50x.html;</span><br>        <span class="hljs-string">location</span> <span class="hljs-string">=</span> <span class="hljs-string">/50x.html</span> &#123;<br>            <span class="hljs-string">root</span>   <span class="hljs-string">html;</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>原文：<a href="https://blog.csdn.net/weixin_44299027/article/details/107286956">【Nginx用法】nginx location正则表达式写法，详解Nginx location 匹配规则（很详细哦）</a></p><p>【参考资料】</p><p>1、nginx平台初探(100%)：<a href="http://tengine.taobao.org/book/chapter_02.html">nginx平台初探(100%) — Nginx开发从入门到精通</a></p><p>2、Module ngx_http_rewrite_module：<a href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">Module ngx_http_rewrite_module</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;非原创，学习笔记。出处👉&lt;a href=&quot;https://blog.csdn.net/weixin_44299027/article/details/107286956&quot;&gt;nginx location正则表达式写法&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Nginx/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/tags/Nginx/"/>
    
    <category term="运维" scheme="https://pawswrite.xyz/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>selenium 模拟点击hcaptcha和recaptcha验证码</title>
    <link href="https://pawswrite.xyz/posts/13934.html"/>
    <id>https://pawswrite.xyz/posts/13934.html</id>
    <published>2022-08-12T12:22:28.000Z</published>
    <updated>2022-10-04T15:51:38.663Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.selenium.dev/">selenium</a> 是一个调用浏览器进行自动化控制的包，支持Java Python CSharp Ruby JavaScript Kotlin。用它可以模拟点击、输入，进行人类的操作。本篇文章以python模拟点击验证码为例来说明selenium的使用。</p><blockquote><p>本文非原创，而是作者的学习笔记</p></blockquote><span id="more"></span><h1 id="hcaptcha"><a href="#hcaptcha" class="headerlink" title="hcaptcha"></a>hcaptcha</h1><p>HCaptcha 的 <a href="https://democaptcha.com/demo-form-eng/hcaptcha.html">Demo 网站</a>如下，打开之后，我们可以看到如下的验证码入口页面：<br><a href="https://democaptcha.com/demo-form-eng/hcaptcha.html">https://democaptcha.com/demo-form-eng/hcaptcha.html</a></p><p><img src="/posts/13934/hcaptcha_demo.png"></p><p>点击复选框时，验证码会先通过其风险分析引擎判断当前用户的风险，如果是低风险用户，便可以直接通过，反之，验证码会弹出对话框，让我们回答对话框中的问题。其实这个比 ReCaptcha 简单一些，它的验证码图片每次一定是 3x3 的，没有 4x4 的，而且点击一个图之后不会再出现一个新的小图让我们二次选择，所以其破解思路也相对简单一些。‘</p><h2 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h2><p><a href="https://github.com/Python3WebSpider/HCaptchaResolver">https://github.com/Python3WebSpider/HCaptchaResolver</a> </p><h2 id="识别封装"><a href="#识别封装" class="headerlink" title="识别封装"></a>识别封装</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> selenium <span class="hljs-keyword">import</span> webdriver<br><span class="hljs-keyword">from</span> selenium.webdriver.support.wait <span class="hljs-keyword">import</span> WebDriverWait<br><span class="hljs-keyword">from</span> selenium.webdriver.remote.webelement <span class="hljs-keyword">import</span> WebElement<br><span class="hljs-keyword">from</span> selenium.webdriver.common.action_chains <span class="hljs-keyword">import</span> ActionChains<br><span class="hljs-keyword">from</span> app.captcha_resolver <span class="hljs-keyword">import</span> CaptchaResolver<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Solution</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, url</span>):<br>        self.browser = webdriver.Chrome()<br>        self.browser.get(url)<br>        self.wait = WebDriverWait(self.browser, <span class="hljs-number">10</span>)<br>        self.captcha_resolver = CaptchaResolver()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__del__</span>(<span class="hljs-params">self</span>):<br>        time.sleep(<span class="hljs-number">10</span>)<br>        self.browser.close()<br></code></pre></td></tr></table></figure><h2 id="iframe-切换支持"><a href="#iframe-切换支持" class="headerlink" title="iframe 切换支持"></a>iframe 切换支持</h2><p>这个验证码和 ReCaptcha 都是在 iframe 里面加载的，另外弹出的验证码图片又在另外一个 iframe 里面。所以需要切换 iframe</p><p><img src="/posts/13934/hcaptcha_entry_iframe.png"></p><p>分别能够支持切换到入口对应的 iframe 和验证码本身对应的 iframe:</p><p><img src="/posts/13934/hcaptcha_content_iframe.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_captcha_entry_iframe</span>(<span class="hljs-params">self</span>) -&gt; WebElement:<br>        self.browser.switch_to.default_content()<br>        captcha_entry_iframe = self.browser.find_element_by_css_selector(<br>            <span class="hljs-string">&#x27;.h-captcha &gt; iframe&#x27;</span>)<br>        <span class="hljs-keyword">return</span> captcha_entry_iframe<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">switch_to_captcha_entry_iframe</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:<br>        captcha_entry_iframe: WebElement = self.get_captcha_entry_iframe()<br>        self.browser.switch_to.frame(captcha_entry_iframe)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_captcha_content_iframe</span>(<span class="hljs-params">self</span>) -&gt; WebElement:<br>        self.browser.switch_to.default_content()<br>        captcha_content_iframe = self.browser.find_element_by_xpath(<br>            <span class="hljs-string">&#x27;//iframe[contains(@title, &quot;Main content&quot;)]&#x27;</span>)<br>        <span class="hljs-keyword">return</span> captcha_content_iframe<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">switch_to_captcha_content_iframe</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:<br>        captcha_content_iframe: WebElement = self.get_captcha_content_iframe()<br>        self.browser.switch_to.frame(captcha_content_iframe)<br><br></code></pre></td></tr></table></figure><h2 id="触发验证码"><a href="#触发验证码" class="headerlink" title="触发验证码"></a>触发验证码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">trigger_captcha</span>(<span class="hljs-params">self</span>) -&gt; <span class="hljs-literal">None</span>:<br>        self.switch_to_captcha_entry_iframe()<br>        captcha_entry = self.wait.until(EC.presence_of_element_located(<br>            (By.CSS_SELECTOR, <span class="hljs-string">&#x27;#anchor #checkbox&#x27;</span>)))<br>        captcha_entry.click()<br>        time.sleep(<span class="hljs-number">2</span>)<br>        self.switch_to_captcha_content_iframe()<br>        captcha_element: WebElement = self.get_captcha_element()<br>        <span class="hljs-keyword">if</span> captcha_element.is_displayed:<br>            logger.debug(<span class="hljs-string">&#x27;trigged captcha successfully&#x27;</span>)<br></code></pre></td></tr></table></figure><p>首先调用 switch_to_captcha_entry_iframe 进行了 iframe 的切换，然后找到那个入口框对应的节点，然后点击一下。</p><p>点击完了之后我们再调用 switch_to_captcha_content_iframe 切换到验证码本身对应的 iframe 里面，查找验证码本身对应的节点是否加载出来了，如果加载出来了，那么就证明触发成功了。</p><p>怎么查找问题呢呢？用 Selenium 常规的节点搜索就好了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_captcha_target_text</span>(<span class="hljs-params">self</span>) -&gt; WebElement:<br>        captcha_target_name_element: WebElement = self.wait.until(EC.presence_of_element_located(<br>            (By.CSS_SELECTOR, <span class="hljs-string">&#x27;.prompt-text&#x27;</span>)))<br>        <span class="hljs-keyword">return</span> captcha_target_name_element.text<br></code></pre></td></tr></table></figure><p>通过调用这个方法，我们就能得到上图中完整的问题文本了。</p><h2 id="验证码识别"><a href="#验证码识别" class="headerlink" title="验证码识别"></a>验证码识别</h2><p>每张图片进行下载并转成 Base64 编码了，我们观察下它的 HTML 结构</p><p><img src="/posts/13934/image_html.png"></p><p>每个验证码其实都对应了一个 .task-image 的节点，然后里面有个 .image-wrapper 的节点，在里面有一个 .image 的节点，那图片怎么呈现的呢？这里它是设置了一个 style CSS 样式，通过 CSS 的 backgroud 来设置了验证码图片的地址。</p><p>所以，我们要想提取验证码图片也比较容易了，我们只需要找出 .image 节点的 style 属性的内容，然后提取其中的 url 就好了。</p><p>得到 URL 之后，转下 Base64 编码，利用 captcha_resolver 就可以对内容进行识别了。</p><p>所以代码可以写为如下内容：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python">    <span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_captcha</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-comment"># get target text</span><br>        self.captcha_target_text = self.get_captcha_target_text()<br>        logger.debug(<br>            <span class="hljs-string">f&#x27;captcha_target_text <span class="hljs-subst">&#123;self.captcha_target_text&#125;</span>&#x27;</span><br>        )<br>        <span class="hljs-comment"># extract all images</span><br>        single_captcha_elements = self.wait.until(EC.visibility_of_all_elements_located(<br>            (By.CSS_SELECTOR, <span class="hljs-string">&#x27;.task-image .image-wrapper .image&#x27;</span>)))<br>        resized_single_captcha_base64_strings = []<br>        <span class="hljs-keyword">for</span> i, single_captcha_element <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(single_captcha_elements):<br>            single_captcha_element_style = single_captcha_element.get_attribute(<br>                <span class="hljs-string">&#x27;style&#x27;</span>)<br>            pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">&#x27;url\(&quot;(https.*?)&quot;\)&#x27;</span>)<br>            match_result = re.search(pattern, single_captcha_element_style)<br>            single_captcha_element_url = match_result.group(<br>                <span class="hljs-number">1</span>) <span class="hljs-keyword">if</span> match_result <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>            logger.debug(<br>                <span class="hljs-string">f&#x27;single_captcha_element_url <span class="hljs-subst">&#123;single_captcha_element_url&#125;</span>&#x27;</span>)<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(CAPTCHA_SINGLE_IMAGE_FILE_PATH % (i,), <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(requests.get(single_captcha_element_url).content)<br>            resized_single_captcha_base64_string = resize_base64_image(<br>                CAPTCHA_SINGLE_IMAGE_FILE_PATH % (i,), (<span class="hljs-number">100</span>, <span class="hljs-number">100</span>))<br>            resized_single_captcha_base64_strings.append(<br>                resized_single_captcha_base64_string)<br><br>        logger.debug(<br>            <span class="hljs-string">f&#x27;length of single_captcha_element_urls <span class="hljs-subst">&#123;<span class="hljs-built_in">len</span>(resized_single_captcha_base64_strings)&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>用正则表达式提取出来了每张验证码图片的 url，提取出 url 之后，我们然后将其存入了 <code>resized_single_captcha_base64_strings</code> 列表里面。</p><p>这里的 Base64 编码我们单独定义了一个方法，传入了图片路径和调整大小，然后可以返回编码后的结果，定义如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">from</span> app.settings <span class="hljs-keyword">import</span> CAPTCHA_RESIZED_IMAGE_FILE_PATH<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">resize_base64_image</span>(<span class="hljs-params">filename, size</span>):<br>    width, height = size<br>    img = Image.<span class="hljs-built_in">open</span>(filename)<br>    new_img = img.resize((width, height))<br>    new_img.save(CAPTCHA_RESIZED_IMAGE_FILE_PATH)<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(CAPTCHA_RESIZED_IMAGE_FILE_PATH, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read()<br>        encoded_string = base64.b64encode(data)<br>        <span class="hljs-keyword">return</span> encoded_string.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="图像识别"><a href="#图像识别" class="headerlink" title="图像识别"></a>图像识别</h2><p>略</p><h2 id="模拟点击"><a href="#模拟点击" class="headerlink" title="模拟点击"></a>模拟点击</h2><p>得到 true false 列表了，我们只需要将结果是 true 的序号提取出来，然后对这些验证码小图点击就好了，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># click captchas</span><br>recognized_indices = [i <span class="hljs-keyword">for</span> i, x <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(recognized_results) <span class="hljs-keyword">if</span> x]<br>logger.debug(<span class="hljs-string">f&#x27;recognized_indices <span class="hljs-subst">&#123;recognized_indices&#125;</span>&#x27;</span>)<br>click_targets = self.wait.until(EC.visibility_of_all_elements_located(<br>    (By.CSS_SELECTOR, <span class="hljs-string">&#x27;.task-image&#x27;</span>)))<br><span class="hljs-keyword">for</span> recognized_index <span class="hljs-keyword">in</span> recognized_indices:<br>    click_target: WebElement = click_targets[recognized_index]<br>    click_target.click()<br>    time.sleep(random())<br></code></pre></td></tr></table></figure><p>这里我们用 for 循环将 true false 列表转成了一个列表，列表的每个元素代表 true 在列表中的位置，其实就是我们的点击目标了。</p><p>然后接着我们获取了所有的验证码小图对应的节点，然后依次调用 click 方法进行点击即可。</p><p>这样我们就可以实现验证码小图的逐个识别了。</p><h2 id="点击验证"><a href="#点击验证" class="headerlink" title="点击验证"></a>点击验证</h2><p>好，那么有了上面的逻辑，我们就能完成整个 HCaptcha 的识别和点选了。</p><p>最后，我们模拟点击验证按钮就好了：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># after all captcha clicked</span><br>verify_button: WebElement = self.get_verify_button()<br><span class="hljs-keyword">if</span> verify_button.is_displayed:<br>    verify_button.click()<br>    time.sleep(<span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p>而 verfiy_button 的提取也是用 Selenium 即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_verify_button</span>(<span class="hljs-params">self</span>) -&gt; WebElement:<br>    verify_button = self.wait.until(EC.presence_of_element_located((By.CSS_SELECTOR, <span class="hljs-string">&#x27;.button-submit&#x27;</span>)))<br>    <span class="hljs-keyword">return</span> verify_button<br></code></pre></td></tr></table></figure><h2 id="校验结果"><a href="#校验结果" class="headerlink" title="校验结果"></a>校验结果</h2><p>验证成功的标志就是出现一个绿色小对勾</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_is_successful</span>(<span class="hljs-params">self</span>):<br>    self.switch_to_captcha_entry_iframe()<br>    anchor: WebElement = self.wait.until(EC.visibility_of_element_located((<br>        By.CSS_SELECTOR, <span class="hljs-string">&#x27;#anchor #checkbox&#x27;</span><br>    )))<br>    checked = anchor.get_attribute(<span class="hljs-string">&#x27;aria-checked&#x27;</span>)<br>    logger.debug(<span class="hljs-string">f&#x27;checked <span class="hljs-subst">&#123;checked&#125;</span>&#x27;</span>)<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(checked) == <span class="hljs-string">&#x27;true&#x27;</span><br></code></pre></td></tr></table></figure><p>这里我们先切换了 iframe，然后检查了对应的 class 是否是符合期望的。</p><p>最后如果 get_is_successful 返回结果是 True，那就代表识别成功了，那就整个完成了。</p><p>如果返回结果是 False，我们可以进一步递归调用上述逻辑进行二次识别，直到识别成功即可。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># check if succeed</span><br>is_succeed = self.get_is_successful()<br><span class="hljs-keyword">if</span> is_succeed:<br>    logger.debug(<span class="hljs-string">&#x27;verifed successfully&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    self.verify_captcha()<br></code></pre></td></tr></table></figure><h1 id="ReCaptcha"><a href="#ReCaptcha" class="headerlink" title="ReCaptcha"></a>ReCaptcha</h1><p>待续</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://www.selenium.dev/&quot;&gt;selenium&lt;/a&gt; 是一个调用浏览器进行自动化控制的包，支持Java Python CSharp Ruby JavaScript Kotlin。用它可以模拟点击、输入，进行人类的操作。本篇文章以python模拟点击验证码为例来说明selenium的使用。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文非原创，而是作者的学习笔记&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="selenium" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/selenium/"/>
    
    
    <category term="Python" scheme="https://pawswrite.xyz/tags/Python/"/>
    
    <category term="爬虫" scheme="https://pawswrite.xyz/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="selenium" scheme="https://pawswrite.xyz/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>selenium识别验证码是否通过</title>
    <link href="https://pawswrite.xyz/posts/21451.html"/>
    <id>https://pawswrite.xyz/posts/21451.html</id>
    <published>2022-08-12T10:54:30.000Z</published>
    <updated>2022-10-04T15:51:38.664Z</updated>
    
    <content type="html"><![CDATA[<p>其实就是识别验证码勾选框有没有打勾。</p><span id="more"></span><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>切换到验证码的iframe页anchor，获取元素recaptcha-anchor的属性aria-checked就可以了。<code>false</code> 和 <code>true</code> </p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python3">import time<br>import requests<br>from selenium import webdriver<br><br>options = webdriver.ChromeOptions()<br>driver = webdriver.Chrome(&#x27;selenium/chromedriver.exe&#x27;, options=options)<br><br>driver.get(&quot;https://www.google.com/recaptcha/api2/demo&quot;)<br><br># 切换到勾选框<br>iframe = driver.find_element_by_css_selector(&#x27;iframe[src*=&quot;anchor&quot;]&#x27;)<br>driver.switch_to.frame(iframe)<br><br># 获取勾选框的打勾状态<br>for i in range(30):<br>    anchor = driver.find_element_by_id(&#x27;recaptcha-anchor&#x27;)<br>    is_checked = anchor.get_attribute(&quot;aria-checked&quot;)<br>    print(&#x27;当前识别状态：&#x27;, is_checked)<br>    time.sleep(3)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;其实就是识别验证码勾选框有没有打勾。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="selenium" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/selenium/"/>
    
    
    <category term="Python" scheme="https://pawswrite.xyz/tags/Python/"/>
    
    <category term="爬虫" scheme="https://pawswrite.xyz/tags/%E7%88%AC%E8%99%AB/"/>
    
    <category term="selenium" scheme="https://pawswrite.xyz/tags/selenium/"/>
    
  </entry>
  
  <entry>
    <title>nginx反代Scaleway s3对象储存媒体文件配置</title>
    <link href="https://pawswrite.xyz/posts/52859.html"/>
    <id>https://pawswrite.xyz/posts/52859.html</id>
    <published>2022-08-04T08:34:41.000Z</published>
    <updated>2022-10-04T15:51:38.659Z</updated>
    
    <content type="html"><![CDATA[<p>nginx反代Scaleway s3对象储存媒体文件的配置文件模板。</p><span id="more"></span><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul><li><a href="https://docs.joinmastodon.org/admin/optional/object-storage-proxy/">Proxying object storage through nginx</a></li><li><a href="https://pullopen.github.io/%E7%AB%99%E7%82%B9%E7%BB%B4%E6%8A%A4/2020/07/22/Move-mastodon-media-to-Scaleway.html">如何将Mastodon媒体上传至Scaleway云储存</a></li></ul><h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><p>例如 <code>s3.nl-ams.scw.cloud</code> 是你的 YOUR_S3_HOSTNAME：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">proxy_cache_path</span> <span class="hljs-string">/tmp/nginx_mstdn_media</span> <span class="hljs-string">levels=1:2</span> <span class="hljs-string">keys_zone=mastodon_media:100m</span> <span class="hljs-string">max_size=1g</span> <span class="hljs-string">inactive=24h;</span><br><br><span class="hljs-string">server</span> &#123;<br>  <span class="hljs-string">listen</span> <span class="hljs-number">443</span> <span class="hljs-string">ssl</span> <span class="hljs-string">http2;</span><br>  <span class="hljs-string">listen</span> [<span class="hljs-string">::</span>]<span class="hljs-string">:443</span> <span class="hljs-string">ssl</span> <span class="hljs-string">http2;</span><br>  <span class="hljs-string">server_name</span> <span class="hljs-string">YOUR_BUCKET_NAME;</span><br>  <span class="hljs-string">root</span> <span class="hljs-string">/var/www/html;</span><br><br>  <span class="hljs-string">ssl_certificate</span> <span class="hljs-string">/etc/letsencrypt/live/YOUR_BUCKET_NAME/fullchain.pem;</span><br>  <span class="hljs-string">ssl_certificate_key</span> <span class="hljs-string">/etc/letsencrypt/live/YOUR_BUCKET_NAME/privkey.pem;</span><br><br>  <span class="hljs-string">keepalive_timeout</span> <span class="hljs-number">30</span><span class="hljs-string">;</span><br><br>  <span class="hljs-string">location</span> <span class="hljs-string">=</span> <span class="hljs-string">/</span> &#123;<br>    <span class="hljs-string">index</span> <span class="hljs-string">index.html;</span><br>  &#125;<br><br>  <span class="hljs-string">location</span> <span class="hljs-string">/</span> &#123;<br>    <span class="hljs-string">try_files</span> <span class="hljs-string">$uri</span> <span class="hljs-string">@s3;</span><br>  &#125;<br><br>  <span class="hljs-string">set</span> <span class="hljs-string">$s3_backend</span> <span class="hljs-string">&#x27;https://YOUR_BUCKET_NAME.s3.nl-ams.scw.cloud&#x27;</span><span class="hljs-string">;</span><br><br>  <span class="hljs-string">location</span> <span class="hljs-string">@s3</span> &#123;<br>    <span class="hljs-string">limit_except</span> <span class="hljs-string">GET</span> &#123;<br>      <span class="hljs-string">deny</span> <span class="hljs-string">all;</span><br>    &#125;<br><br>    <span class="hljs-string">resolver</span> <span class="hljs-number">8.8</span><span class="hljs-number">.8</span><span class="hljs-number">.8</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Host</span> <span class="hljs-string">YOUR_BUCKET_NAME.s3.nl-ams.scw.cloud;</span><br>    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Connection</span> <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_set_header</span> <span class="hljs-string">Authorization</span> <span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">Set-Cookie;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">&#x27;Access-Control-Allow-Methods&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">&#x27;Access-Control-Allow-Headers&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amz-id-2;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amz-request-id;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amz-meta-server-side-encryption;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amz-server-side-encryption;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amz-bucket-region;</span><br>    <span class="hljs-string">proxy_hide_header</span> <span class="hljs-string">x-amzn-requestid;</span><br>    <span class="hljs-string">proxy_ignore_headers</span> <span class="hljs-string">Set-Cookie;</span><br>    <span class="hljs-string">proxy_pass</span> <span class="hljs-string">$s3_backend$uri;</span><br>    <span class="hljs-string">proxy_intercept_errors</span> <span class="hljs-string">off;</span><br><br>    <span class="hljs-string">proxy_cache</span> <span class="hljs-string">mastodon_media;</span><br>    <span class="hljs-string">proxy_cache_valid</span> <span class="hljs-number">200</span> <span class="hljs-string">48h;</span><br>    <span class="hljs-string">proxy_cache_use_stale</span> <span class="hljs-string">error</span> <span class="hljs-string">timeout</span> <span class="hljs-string">updating</span> <span class="hljs-string">http_500</span> <span class="hljs-string">http_502</span> <span class="hljs-string">http_503</span> <span class="hljs-string">http_504;</span><br>    <span class="hljs-string">proxy_cache_lock</span> <span class="hljs-string">on;</span><br><br>    <span class="hljs-string">expires</span> <span class="hljs-string">1y;</span><br>    <span class="hljs-string">add_header</span> <span class="hljs-string">Cache-Control</span> <span class="hljs-string">public;</span><br>    <span class="hljs-string">add_header</span> <span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class="hljs-string">&#x27;*&#x27;</span><span class="hljs-string">;</span><br>    <span class="hljs-string">add_header</span> <span class="hljs-string">X-Cache-Status</span> <span class="hljs-string">$upstream_cache_status;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;nginx反代Scaleway s3对象储存媒体文件的配置文件模板。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Nginx/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/tags/Nginx/"/>
    
    <category term="运维" scheme="https://pawswrite.xyz/tags/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>解决Skipping acquire of configured file &#39;main/binary-i386/Packages&#39; as repository &#39;xxx&#39; doesn&#39;t support architecture &#39;i386&#39;</title>
    <link href="https://pawswrite.xyz/posts/47269.html"/>
    <id>https://pawswrite.xyz/posts/47269.html</id>
    <published>2022-08-04T07:23:12.000Z</published>
    <updated>2022-10-04T15:51:38.676Z</updated>
    
    <content type="html"><![CDATA[<p>在<a href="https://www.linuxcapable.com/how-to-install-upgrade-latest-nginx-mainline-stable-on-ubuntu-20-04/#gsc.tab=0">安装1.22版nginx</a>的时候遇到了个问题。编辑 <code>/etc/apt/sources.list.d/nginx.list</code> 的时候加进去的库，在 <code>apt update</code> 的时候报错：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">N: Skipping acquire of configured file <span class="hljs-string">&#x27;nginx/binary-i386/Packages&#x27;</span> as repository <span class="hljs-string">&#x27;http://nginx.org/packages/ubuntu focal InRelease&#x27;</span> doesn<span class="hljs-string">&#x27;t support architecture &#x27;</span>i386<span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><span id="more"></span><h1 id="解决办法1"><a href="#解决办法1" class="headerlink" title="解决办法1"></a>解决办法1</h1><p>首先找到的解决办法是在 <code>nginx.list</code> 指定arch为amd，也就是：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;deb [arch=amd64] [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span><br><span class="hljs-string">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span> \<br>    | sudo <span class="hljs-built_in">tee</span> /etc/apt/sources.list.d/nginx.list<br></code></pre></td></tr></table></figure><p>但这样运行 <code>apt update</code> 依然会报错</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">E: Malformed entry 1 <span class="hljs-keyword">in</span> list file /etc/apt/sources.list.d/nginx.list (URI parse)<br>E: The list of sources could not be <span class="hljs-built_in">read</span>.<br></code></pre></td></tr></table></figure><h1 id="根本解决办法"><a href="#根本解决办法" class="headerlink" title="根本解决办法"></a>根本解决办法</h1><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul><li><a href="https://askubuntu.com/questions/741410/skipping-acquire-of-configured-file-main-binary-i386-packages-as-repository-x">Skipping acquire of configured file ‘main&#x2F;binary-i386&#x2F;Packages’ as repository ‘xxx’ doesn’t support architecture ‘i386’</a></li><li><a href="https://blog.csdn.net/Leo_whj/article/details/111639223">Ubuntu dpkg查看与修改architecture</a></li></ul><h2 id="解决步骤"><a href="#解决步骤" class="headerlink" title="解决步骤"></a>解决步骤</h2><p>先找到出问题的库，比如说 <code>repository &#39;xxx&#39; doesn&#39;t support architecture &#39;i386&#39;</code> ，那么我们就运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /etc/apt/sources.list.d<br>grep -r xxx（出问题的库）  /etc/apt | grep -v amd64 <br><span class="hljs-comment"># 或者</span><br>grep xxx（出问题的库） * | grep -v amd64<br></code></pre></td></tr></table></figure><p>例如我这里可以用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /etc/apt/sources.list.d<br>grep nginx * | grep -v amd64<br><span class="hljs-comment"># 或者</span><br>grep nginx * | grep -v amd64<br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">/etc/apt/sources.list.d/nginx.list:deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] http://nginx.org/packages/ubuntu focal nginx<br></code></pre></td></tr></table></figure><p>那么我们就得到了.list文件名+路径 ： <code>/etc/apt/sources.list.d/nginx.list</code></p><p>这个就是出问题的。可以先试试在这个文件里面加上 <code>[arch=amd64]</code></p><p>例如我的例子，编辑 <code>/etc/apt/sources.list.d/nginx.list</code> 文件为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">deb [<span class="hljs-built_in">arch</span>=amd64] [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] http://nginx.org/packages/ubuntu focal nginx<br></code></pre></td></tr></table></figure><p>我这样失败了。因为这个语法会被判定为木马，那我们先取消这个解决办法，来找找根本原因</p><h2 id="根本原因"><a href="#根本原因" class="headerlink" title="根本原因"></a>根本原因</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 查看本机的架构内核</span><br>dpkg --print-architecture<br><span class="hljs-comment"># 查看多架构支持内核</span><br>dpkg --print-foreign-architectures<br></code></pre></td></tr></table></figure><p>第二条命令输出i386是让64位ubuntu运行32位程序，也就是多架构支持。也就是这个地方，导致了我们会出现这样的报错。</p><p>如果你不想要多架构支持，可以移除。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">dpkg --remove-architecture i386<br></code></pre></td></tr></table></figure><p>之后再运行 <code>apt update</code> 即可。</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;在&lt;a href=&quot;https://www.linuxcapable.com/how-to-install-upgrade-latest-nginx-mainline-stable-on-ubuntu-20-04/#gsc.tab=0&quot;&gt;安装1.22版nginx&lt;/a&gt;的时候遇到了个问题。编辑 &lt;code&gt;/etc/apt/sources.list.d/nginx.list&lt;/code&gt; 的时候加进去的库，在 &lt;code&gt;apt update&lt;/code&gt; 的时候报错：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;code class=&quot;hljs bash&quot;&gt;N: Skipping acquire of configured file &lt;span class=&quot;hljs-string&quot;&gt;&amp;#x27;nginx/binary-i386/Packages&amp;#x27;&lt;/span&gt; as repository &lt;span class=&quot;hljs-string&quot;&gt;&amp;#x27;http://nginx.org/packages/ubuntu focal InRelease&amp;#x27;&lt;/span&gt; doesn&lt;span class=&quot;hljs-string&quot;&gt;&amp;#x27;t support architecture &amp;#x27;&lt;/span&gt;i386&lt;span class=&quot;hljs-string&quot;&gt;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Nginx/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Nginx" scheme="https://pawswrite.xyz/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>boring Bay clicker(linux 运行pyppeteer报错pyppeteer.errors.BrowserError Browser closed unexpectedly的解决办法)</title>
    <link href="https://pawswrite.xyz/posts/20093.html"/>
    <id>https://pawswrite.xyz/posts/20093.html</id>
    <published>2022-08-02T09:37:14.000Z</published>
    <updated>2022-10-04T15:51:38.648Z</updated>
    
    <content type="html"><![CDATA[<p>一个很无聊的项目~~ 使用 <code>pyppeteer</code> 模拟点击本博客的无聊湾链接，来刷点击量。</p><span id="more"></span><h1 id="代码仓库"><a href="#代码仓库" class="headerlink" title="代码仓库"></a>代码仓库</h1><p>仓库：<br><a href="https://github.com/tech-fever/boringBayClicker">https://github.com/tech-fever/boringBayClicker</a></p><h1 id="部署到VPS"><a href="#部署到VPS" class="headerlink" title="部署到VPS"></a>部署到VPS</h1><p>发现 <code>debian/ubuntu</code> 要运行的话缺少很多依赖：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install gconf-service libasound2 libatk1.0-0 libatk-bridge2.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcomposite1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 ca-certificates fonts-liberation libappindicator1 libnss3 lsb-release xdg-utils wget libcairo-gobject2 libxinerama1 libgtk2.0-0 libpangoft2-1.0-0 libthai0 libpixman-1-0 libxcb-render0 libharfbuzz0b libdatrie1 libgraphite2-3 libgbm1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/tech-fever/boringBayClicker &amp;&amp; <span class="hljs-built_in">cd</span> boringBayClicker<br>pip install -r requirements.txt<br>python main<br></code></pre></td></tr></table></figure><h1 id="一些查看"><a href="#一些查看" class="headerlink" title="一些查看"></a>一些查看</h1><p>查看对应系统下的 <code>chromium</code> 安装路径和相关参数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pyppeteer.launcher <span class="hljs-keyword">import</span> Launcher<br><span class="hljs-keyword">import</span> pyppeteer.chromium_downloader<br> <span class="hljs-string">&#x27; &#x27;</span>.join(Launcher().cmd)<br><span class="hljs-built_in">print</span>(pyppeteer.chromium_downloader.chromiumExecutable.get(<span class="hljs-string">&quot;linux&quot;</span>))<br><span class="hljs-built_in">print</span>(pyppeteer.chromium_downloader.chromiumExecutable.get(<span class="hljs-string">&quot;mac&quot;</span>))<br><span class="hljs-built_in">print</span>(pyppeteer.chromium_downloader.chromiumExecutable.get(<span class="hljs-string">&quot;win32&quot;</span>))<br><span class="hljs-built_in">print</span>(pyppeteer.chromium_downloader.chromiumExecutable.get(<span class="hljs-string">&quot;win64&quot;</span>))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;p&gt;一个很无聊的项目~~ 使用 &lt;code&gt;pyppeteer&lt;/code&gt; 模拟点击本博客的无聊湾链接，来刷点击量。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="pyppeteer" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/pyppeteer/"/>
    
    
    <category term="pyppeteer" scheme="https://pawswrite.xyz/tags/pyppeteer/"/>
    
    <category term="Python" scheme="https://pawswrite.xyz/tags/Python/"/>
    
    <category term="爬虫" scheme="https://pawswrite.xyz/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>How to Extract Azure API</title>
    <link href="https://pawswrite.xyz/posts/37796.html"/>
    <id>https://pawswrite.xyz/posts/37796.html</id>
    <published>2022-07-25T04:41:44.000Z</published>
    <updated>2022-10-04T15:51:38.615Z</updated>
    
    <content type="html"><![CDATA[<p>本文是如何提取Azure API从而使用API面板的教学。</p><span id="more"></span><h1 id="登录Azure"><a href="#登录Azure" class="headerlink" title="登录Azure"></a>登录Azure</h1><p>点此登录 -&gt; <a href="https://portal.azure.com/">MicroSoft Azure</a></p><h1 id="登录-Azure-Cloud-Shell"><a href="#登录-Azure-Cloud-Shell" class="headerlink" title="登录 Azure Cloud Shell"></a>登录 Azure Cloud Shell</h1><p>进入主页后，如图，点击：<br><img src="/posts/37796/cli.jpg"></p><p>在网页下方找到Azure Cloud Shell再点击 <code>bash</code> :<br><img src="/posts/37796/bash.jpg"></p><p>如果是初次使用，需要先选择订阅，然后点击 <code>Create storage</code>:<br><img src="/posts/37796/createStorage.jpg"></p><p>需要耗费一些时间，请耐心等待几分钟。</p><p>之后你会看到这样的界面：<br><img src="/posts/37796/shell.jpg"></p><h1 id="生成API"><a href="#生成API" class="headerlink" title="生成API"></a>生成API</h1><p>输入下面命令并按回车即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">az ad sp create-for-rbac --role contributor --scopes /subscriptions/$(az account list --query [].<span class="hljs-built_in">id</span> -o tsv) <br></code></pre></td></tr></table></figure><p><img src="/posts/37796/cmd.jpg"></p><p>对于生成的信息，我们只复制大括号和大括号中间的内容。也就是类似下面的json格式信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-string">&quot;appId&quot;</span>: <span class="hljs-string">&quot;e84cae80-c647-424d-8934-0de6da2ede0d&quot;</span>,<br>  <span class="hljs-string">&quot;displayName&quot;</span>: <span class="hljs-string">&quot;azcli&quot;</span>,<br>  <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;DzXHi!EwGn2pp0Wbtbx5px3RYFsMYT9yZD&quot;</span>,<br>  <span class="hljs-string">&quot;tenant&quot;</span>: <span class="hljs-string">&quot;7e0a6485-5a39-4e2f-a12b-13e6c4a5b053&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>保存即可。</p><h1 id="导入azpanel"><a href="#导入azpanel" class="headerlink" title="导入azpanel"></a>导入azpanel</h1><p>以azpanel为例，导入：<br><img src="/posts/37796/azadd.jpg"></p><p>其余皆可留空，输入你的Azure登陆邮箱和刚刚得到的json信息（就是大括号那一坨）即可。<br><img src="/azadd2.jpg"></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;本文是如何提取Azure API从而使用API面板的教学。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Azure" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Azure/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Azure" scheme="https://pawswrite.xyz/tags/Azure/"/>
    
  </entry>
  
  <entry>
    <title>azpanel: 免费开源的azure api面板</title>
    <link href="https://pawswrite.xyz/posts/6184.html"/>
    <id>https://pawswrite.xyz/posts/6184.html</id>
    <published>2022-07-24T09:21:58.000Z</published>
    <updated>2022-10-04T15:51:38.649Z</updated>
    
    <content type="html"><![CDATA[<div class="note note-danger">            <p>有被封号风险，慎用。</p>          </div><p>azpanel是一个免费开源的azure api面板。官方给的安装教程有用lnmp和bt面板的，这两种我都不太喜欢，所以写一下手动安装教程。</p><span id="more"></span><h1 id="项目信息"><a href="#项目信息" class="headerlink" title="项目信息"></a>项目信息</h1><ul><li>项目地址：<a href="https://github.com/azpanel/azpanel">https://github.com/azpanel/azpanel</a></li><li>演示站点：<a href="https://azpanel.net/">https://azpanel.net</a></li><li>telegram 频道：<a href="https://t.me/azpanel">https://t.me/azpanel</a></li><li>telegram 群聊：<a href="https://t.me/+w_DuAFGop4kzOGYx">https://t.me/+w_DuAFGop4kzOGYx</a></li></ul><h1 id="官方安装教程"><a href="#官方安装教程" class="headerlink" title="官方安装教程"></a>官方安装教程</h1><ul><li><p>lnmp.org<br><a href="https://github.com/azpanel/azpanel/wiki/lnmp.org">https://github.com/azpanel/azpanel/wiki/lnmp.org</a></p></li><li><p>bt.cn<br><a href="https://github.com/azpanel/azpanel/wiki/bt.cn">https://github.com/azpanel/azpanel/wiki/bt.cn</a></p></li></ul><h1 id="手动安装"><a href="#手动安装" class="headerlink" title="手动安装"></a>手动安装</h1><h2 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h2><p>理论上配置不要太低的Linux服务器都可以。我是在Ubuntu 20.04 LTS上安装的，本文命令也是基于此。</p><h2 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h2><p>我们需要安装的东西有：<br>☑️ Nginx 1.17<br>☑️ MySQL 5.6 (或者mariadb)<br>☑️ PHP 7.2.5+</p><h2 id="安装PHP和nginx"><a href="#安装PHP和nginx" class="headerlink" title="安装PHP和nginx"></a>安装PHP和nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt update &amp;&amp; apt upgrade -y<br>apt install php-fpm php-mysql php-curl php-xml nginx -y<br></code></pre></td></tr></table></figure><p>验证是否安装成功：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">php -v<br>nginx -v<br></code></pre></td></tr></table></figure><h2 id="安装MySQL"><a href="#安装MySQL" class="headerlink" title="安装MySQL"></a>安装MySQL</h2><p>这里我是采用docker安装，其实直接安装也很方便啦。</p><h3 id="安装docker和docker-compose"><a href="#安装docker和docker-compose" class="headerlink" title="安装docker和docker-compose"></a>安装docker和docker-compose</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -fsSL https://get.docker.com | bash<br>apt install docker-compose<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker -v<br>docker-compose -v<br></code></pre></td></tr></table></figure><h3 id="docker-compose启动mysql"><a href="#docker-compose启动mysql" class="headerlink" title="docker-compose启动mysql"></a>docker-compose启动mysql</h3><p>先新建文件夹：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p /opt/azpanel &amp;&amp; <span class="hljs-built_in">cd</span> /opt/azpanel<br>vim /opt/azpanel/docker-compose.yml<br><br></code></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3&quot;</span><br><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">db:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:oracle</span> <span class="hljs-comment"># 这是针对arm的镜像，amd请更改</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span><span class="hljs-string">:3306:3306</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">./db/mysql:/var/lib/mysql</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">写你的root密码</span><br>      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">azpanel</span><br>      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">azpanel</span><br>      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">写你的数据库密码</span><br>    <span class="hljs-attr">restart:</span> <span class="hljs-string">always</span><br></code></pre></td></tr></table></figure><p>再运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker-compose up -d<br></code></pre></td></tr></table></figure><h2 id="下载azpanel"><a href="#下载azpanel" class="headerlink" title="下载azpanel"></a>下载azpanel</h2><p>下载</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p /www/wwwroot/azpanel &amp;&amp; <span class="hljs-built_in">mkdir</span> /www/wwwlogs/ &amp;&amp; <span class="hljs-built_in">cd</span> /www/wwwroot/azpanel<br>git <span class="hljs-built_in">clone</span> https://github.com/azpanel/azpanel.git ./<br></code></pre></td></tr></table></figure><p>修改权限</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /www/wwwroot/azpanel<br><span class="hljs-built_in">chmod</span> 755 -R *<br><span class="hljs-built_in">chown</span> -R www-data *<br><span class="hljs-comment"># www-data 是php-fpm和nginx的用户</span><br><span class="hljs-comment"># 可以用下面命令查看：</span><br><span class="hljs-built_in">cat</span> /etc/php/7.4/fpm/pool.d/www.conf | grep <span class="hljs-string">&quot;user = &quot;</span><br><span class="hljs-built_in">cat</span> /etc/nginx/nginx.conf | grep <span class="hljs-string">&quot;user&quot;</span><br></code></pre></td></tr></table></figure><h2 id="安装Composer"><a href="#安装Composer" class="headerlink" title="安装Composer"></a>安装Composer</h2><p>Composer 是PHP的一个依赖管理工具。 它能管理你的PHP项目所需要的所有依赖关系。 也就是说，Composer 会将你的PHP项目需要的所有代码库、依赖项从网上全部拉取下来，放到一起进行管理。</p><blockquote><p>参考：How to Install Composer: A Step-By-Step Guide and Best Practices</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /www/wwwroot/azpanel<br>php -r <span class="hljs-string">&quot;copy(&#x27;https://getcomposer.org/installer&#x27;, &#x27;composer-setup.php&#x27;);&quot;</span><br>php composer-setup.php <span class="hljs-comment"># 也可以全局安装：php composer-setup.php --install-dir=/usr/local/bin --filename=composer</span><br>php -r <span class="hljs-string">&quot;unlink(&#x27;composer-setup.php&#x27;);&quot;</span> <span class="hljs-comment"># 移除installer</span><br>php composer.phar <span class="hljs-comment"># 测试</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php composer.phar install<br></code></pre></td></tr></table></figure><p>安装成功的输出请看附录：<a href="#jump1">点击跳转</a><br><span id="jump2">继续安装</span></p><h2 id="配置数据库"><a href="#配置数据库" class="headerlink" title="配置数据库"></a>配置数据库</h2><p>导入数据库：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /opt/azpanel/<br><span class="hljs-built_in">cp</span> /www/wwwroot/azpanel/database/*.sql /opt/azpanel/db/mysql/azpanel/<br>docker-compose down &amp;&amp; docker-compose up -d<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 进入容器</span><br>docker <span class="hljs-built_in">exec</span> -it azpanel_db_1 sh<br></code></pre></td></tr></table></figure><p>这里输入你的<strong>root</strong>密码，登入数据库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh-4.4<span class="hljs-comment"># mysql -uroot -p</span><br>Enter password: (输入你的root密码)<br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection <span class="hljs-built_in">id</span> is 8<br>Server version: 8.0.29 MySQL Community Server - GPL<br><br>Copyright (c) 2000, 2022, Oracle and/or its affiliates.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>mysql&gt;<br></code></pre></td></tr></table></figure><p>数据库操作</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; use azpanel;<br>Database changed<br>mysql&gt; <span class="hljs-built_in">source</span> /var/lib/mysql/azpanel/azure.sql;<br>Query OK, 0 rows affected (0.01 sec)<br><br>mysql&gt; <span class="hljs-built_in">source</span> /var/lib/mysql/azpanel/config.sql;<br>Query OK, 12 rows affected (0.01 sec)<br>Records: 12  Duplicates: 0  Warnings: 0<br><br>mysql&gt; show tables;<br>+----------------------+<br>| Tables_in_azpanel    |<br>+----------------------+<br>| ann                  |<br>| azure                |<br>| azure_server         |<br>| azure_server_traffic |<br>| config               |<br>| login_log            |<br>| task                 |<br>| user                 |<br>| verify               |<br>+----------------------+<br>9 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.01 sec)<br><br>mysql&gt; \q<br>Bye<br>sh-4.4<span class="hljs-comment"># exit</span><br><span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>复制配置文件模板并编辑配置文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /www/wwwroot/azpanel/<br><span class="hljs-built_in">cp</span> .example.env .<span class="hljs-built_in">env</span><br>vim .<span class="hljs-built_in">env</span><br></code></pre></td></tr></table></figure><p>如下修改</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">APP_DEBUG</span> = <span class="hljs-literal">false</span><br><br><span class="hljs-section">[APP]</span><br><span class="hljs-attr">DEFAULT_TIMEZONE</span> = Asia/Shanghai<br><span class="hljs-attr">APP_NAME</span> = Azure<br><br><span class="hljs-section">[DATABASE]</span><br><span class="hljs-attr">TYPE</span> = mysql<br><span class="hljs-attr">HOSTNAME</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-attr">DATABASE</span> = azpanel<br><span class="hljs-attr">USERNAME</span> = azpanel<br><span class="hljs-attr">PASSWORD</span> = 你的azpanel密码<br><span class="hljs-attr">HOSTPORT</span> = <span class="hljs-number">3306</span><br><span class="hljs-attr">CHARSET</span> = utf8<br><span class="hljs-attr">DEBUG</span> = <span class="hljs-literal">true</span><br><br><span class="hljs-section">[THEME]</span><br><span class="hljs-attr">CARD_WIDTH</span> = <span class="hljs-number">10</span><br><span class="hljs-attr">CARD_RIGHT_OFFSET</span> = <span class="hljs-number">1</span><br><br><span class="hljs-section">[LANG]</span><br><span class="hljs-attr">default_lang</span> = zh-cn<br></code></pre></td></tr></table></figure><h2 id="创建管理员"><a href="#创建管理员" class="headerlink" title="创建管理员"></a>创建管理员</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">php think createAdmin --email admin@azpanel.net --passwd 你的登陆密码<br><span class="hljs-comment"># 输出：</span><br><span class="hljs-comment"># An administrator account has been created.</span><br></code></pre></td></tr></table></figure><p>如果数据库配置错误，会这样</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[think\db\exception\PDOException]                                                      <br>SQLSTATE[HY000] [1045] Access denied <span class="hljs-keyword">for</span> user <span class="hljs-string">&#x27;root&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> (using password: NO)<br></code></pre></td></tr></table></figure><h2 id="导入更多数据库"><a href="#导入更多数据库" class="headerlink" title="导入更多数据库"></a>导入更多数据库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">php think migrate:run<br></code></pre></td></tr></table></figure><h2 id="添加定时任务"><a href="#添加定时任务" class="headerlink" title="添加定时任务"></a>添加定时任务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">crontab -e<br></code></pre></td></tr></table></figure><p>然后输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">0 0 * * * php /www/wwwroot/azpanel/think tools --action statisticsTraffic<br>0 * * * * php /www/wwwroot/azpanel/think autoRefreshAccount<br>0 * * * * php /www/wwwroot/azpanel/think closeTimeoutTask<br>0 * * * * php /www/wwwroot/azpanel/think trafficControlStop<br>*/5 * * * * php /www/wwwroot/azpanel/think trafficControlStart<br></code></pre></td></tr></table></figure><h2 id="编辑-nginx-配置"><a href="#编辑-nginx-配置" class="headerlink" title="编辑 nginx 配置"></a>编辑 nginx 配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">touch</span> /etc/nginx/sites-available/azpanel.conf<br><br>vim /etc/nginx/sites-available/azpanel.conf<br></code></pre></td></tr></table></figure><p>输入下面模板（把azpanel.net）改成你的域名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs bash">server<br>    &#123;<br>        listen 80;<br>        server_name azpanel.net ;<br>        <span class="hljs-built_in">return</span> 301 https://$server_name<span class="hljs-variable">$request_uri</span>;<br>    &#125;<br><br>server<br>    &#123;<br>        listen 443 ssl http2;<br>        <span class="hljs-comment">#listen [::]:443 ssl http2;</span><br>        server_name azpanel.net ;<br>        index index.html index.htm index.php default.html default.htm default.php;<br>        root  /www/wwwroot/azpanel/public;<br><br>        ssl_certificate /etc/letsencrypt/live/azpanel.net/fullchain.pem;<br>        ssl_certificate_key /etc/letsencrypt/live/azpanel.net/privkey.pem;<br>        ssl_session_timeout 5m;<br>        ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;<br>        ssl_prefer_server_ciphers on;<br>        ssl_ciphers <span class="hljs-string">&quot;TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5&quot;</span>;<br>        ssl_session_cache <span class="hljs-built_in">builtin</span>:1000 shared:SSL:10m;<br>        <span class="hljs-comment"># openssl dhparam -out /usr/local/nginx/conf/ssl/dhparam.pem 2048</span><br>        <span class="hljs-comment"># ssl_dhparam /usr/local/nginx/conf/ssl/dhparam.pem;</span><br><br>        include conf.d/azpanel/thinkphp.conf;<br>        <span class="hljs-comment">#error_page   404   /404.html;</span><br><br>        <span class="hljs-comment"># Deny access to PHP files in specific directory</span><br>        <span class="hljs-comment">#location ~ /(wp-content|uploads|wp-includes|images)/.*\.php$ &#123; deny all; &#125;</span><br><br>        <span class="hljs-comment">#include enable-php.conf;</span><br>        location ~ \.php$ &#123;<br>          fastcgi_pass unix:/var/run/php/php-fpm.sock;<br>          include      conf.d/azpanel/php_fastcgi.conf;<br>        &#125;<br><br>        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$<br>        &#123;<br>            expires      30d;<br>        &#125;<br><br>        location ~ .*\.(js|css)?$<br>        &#123;<br>            expires      12h;<br>        &#125;<br><br>        location ~ /.well-known &#123;<br>            allow all;<br>        &#125;<br><br>        location ~ /\.<br>        &#123;<br>            deny all;<br>        &#125;<br><br>        access_log  /www/wwwlogs/azpanel.net.log;<br>    &#125;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> /etc/nginx/conf.d/azpanel/ &amp;&amp; vim /etc/nginx/conf.d/azpanel/thinkphp.conf<br></code></pre></td></tr></table></figure><p>输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">location / &#123;<br>  <span class="hljs-keyword">if</span> (!-e <span class="hljs-variable">$request_filename</span>)&#123;<br>    rewrite ^(.*)$ /index.php?s=<span class="hljs-variable">$1</span> last; <span class="hljs-built_in">break</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">vim /etc/nginx/conf.d/azpanel/php_fastcgi.conf<br></code></pre></td></tr></table></figure><p>输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs conf"># 404<br>try_files                     $fastcgi_script_name =404;<br><br># default fastcgi_params<br>include                       fastcgi_params;<br><br># fastcgi settings<br>fastcgi_index                 index.php;<br>fastcgi_buffers               8 16k;<br>fastcgi_buffer_size           32k;<br><br># fastcgi params<br>fastcgi_param DOCUMENT_ROOT   $realpath_root;<br>fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;<br></code></pre></td></tr></table></figure><h2 id="申请证书"><a href="#申请证书" class="headerlink" title="申请证书"></a>申请证书</h2><p>先把你的域名进行dns解析到正确的ip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install certbot python3-certbot-nginx -y<br>certbot certonly --nginx -d 你的域名<br></code></pre></td></tr></table></figure><h2 id="重启nginx"><a href="#重启nginx" class="headerlink" title="重启nginx"></a>重启nginx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /etc/nginx/sites-available/azpanel.conf /etc/nginx/sites-enabled/azpanel.conf<br>systemctl restart nginx<br></code></pre></td></tr></table></figure><h2 id="完成！"><a href="#完成！" class="headerlink" title="完成！"></a>完成！</h2><p><img src="/posts/6184/azpanel.jpg"></p><p><img src="/posts/6184/azpanel2.jpg"></p><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h2 id="安装成功输出"><a href="#安装成功输出" class="headerlink" title="安装成功输出"></a><span id="jump1">安装成功输出</span></h2><p>看完可跳转到继续安装 -&gt; <a href="#jump2">点击跳转</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@ashburn:/www/wwwroot/azpanel<span class="hljs-comment"># php composer.phar install</span><br>Do not run Composer as root/super user! See https://getcomposer.org/root <span class="hljs-keyword">for</span> details<br>Continue as root/super user [<span class="hljs-built_in">yes</span>]? <span class="hljs-built_in">yes</span><br>No composer.lock file present. Updating dependencies to latest instead of installing from lock file. See https://getcomposer.org/install <span class="hljs-keyword">for</span> more information.<br>Loading composer repositories with package information<br>Updating dependencies<br>Lock file operations: 39 installs, 0 updates, 0 removals<br>  - Locking adbario/php-dot-notation (2.3.0)<br>  - Locking alibabacloud/client (1.5.31)<br>  - Locking clagiordano/weblibs-configmanager (v1.2.0)<br>  - Locking danielstjules/stringy (3.1.0)<br>  - Locking guzzlehttp/guzzle (6.5.8)<br>  - Locking guzzlehttp/promises (1.5.1)<br>  - Locking guzzlehttp/psr7 (1.9.0)<br>  - Locking league/flysystem (1.1.9)<br>  - Locking league/flysystem-cached-adapter (1.1.0)<br>  - Locking league/mime-type-detection (1.11.0)<br>  - Locking mtdowling/jmespath.php (2.6.1)<br>  - Locking nesbot/carbon (2.59.1)<br>  - Locking paragonie/constant_time_encoding (v2.6.3)<br>  - Locking paragonie/random_compat (v9.99.100)<br>  - Locking phpmailer/phpmailer (v6.6.3)<br>  - Locking phpseclib/phpseclib (3.0.14)<br>  - Locking psr/cache (1.0.1)<br>  - Locking psr/container (1.1.2)<br>  - Locking psr/http-message (1.0.1)<br>  - Locking psr/log (1.1.4)<br>  - Locking psr/simple-cache (1.0.1)<br>  - Locking ralouphie/getallheaders (3.0.3)<br>  - Locking symfony/deprecation-contracts (v2.5.2)<br>  - Locking symfony/polyfill-intl-idn (v1.26.0)<br>  - Locking symfony/polyfill-intl-normalizer (v1.26.0)<br>  - Locking symfony/polyfill-mbstring (v1.26.0)<br>  - Locking symfony/polyfill-php72 (v1.26.0)<br>  - Locking symfony/polyfill-php80 (v1.26.0)<br>  - Locking symfony/translation (v5.4.9)<br>  - Locking symfony/translation-contracts (v2.5.2)<br>  - Locking symfony/var-dumper (v4.4.42)<br>  - Locking topthink/framework (v6.0.13)<br>  - Locking topthink/think-captcha (v3.0.7)<br>  - Locking topthink/think-helper (v3.1.6)<br>  - Locking topthink/think-migration (v3.0.3)<br>  - Locking topthink/think-orm (v2.0.54)<br>  - Locking topthink/think-template (v2.0.8)<br>  - Locking topthink/think-trace (v1.4)<br>  - Locking topthink/think-view (v1.0.14)<br>Writing lock file<br>Installing dependencies from lock file (including require-dev)<br>Package operations: 39 installs, 0 updates, 0 removals<br>  - Downloading symfony/polyfill-mbstring (v1.26.0)<br>  - Downloading mtdowling/jmespath.php (2.6.1)<br>  - Downloading symfony/polyfill-php72 (v1.26.0)<br>  - Downloading symfony/polyfill-intl-normalizer (v1.26.0)<br>  - Downloading symfony/polyfill-intl-idn (v1.26.0)<br>  - Downloading ralouphie/getallheaders (3.0.3)<br>  - Downloading psr/http-message (1.0.1)<br>  - Downloading guzzlehttp/psr7 (1.9.0)<br>  - Downloading guzzlehttp/promises (1.5.1)<br>  - Downloading guzzlehttp/guzzle (6.5.8)<br>  - Downloading danielstjules/stringy (3.1.0)<br>  - Downloading clagiordano/weblibs-configmanager (v1.2.0)<br>  - Downloading adbario/php-dot-notation (2.3.0)<br>  - Downloading alibabacloud/client (1.5.31)<br>  - Downloading psr/cache (1.0.1)<br>  - Downloading league/mime-type-detection (1.11.0)<br>  - Downloading league/flysystem (1.1.9)<br>  - Downloading league/flysystem-cached-adapter (1.1.0)<br>  - Downloading symfony/translation-contracts (v2.5.2)<br>  - Downloading symfony/polyfill-php80 (v1.26.0)<br>  - Downloading symfony/deprecation-contracts (v2.5.2)<br>  - Downloading symfony/translation (v5.4.9)<br>  - Downloading nesbot/carbon (2.59.1)<br>  - Downloading phpmailer/phpmailer (v6.6.3)<br>  - Downloading paragonie/random_compat (v9.99.100)<br>  - Downloading paragonie/constant_time_encoding (v2.6.3)<br>  - Downloading phpseclib/phpseclib (3.0.14)<br>  - Downloading psr/container (1.1.2)<br>  - Downloading symfony/var-dumper (v4.4.42)<br>  - Downloading topthink/think-helper (v3.1.6)<br>  - Downloading psr/simple-cache (1.0.1)<br>  - Downloading psr/log (1.1.4)<br>  - Downloading topthink/think-orm (v2.0.54)<br>  - Downloading topthink/framework (v6.0.13)<br>  - Downloading topthink/think-captcha (v3.0.7)<br>  - Downloading topthink/think-migration (v3.0.3)<br>  - Downloading topthink/think-trace (v1.4)<br>  - Downloading topthink/think-template (v2.0.8)<br>  - Downloading topthink/think-view (v1.0.14)<br>  - Installing symfony/polyfill-mbstring (v1.26.0): Extracting archive<br>  - Installing mtdowling/jmespath.php (2.6.1): Extracting archive<br>  - Installing symfony/polyfill-php72 (v1.26.0): Extracting archive<br>  - Installing symfony/polyfill-intl-normalizer (v1.26.0): Extracting archive<br>  - Installing symfony/polyfill-intl-idn (v1.26.0): Extracting archive<br>  - Installing ralouphie/getallheaders (3.0.3): Extracting archive<br>  - Installing psr/http-message (1.0.1): Extracting archive<br>  - Installing guzzlehttp/psr7 (1.9.0): Extracting archive<br>  - Installing guzzlehttp/promises (1.5.1): Extracting archive<br>  - Installing guzzlehttp/guzzle (6.5.8): Extracting archive<br>  - Installing danielstjules/stringy (3.1.0): Extracting archive<br>  - Installing clagiordano/weblibs-configmanager (v1.2.0): Extracting archive<br>  - Installing adbario/php-dot-notation (2.3.0): Extracting archive<br>  - Installing alibabacloud/client (1.5.31): Extracting archive<br>  - Installing psr/cache (1.0.1): Extracting archive<br>  - Installing league/mime-type-detection (1.11.0): Extracting archive<br>  - Installing league/flysystem (1.1.9): Extracting archive<br>  - Installing league/flysystem-cached-adapter (1.1.0): Extracting archive<br>  - Installing symfony/translation-contracts (v2.5.2): Extracting archive<br>  - Installing symfony/polyfill-php80 (v1.26.0): Extracting archive<br>  - Installing symfony/deprecation-contracts (v2.5.2): Extracting archive<br>  - Installing symfony/translation (v5.4.9): Extracting archive<br>  - Installing nesbot/carbon (2.59.1): Extracting archive<br>  - Installing phpmailer/phpmailer (v6.6.3): Extracting archive<br>  - Installing paragonie/random_compat (v9.99.100): Extracting archive<br>  - Installing paragonie/constant_time_encoding (v2.6.3): Extracting archive<br>  - Installing phpseclib/phpseclib (3.0.14): Extracting archive<br>  - Installing psr/container (1.1.2): Extracting archive<br>  - Installing symfony/var-dumper (v4.4.42): Extracting archive<br>  - Installing topthink/think-helper (v3.1.6): Extracting archive<br>  - Installing psr/simple-cache (1.0.1): Extracting archive<br>  - Installing psr/log (1.1.4): Extracting archive<br>  - Installing topthink/think-orm (v2.0.54): Extracting archive<br>  - Installing topthink/framework (v6.0.13): Extracting archive<br>  - Installing topthink/think-captcha (v3.0.7): Extracting archive<br>  - Installing topthink/think-migration (v3.0.3): Extracting archive<br>  - Installing topthink/think-trace (v1.4): Extracting archive<br>  - Installing topthink/think-template (v2.0.8): Extracting archive<br>  - Installing topthink/think-view (v1.0.14): Extracting archive<br>27 package suggestions were added by new dependencies, use `composer suggest` to see details.<br>Generating <span class="hljs-built_in">autoload</span> files<br>&gt; @php think service:discover<br>Succeed!<br>&gt; @php think vendor:publish<br>File /www/wwwroot/azpanel/config/captcha.php exist!<br>File /www/wwwroot/azpanel/config/trace.php exist!<br>Succeed!<br>17 packages you are using are looking <span class="hljs-keyword">for</span> funding.<br>Use the `composer fund` <span class="hljs-built_in">command</span> to find out more!<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;div class=&quot;note note-danger&quot;&gt;
            &lt;p&gt;有被封号风险，慎用。&lt;/p&gt;
          &lt;/div&gt;

&lt;p&gt;azpanel是一个免费开源的azure api面板。官方给的安装教程有用lnmp和bt面板的，这两种我都不太喜欢，所以写一下手动安装教程。&lt;/p&gt;</summary>
    
    
    
    <category term="学习是人生第一要务" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/"/>
    
    <category term="Azure" scheme="https://pawswrite.xyz/categories/%E5%AD%A6%E4%B9%A0%E6%98%AF%E4%BA%BA%E7%94%9F%E7%AC%AC%E4%B8%80%E8%A6%81%E5%8A%A1/Azure/"/>
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="Azure" scheme="https://pawswrite.xyz/tags/Azure/"/>
    
  </entry>
  
  <entry>
    <title>v2board 免宝塔部署教程</title>
    <link href="https://pawswrite.xyz/posts/17541.html"/>
    <id>https://pawswrite.xyz/posts/17541.html</id>
    <published>2022-07-01T17:11:13.000Z</published>
    <updated>2022-10-04T15:51:38.666Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="b696defcbf2a3c1e4ed02e724062985de26154c55f0d1ee86af171ceb0e81fc9">6d05a0a7f8f5f26ac1a0f788610c8c396ab387df384a79e97767b58cb81fa6fcb728924f698a0c1fe9d920241a4a0fd85b12c3171b628d573feccbd86958a4ceb405136c0b062378181778499658243ee586c9e27901d4c922d6027c9d466b621c3f6c46a917a577e8ab18c83e32e46382a5d014a625ddb1d0cdb6d4d0a7713ebaa3300386b9748567b5004f4f7aa2b63da5f4c88a5ad44859fee57f7cf65f5ad35c48ba8ec2a9742e951a292e55a8db993d316da1efef5b062c582c4105ebcffa5f9462022c445343c4d0686be59d98b3c622a46659bb1d40e2863c5fad3fdff086d8ecc07f729bae868e4e1b66e583b067097b157147ff2e21d6742712f6769ea30c210eece0fef74d4bffc1e97c7c56a6e10b0c5ad30d42fb22944c4dab30e6c0986ddb8e41ca2abbdd8879c5bbcda7604355521cab192fbaa149b0fc3e5bb86db0f4f258093e6edb738d8c77e6ae035721db5b25c68bd485d4cd73044fcd162521dd0152f00c531bcdad91f152e095c07f790e15091e1a21c9da9b2949e02c635d634e7b3e752f2bcee7bbe103af2bb9e8cabb206a415843e8b825117dded0d6db71b61cfc5039d282c42d447bc7927cd4de5c99bcc3fc0a258eb2ceedb4e85da16e6d13cc03b836510e2082c0b3e43d208fe3b07ec75945c3b7d3454ccd4d6eafbe462a959080bba27e3f7a68d85b3e9dcd40249f601e3217a67b64e275dac9f3a26ba64c67ca569cd35758855133221fd49329eaf63f2dc4c185ce8f79f8f2e4a7534a10d0f4a85b889e1556bf78ddc97275a2427d31bc55b56a51d3b1ad04dea5e96639fb37b3b7339eb11e224ced38f837282ee8cd3a7fe086d3496ca5214c8c6c01184e572c1c6119cb1f820bd218ade84c19e31731c0efd08ecc3587c0cbab9ca94aa1c3eaac7e171383745007315723c02d312e8a3cadefd54b89509e86fb980cf2feab9dcf25fb09f400db7c5e59ba0cabbda88a6a947efc090f727e31f37bd14e39097edea14768ca540ab24189af4495ddaf037e5eb0d06f4fe4b714e7a7f56a27cd3c5a9e08c578fd20ce801ae0829bc6eaaa8968e0c0868b4b26d187cf7629e17b9c1f3a281f9ff4b99d291bd7c89696d845fc13fdf4015d8591d7c3b1f6be504cf16688d285d54e7ce24efc7f4082c7721c377835217c7d97bda16f199db5a084a7b9d6b28af9486bd9466e27b2be155f31a27b250b733a9e43f341da4b0bb00c6ee22476d3ceb338d1457c98d4853df1132aae2b0efa4ec92b790abade168eec941817de156711bbb4202a4e4de5a162740b686047d65cc635f5346eccb23b08312896b09efa15cf37595868bb6b4c78629283261f049d4946af27f99a00aa76c66d269f407bc0a22ec6e385bd1da0ec7418a5201d5c6a3a98144f9f170656031970c0cedfe4722ba019fa99cec9c3206e80f1d25f4fbafc3ec259c4f3cc2c03cf864a3cdb01fbb7075457c7b68ea35064dc9eab04fc35a906eb40a9c17b765951c40ec385cc99e93eadd3e39216e2851fcea0c3ef30ebd947bb055a1ec54f0f91c02d84cfb75e857e1ce741d564a2d4f312428a769e1de8fabbfe007a6e46e3ed0761c2f4d59a108ad7b74f9d9701cadd39a47a470a1c14b5500b80a8167d06f76b1827f2f11be6240c574a646ec58b9ac8d4431e5ba123f835f0aeef10129d1ae7a34912aee4ce25e2335ff55d829b4a689db647091bde81b10d7b29c10bf05dcbfbff0f42cd00f981798a167b46f0b635b3bdc74243b1a04535b19cd36f1f34385f36adff37e2647ada4fbb5422c474d63ed4f978091d38dea10b26876b88a4d1b5d242d871cbe1549f3333ebdfda4ab2c7244427bd6273cc5859a80a80892a5e9441710d0edbe9e09a2e5c719b230881a29fdfc57baca51181630c07f45a49aca704bbbad1ffe27172a049aa87fb7114dd353a0c56f2646c7831aa247909034b385d299272fd50da4a199adb2426244d630e066f91cd9f4d0c1cf1f06e28e951773db9814a065a1b7cd68fbffa7e629608e7f31b07d3273b4f0a2b67703bea3525f7367781bbce1a39e6c433d104db592e0a3e75ae11bb12501bbbc32cbca049ca9074600a91a755c4a6d95c1c3405e4060f1d11fc9094ecf68bf3173abf8dc7ae71e915f4935751238f21486ed1a60d7f23e87db70deb90078d05660b9c8b395ae233f7e0977d0a3c398c3dbb65fe58a8e3c65b0cb5c7d34b458059b99c09e0fb330f43770d328801f5d63d6ef7e829591958215f1de153f85d1160aee4d39f3a9ea0a23321abcb4b054d0706661c31021e8a544e43fcb5bd5d2c30e0ed56f6bc7582c6ce3de971d4790625ebdde2b7ea6bf1cdbba1c9c177836a2c138bb3aa6ff06346f6066db6a36114eb1970fd47f63b60597051cdfa4d3bc5b0e3c1f67827d154fbac9dfee156bfb9978a3d86e500163a3eb1d37b1e2c17cefdcf2032da689cf2b7268142e9c500761e4fd3d4c543896f697b881a908216b944933b597a1233cbd8aca50dbcfcf5eea61d4f35f12f834f108cbf72d7a43ad3c3f00c83c098da847249c5fbb7388da6edb0e50c3d3bd47e4298f90615ec800da3e16bfdd9eb302f9faa7d01fafcbd0d85c2819ce71f768ba2c41918cbb665f95fd7ec77f60b8b65a887a0036b923560eb7dde06b50183e5231da48b0e7c9bc5c8e806f004d0ab5b7d036bfb70a7dbb5208b719bb73cf6fd03a24055885362d34563a4bb3f5e54ff4a8b79574e57bca8d5bf3078c5b32999e1de993de5f2d3d181311ca662f582c2a2965c672f2ae53c61e4e670b6365cff85ba85b810c85f93f46e96bfad6ad37da6e6b9add8b525e3172b038dacca675cb4b0f991e71fbb797081cd61d05a92511df3da28d3d4ac07d28939c824ed393ffa1b1d88acf07e69749ce077cf42f9689262a307cdb739bea8709e1b9604a2c22360dc199741b3166de19476f59a3a07e105a7421b71f1cf4065b1ccc2d7eca893e7779406f1850fb7cce5b265f72e9bdfe568138eba6527c6a088ddd65afa3c1546a1a3345599cf4ca5bd58d49352d2515677696b832c4ae2d4587be90d8e7bd92cb01db938fded3e3f2d927a17cce71f3fe822c181a1692ec30df4f11ce728827551552ab12de7e5e56909fbdd78ce48d47257e57865f4a6fec099a27133b978397e60bcb8b753db09e8f28019639bcf3f101b54b21b215623858b77323d2e8c721ca61a5e63a7d209281789842c269bf2cf872e52df2a487b9be6da3eb96ec43d8d1d6e5289610e1632e232d91c90d109caddecfbab50de6e58b4ecf87a7cd30f0cfca0944ca7eff7e7b7ba4b20382edec5c0f6a48d42ce15b9d2e0ab1e4b7b14082eefe25e3e86cad7fa975db5d207554444c77cb093d85298bd09805693a4768791c6b70ae86ba77702f7c13f61a9ea1a7fbea9239d6b6e01a3de2cf8d5713542237ba9766821c2eedcb47f56846a21b7a4a0026ebbc5b2d0353714050507326e92469b2182de070b61d500b16f37f22d80ccbc9b7e89e72047a2abc90ffb22bec4f1054f28a27db7c30277d6faea0f374427673a9e9b62ffb0b01117aca7f3c1380b349c2e3982185b9aab8bfc8753f7029d73d26b70fa64ea3e520d10548c1de389f2f68b39fc3062c535da304db4639d6599c7cff453ecb90a27c9b3e3d907646f8d42f206bdca0cd3c2284e22acd8edc03148583a55e31d798d5246f80cbb815a241a5c19993b5d589f9cf98c92994a950a63f5ceec5f895609781a835caa9af7e8d6bd9a376edc8c0e8181c9209ebddae6e5cce4bf10ab1e1ae95178ad38f01960fd24eb24f508ce84d050c5e8c1f6fa3b8c0222f7a5a6ee8370db66afe7aafa82a0e4242062676ed1483fbac0653397cef40c69230ab1f79085de4897440c269ef9e7492df37eacb4e44ba6204f0676c245bcfcaac05999a010a649e46a94618203373e8d0746e9a109c979cae5d04b302b2a02231f251e98a2c7fd64c0e61dc31588620d08fde3c47799e2380925e076da860f1b40554f7f8ed77a7a5e40f1f634e8ff8b72ddaf8343b4f148a3ceb55a8ab630d142b80a532790337dad67d09dfcf7a6df9251977d65cb8a49b4c72574069d17405857d996aaec06d9ea615f223c62b380d8289d90d9362f96bd82da596482ee4bae57fa55562da2f7bd1402d5c15bc0b4d978eef5c03cef1f69c0707445bb9be9597a6ab2c6f6a5ee5febb2066546a2035ea0fb0cd4d8708a8a9b3ebd864d3ef8cd351650846802d39c2a36cf51c42672a72413a1f084cc3cfb6dde72da9508baf975911286a60a3ca277d8cd97b3a7314722070a721b6fe2070a71847ca751e1d810476e84f26d6d8b54e383ef4eb7b1e4eb71acd5039fb4153dd057bb6d9239a472b4350a6536314d3e0a59f68c5321a35e3ff1c2c0ab399e0562053400ace2a6a5bba7bc5be14d3a3c53869a0b97852ce4dee9343ab78ea521da725572b30d7a8cc2f72ab2b38a26ed16a230b08f52bb5062f21a21c8fb4b18f7674074d047c0da4048abd5198098ff7d97a11f64a0d8dd6689f5b115c0491a705ea3fcef6862e76e41c6a0aa4c9557ccaf3fa52d64603cfd61e37bcbf4c03651d7cd95a098740f0282ff26e1042e47a64e6826e365b6215d51bcfda11985565f6173b01540d462b78cd22fa892e31882379ed284c04f5c3992fec588c74a12fddd200ef1d6a5971329150d605034f4ab547dfc9dcf8fe09a80905381285e75cd5fd97ce4ca8c77abace8ae911a7c15427aa93aab2bd60fc0c8caa2492dbd2c0ffd636b40951e8524a376362489cb4a6140a258f1deda4307f1582771a333bfad309c64221d038048df275640f19484d0d5b713db54a49b0f0719e2e57b8d099a734485e5fb2d4ff0d1cf2fcc2e2a565e662fd2fa27ad9ee330c95c111576e207eb66a237bd9aabef45f4c5c2d03bd2cde1e9a4ebdcd43bee85ed66c663835b4d78ecad5ac1beb51c0441ee5a9583adf79b3a8b3c7a091328610fea4350f8b67bf967691aaae015e4723a3027c48ed31aa726d8b01bc0dea8622dcfb34ea1b7c80ce0ec06097719ab46042065dfda0c33ef1c69616aeaf112e3fd00a70ab6634bc2b9695f930d8c474e2268d77fb6ebe5fe81904108ca7ef3ffb103c517a3f343e26b9dc7b662b59f401b10ff2403692ba6f013190bd4acb516a8476698b4495cfbc032c942c2f36b0be666432a228247995ec6217c23760ac79360b89ab630d68584c2d758a4a9458f40129b8823ec0e73148fe84ce7482cd4851675b0304d1e72f8155f0103e4b1f2c6ed10fd46bad44ef1b2e1840bb8f67d9c308bccd4322e94de26fc855b9d83c8a0db0a208a4de5b7c0e2d130a3dfe084d6b60495d1c759dbcca8b0e9a6dd3cc7fffbc736328f3d4c527d2c2e346fd26e3cc81b0c1a512e27fe2c211bdc7269ad1198ee3f7c18392f3301bcc7ae1266c2a8c8274a32d44e1a253c615aa7aab7a2b305a8d3b563076e7c87f76bcc6e1072bd832276c43b95c664af0b32fbe9813c1c163f74d9f1c0566c4f97dc001b1bd7a9e2d7e46820acd8aa04f2dcab9b4e8d8fc9de2b2eb725849d2429867e9e6f4ed1930fdc27b4a5998f92dd0f5cbd26cd471732bbd9c9e376f0bccad901bec4ad3cae35a6ea413cce8c4c0b796bf5990c68e67f4ce045d6247122e78a88c098cf8cefb77e15fe00482b565bc14a9f5f66a82312842fba4281164dedc68d84305f35f8ac841f2e825bcb7f41f9cffba9bcf977f94a734bfa205ca67cc5c1c0f350326f33efcf1cc7813b5bb7c005bc6162cc4638dead71a190469f9f73fca2f192f3458f85d3750410ffe33f804ceec81b31b17cf5cddb7d788c9c902e8c893c38f5b66e7deb980a65a6bce5aff69c729c51590077c159c5b9f7cb17ddde758b762d790c58191c5a4b89ffb539a8458610066ac07ae462ff6e199c10b45d16669b890ea717251a85ee2350bf2756530e3d852ba24c5da8dc1a7c9a9dade3bf406f13ca95c49ee1ee8e6b6294a7791d4e31f8c6c7f811104ec99b6b2afa99a625b997c6ae73e7174bbe24388d7138be0feae8614795c4deac4b26ce3c55632ac4a9c89f4ec32b8c7272c85c3dba7ff9d3be47de4b652ce9b69f09d094069d187fbf6e166a3efb4b86546a3420a3c36bc6a6c2731241f036be86daf97f0b3ebc9fb9a3b7f664eac75ec0fbe6de9ea4c9dbc3ce5a19c2b3f82d01639bef2e634bb63395a030df507188e0d7cd48c039f7003eda4ddff1616b6b73451ebbc4107998ec421add640a7ad28e7c7ab1831d4d7f4ccc2ec434cf4e121e2b1fab2e65ce5b335eaef4acd75af68357d9a5d449783b3cdfe523c17a6caff68b94868cdb32e69ec5b2fe261073b30271f7c21843d64c54f4071a81dd9b088d4aa75dfb747d1fbb07e3630261c792b2fde8ab4f97e1d11dde25fab5f49334a30363bfc12316bd6b1fe2dd3473a7525b2c3d13367641866ee8ac47c6a905a236bd0a80350b935929b8ea9cae1396d717593197bde644dbe38f68c55a855d3df6fffa913bb29783fb72d36e1d90ac92d8d25566717b097bb88a710473464ae5f262e3af7401dad7f20421c5284a178dcf93f096679898676f4cc5f5bcebf1d2e35970ee9d2459e2e0085fec53c245170978de1de487b8b55f0fe16842510a55d2e1e40dfce59951953722221cfa6741fad248af835a49c8bca197c9145d9c85da711e02c8c76aa4f6cb213b0983ace19630fe5bfacf8347e220b4bd94ddf09258551c5577187ac516af8969ac8247dfbf99464cdcdfc39a01898a194048f1a201fce6b0c7b5b8be798dc4693aa28f2a2da2ee7fe3385f3f02f58866637dd0fc0598104769792c6b222811ec524638922f9c940cd92e5660440e42465d07c3efc19fbd4cc5a3ddc998791c9abf89b1e2cda1f7daa2a0e734c55156d44bc710528d5423e7902e758f49a05438fae653969084d94643b8f427058e4ca40decc3bd18c537b637532e3a1c49ddfe1b1c05382f9ce3a10b9b43050f9927f0597737c195dc0ac7b1fbf62012a3548e4cd99095378bdc8510636603e26ba9c5a13e4ba1573d7a01d26851990600ada459f59caef056633c000a96786a8299db44dba5f8169fbaf66bfd26d89a1a9cd33d2ce298d8b6716167171fcae1e6f60f53ec4150e18922058779e824ea9fe44793e849e2556960762dd7fdee62379f94c84304af3d2e3902f799a460acdfc775b4d2a1503aab5ac403c744311dc2e9c184d7956bc7c8d0ab2feb38156c4fc8ca3e651c93cdb492c7496494c5b4794cb87cbfbb07744044a5f34ad48e655323e14a29ba2e8e9f7a5072303d22d7e96a8e071c5cc5fe13245330cb94033dd65518bcc5e108b8c9b97a209ed0a4c9bdc392828d47f85245d771b591873a173d6b65c18c9338b25caf92256aacf4de5b428675a33f00d79205d3412e6a189c7aa649b18aeeaf40f26ccb9f479a4cf9cf4d3ea218dab1211c54232075202ccbba9103ed5a258daed790b0f2e053d31113b6863daf83174e5b6394fe1545da06c6b307ed3ec87b62cf08adb9cac5b6ff891cec77be4968fdcc684f11ddf5152606d6514e578972aee917b151dfc7f635e2f05f1bb97bedd1e9a9c713cf459e4b5098ae4c02e14f3964ffed075e84a4f3137e8170197cdac3cd968b166adc093cda20b8d9b81f156900ffcf49e1993e4e67f7140d7fb20606ebd079307fc3742ac4c1f1782c8a9c68dac1115912bc1c3eb64ec5c382a243104aa8a140c9d84d78255f1ad79721ea4eacffa9d3168570ccf5f8df2c68e86e854ba4c6468deafeedc3011fa3245df636f0624b7bcda9d39780d5d16534e6b3bdabfa5eab55df40aeadfa8058f72a36bf40af84096370f0438a4e6cb2acbd048a79db7f2aeecf1787033c4ad534baea2e4db0cd19e533ab6e6a05fea6aa2bcf7ea5e203fc9fed9ddd578497a9824a7a3ff14e474cb378a741d017ba05e4ea83d9ebc395b4a1d16db8f099a4eb7a9fae5f33cc6dd3bf81a5dc0a086e98bebd10462dbca2b95f8fe2241e594dc830a8872460e7a9580b7db9fb0809ff7f2ac4e55230bb0955347fa3af193e12e6bc6e71c671c2ad7a7a38cf8c72568a5384c38ac44dc9951e63f633b4e8d547f36fe66b11191f34f58b9549c6355ceff05692e547859d69890ea453cb85ffed64492f1a8f04bb9c650feccbbea38485616021a16090ac09f040793dee68aa932d5b69cda8be8c0e7cda64bb4a2f9cdcbfe938fa5656c4765200750231b83acaf73ccd13e086cc8deb2f8b5ba9b1651a6a839be1edc8d1bfc80801649f24833e9cd7fa328df2a2a0c49c82561992ab03ac5798e07268fbba347e39271c028bb3c314d24238dc475e9e92397c3c4846310a48de992db452f9540c4908ec36f9f2de86abc77b879e6669c19a191c58dc349c24201091738c6ff3fbdde7e7f4ebf047354420899817790da51dbe430452209b25522e68b6b891a92a6f8100fc4c8ee307555882519ab191a4bdf7f2bcb2d1b2eea7afb4d7432e5f91b24933406fddf5a52b8183055d2ac1bb644728a823697eb928449263a535c4637e07321bdc8e23fb308059615fb8b87760c6e2ed3c2afeb41b2c1929f5385229101f6de8ecf91221115de17a5c54a3b4ff4f70a15bbfc28384370a03757caf53489fbcfd37f0ed20ddd63ad5f8803e7e8baf4deff820cf59acae21789b425d1e2d8c8652d73853b893a9814cd4f17f4a10a8a7747efe5ebfffc119fcac678569d7520289a84eb8a49192c79812e9e3d8533b549b6ce94c2224ed15eb2c1ca980587c581b249bfa6ad87ec953977d8426080307c43d86d57e2e9dfea862c8cff23e9a1598c54e7fea87bbbe7c4b45547dffdcbb5be788a5760b34c47e8087dfa1b2e553dca0045727c044ef7d2966be1c522dbedc5df5f98121ef7f732d31a658616975f64b689b5b03754d5845aef98d484002b35251428df6c43689188b016af59e7fc6c875f511aa6f2ff6f561fe0c300b453760dfe1fb8198833c2e2a83614b7ae1c7ae4e6976b1c1352101ebf903364e500cea4878de2d300cdbe9d6be52e3913010155682bd754e8582575dcdb5a1e49f0ebe40c361ac9199eddc88ba60292bf96c0827a2c0f83e2ad5353fb7a7786a79be37233ae40de31a0e2ef22cb2624a719cacfd9e552a7bae1e4e9e95a3db6089108621b1251ca3e8a5a000d8d2b3da4c11c4e28c9a450aba206c2202c6923675fa9bcddfa3c887fed9596654f037dc9a933ee42cca23ba6ff084a5e18df84c16cfd3d64300423b45daa575993c16b7c483e5d24d65bd33bf49b6b3aab1af4606e35d867356251a15b5a3d2b0c48312533142a3d4e9eff7a1cbe9a731f48ee7e45b0bf10fb7fbd99b471ba4e2a7e2ee089420b7e47eb83c18df898b80a4b51ab53b9d7922ce5ab4acd76c62c03a2353b201c81ce4e7ea1e333381bc087108e18a21dc9efb695189dbd65c2e6c973f7d13d4f2bc87a6fbcf53a3804c567533c8e755c205d365e1096c221dd3be460eabe6ee1d682b43a2d2e118ed5d2e171ed9dd72507f5e1f38ecfc51d2c2a91d8f240bc4fa875091f91b03dd94386ab91fe8e70944b6b981a2fde2954d3850efeef52e6a7e3ac4e5a9573b450ad2bf2f15d35ff8091b4274f080c7418551e4ce17a0a275d3dabae5771518f08f901ebbba7c333ed53ceb8abd05bfae59c355bc54571ccb881a4471eff141f82af842c33da3f509c7595c950289d9bee0e551fa61b0b515f7c19f2edef0106e5afaa164cd1f49e18c12741bea3e6238d5ba97b1cc6cffc6f957f837277121a08e1dfa7f0f9d8757f8c376a770adcf2583f663dcb33828ad7f5ea71515e5ffe3955fc9c7dd9fb7df53db6b04a7f3f73327afb8946e1c8d1e020e7a2a50db6fe04dd7d04868286670eaf53fbcfc43edc1fcfe24ff998f85735d07083fc68362d2397ad2f1596bd4c73d8e4accc8d6941f40dda8afc6f3263dd107b6910b12556230cf5194ff1ae3eb2a06075179c7bc3ce6633445e49bb7ddc19614e9e2a4cb2703e4a0fb56014c4a62c5e74ac2741cfd1e067bccc777111207dba8087295b50d8227604b14a7decb7284945faccabfcd2738fd53f2c67960507d1efc3f4065d0eb092ae344f55530c8cae45ea31b75503c4fb627cfbae7cc27251d749181318fdb2f2f14b581b1ba8c3d500b599ea29d6bf5f7809a1ff8dd1a34b2daaa85320fbb9200ea2df3cf8cd8e1737d2b9e6c2993f881466abaa520ab0d9d1b90e5a39b2725576691c769269fe8590bca1600bbb309634e63a653851d7709eb3d268246b68c9be2f49fbe8ae75a134322f8d53ac08956f0de9eafb70c48361813f0f67f9f040f2eb967fbfdc9437143d9a611255b19ec0bbcfa44ed527a91e52d25fa038743eceaf2ccfefa0acaf95b11369ca3e30c3f6c0ff269dcafb6bd30403ec96f6bd8729d329c4c0d3661e82883551ec954165b2134a0cc80efc7cdfa02a5ec72d6e201ff9d2a4b10a2c9f4b07cb1a14932b2dee0869236f05380455e34ffd356af37f1d59aec9b4aa3f6e214b5722f838149b28d7ec4a14bf7d1ddc90329ba785d2c23a8d270af76ab6b4a37648d1478c9a0836b31375d7659bfdf780838c8f9f8ebfc6a2cef52addd418c021032051c248d211483e570510793d2a05227607c5c373b2b31bd6051533d6069a62c45779131e4a7c1948636cd32fcbfdd5cc38c3723c3927d0c2fd5ea198e257509f7ea34f0d44048da68d0aef8cc662f4d3408e1aa1224e79819ededffec779da4b6a4423e6bfb0661393b7a16dd561e8a65e17bc1e478f3b28cbe6ecab6d21688b03d2a055f5c1e949964ce6968bfdae07efe97c1c08f2c54293a75ee7027afc9c2458c38e24af84c1d5ddf3ccd19654f9d1911cb304509717e95e5b0ee07c6c89d6faaaa09663390e136599f0b02981b7830374b1b94e2fc0802e7cdafc02e1e8401346b04044971fa7ececbf2c8b1f7a5b8d2a1ccf448b33f78ffed9bc3c2eb2699ba13474f984d270c318d8e1fd619eda763744f034ca896ddd63af9d1ded3f2f2f190b01aff4174bb688c651946f344625125cbdb955eb8662c51223c663ae75dfe69c6f0168b7dfa0e27fc56263eb2d8e0e20ea79bd58a45b6e5015fe553f94c504251191533341a30f49856a7e2db3c13b4d4d5761144790950304b80fa1d70690be4b467c0b463909fa95a86fbb48818bbcc5e3d15744cfc1532d038862aefc3cb8876b5c12bd736d7cf03ce1292f832002322ce0c8ee8406142f6b053451fffdd227e0babf5465417a55c175145690640b79634767923689b58b0f37bf0922846c629a97043b50d7a601bbd76831fda19aa212e64b29b4f45c829cccb7111c2f6cd69bc61879e3e018e15cf6efc30b910ee9fbf4b93d1c8d7dfb79657fd50b1e3d71e2b7e16a7815063ad4b859d9bca5deebe52465f33a4e889dd8d47bacb5d3654de7f7dd658e2fa6e00de839b941ed485fe3a8a71c483f4f150a9f1ba0fab1c9883d6dc8338bcc763361a6235be7e6dfb766dca964b02e193cb140e89efda718e8d29a7b012e8e51d700bc11a67a58070bfa533428c815e9be6c3acf730691b739ad5f77d55d111a3ee9da34ed9ac51ca6a23826b222fa5d6536adff751015ef3223ae271d6c4a850304bcddb85ea04548a06ce293b677805c6bcc488dac64afeeb964a42e739c1776750a9ab13227c479e28d2bd6cb04cbbabbd2d511e4386d868aa95286602c83a41536530bbb932f2dbcc6eb6ead617a95977abcdd8c924c9701fb6cf8ddf31ee7c670775feb636ee0f51109ac5fb388d049ad15e3d0f337554b96a71a82a9fa7c10e8dbe67460f0c8667f3483f8a80af623b233e0370d0b4d8c9fc94f96c134293b0d2d1cb070e4a6410168d6f57905b59374a775a4af050bbee4c214464adeda75759b55c466ff2294bb297ebfa8c32e4e9251f68f06f12f6dbdc2a4fb0750a110d6b2b21a759d5ae1e0722d458115001450685450f5bc1a367eb9231c5542d8454b1d3cc234e70cf383a04124df4a0e832dbed5d46d85699f4179c9a3f356e2eb52123ebc167d5ca277bd9185efd408f0b6c8981d8dd2930d69de88bb38c09556770a55bcb0733f5943f3c90c55b5f3d7b4de7a3330002e62268b6215cbc9effacef5102f025e6d66a58ce7334977789a3951a2ed01e0b4f5c85b7713bed8e4d4f8eb498dc9b92a03a9fec2ea6a3ab53f4fc0a4aa18bf96ff219a7e8aa6b6613576be4742b01b4bd69ed8ccc6c656276b4118910a7da63805a16f314174b3a74e4c6734eecfcc708cb03bab05a030e801df0c85ccda575bbbd57836ad502f415e42f415c4678f05865249b5ecae6d633b4a52eabd9a6a97d875738f851e826f41a8524586ceac61ecc06de9bc3a7ea9c88fac19b0fc3dddb59f13d0fbc2585708c0c0a3f318571b58cbcce176f328002397576c720a67a52fe0981eb939df70b21dc265e688d4104b8c616ebca24a920b95f99ab5a0a6b9cb7b5d2762843158bc1da8c8a778eeab6dea6e04d93f9a160fa64191c8f86069b6e15230ef24ddf926663a6cdc921be3b38cd0f7fb12a275be0e6f213dc9f8d9117a39f9699143f112c5e1dfa9bcdc8cade05bcd8eaa8794719061734e31a839011586cdb5d7b3354cfa1318675da34d56ea958b5824c39c7a3e40a6aa093bc13189e75c1a1fe792b2d2b800af35c1ae21d2e2690ed3e0b266915c06ea16ab50c931d1d4a2151c447e143423181a59151d382f240fe84df3766bc22f3311e8463c53fe58324fabfd7f6163c5f482777409ad5662ed604a6e91ab4d9daf5c26fcee2b63f1b646c144ea0d96bc1283f56232703bd38497ad3b63790007ad09c2cacc9b0fd1bdc04b73555b84a4147886b7a46f4ea5396a97615f04e4a52fb9cac572019209d5b4010b1ae12ba6ab9a2024c5bc3fe7b9ab134008ccf16ebaa2ba02c8e358bee7ab4047d01506a7a96a9b9713ea21d101c3d6c0e90c38cf25b8519008fdaeb557b6d88936419075a7e34ebc63a25913ef723165de85e9bf72dbe961ac7e241dc9cd70336015b37cdd14501048d3bb6dbd030598a0757086e0184b2a8d5ce2c6dac7932c0842d6608f2365208c7db43d82d011beb0bd966abec5c6a11f05b0577949974d5d0bc0202e962e04fce66aa3100e6fec606fa329ab2a5efaf0c7e86000cf8671d18aeae765c2c296635fb8f35bc2ebb0cf9a959c12f8066f6cdcf90cbe31d518b9aeeac9b85cc83c67058848b16c3c247bea68630a313e4747f253e7bf61089c59f69ed2cd45e617c90e83eb66c8392bc457b10b556b2f62a3be16cd5ffc8125a37ef08fbcc3cf76d145f0a099dde6a26d07401b7a0e9ce008040d98210604a9e7431099ca0a83f55c5b40f41f11258fccc6c5082678d1adc6aa656fd6f05f9c1061416f54bedaaff2939dad65913c1e0dcce403df5634c23c271e834071b7a9f8f42c423acb5914badc518af797f5653bd4e527582f7429781e22cec0e64058812bd0086a2a95bb6efcdc27279d67475056e5f9fdf9da49538cae9be1a3ea55d585a2412f819b23423fe968484d6ef703cb90c69f785c5a7becc9c8ecf9ff114c0111237274c7e680573f7fc0d6afbd995a7d2bc130fa774001101c4aa347d1d59ca89ffb7d7ed1df2529d5724563adda09829e3993030485d4c555c26b17e725777f732af8d5dbefefe3531b7983ce320f05259a424d564edbebd409dda082c9c0d507607f59fab9ea0c2d3d6a4e6f5bbb9b87daaa1751444a076bb03597e62541f041ab7ad400b1bf951b4ee61443af2f9872b058e64a8b9a5b0fac267d42e8286a3c75cbec55ac2d63525943086e83fccdad52e316a83faeeb3d257ebab5cc1bbe05837e00be4c9f60c6982715f4e5ad8fa0c35628e0063ce40bffc5f2ff132d9b55794b682bbc8be813b143c8638936d2c27fd97705af68066f38e731693245abeb0e4738e2e49c884ee09407dca3e945cae51bbd5ecf047a67b676ea4e61aa8827e77396320d857cbed0cbd24dda0e36d82a81ae137048cc4fa0144ab2196b974cc67d415bdf5b299eac8d009d2d8ba26af56d379814e860a1dce948a358dd5f655bea2c5fb5643308b58a1434e1e8dfe67ca2c2f4df6a8e01154f86cae600a0cd8432c99e36532ab7609390e14e04ae347f9428ca8f8a9fd322986be1e57ca10a802e160469fd9caadcb0bfd6b327b5fc4f32feaf687066c96c7fe24e1b6daffde490362eee233f10f581daf766b23f36f17166bd1e1011b4a7f3853af59d86adfa986952a0ea491ce18fc1aeab75681ca9978aa8be83d1c5c9ac4796fe22f32213e5f242d3687d07545c5fa2d825a734d7889ea01883b84401377fd1623b5e9d5207ceca64a28d5d3ddacc86cbb6aba6e875fb2d77e75ca18d0cdf2e014c2032f9ecbf03bc62b64a2b69bb2ba11412a9926124af35d00f5047c04bad2f6fa3107294ec9d871e766bce023fdbd89b9c02b0456a4d2271db0bc09ed4f837b8e20da895f55516d0a6cc2322cc93f179a5c801cb82a88e9264689abf70aa3bb844ac8a0ce11ac35a18e81b30388fc530fde8db98935fca84b1057ea0f3c7562a5ec29f073d04a3fb5e8aaf75817f2ebedd4fa2357939f435234039dcc95b87ae5876731e36f17862c958a25790d550ad76904d8ac97cfd9661d3ba32009c57f25d144918ca00193c93492619fd124dfbac99b8c83582da51ed8bad5073e14e68ba02983894405476cdb2b80a42ea8faf04e5b180fe905eb6b4649ac1ba1fdc7b6c5dc77bdf0de1b598dc8180a97be453b00620c1b20de584c8e42bd6cd99575e87ba0d20a4d0c7f980a6ba3a5dccdb1b7f9d8e41b1c709685edb8c16bda65cb5e3574aaa308adf9d8c9026226c430360909e9ac7f1b7d6c57c6de794380ac1aeb1c00a5f4fc4ad8387f988f1eb393cf37ecfbe48abce03b4827b45e85c16e1330a208b7049e641ce8232243595f754e2ab03c69a3a1ee587e0daf2de778297380ea58fdea4208bf5a7e018acab641681c3f4a4c992767ecb148861ba1731532c5df28d94c84c8be2add171219a2d7004d5343c70c920b788d686889e47da98e19c881da7d1b8cbd412ece5529cb27ef414f29337656f85ad656bae3c1ffde680ed4c93ffe6bbec67d65758272a8c3f038915f4d6b5e0f0bbb85dc7a97ae192b50217207000651ffb0ccaf1065c6b3411d3c0bf4f5d9c7f2bc456cd29f60313ef85c8965cb1336cefc7b3caa445790d29c498cb4754f8584f42cd6af08c900dfdad962d45dff46542d87a83f4125b00b3230070cb030905c07467b90ee26d0706d5e60e5fd0155c192f49c4e3e32dbd7cab57e5bf4a2774a55e8f27cf32aab4a6cafcbd986dedab3377ac64be59db9d96c0f08aeabecd18eabdc6dc98672832b4aa7b799b08f62f44618ffa665255c0981f4456ec07c128cf220b7d58c8765fcde55481e7ce700d05d36e71916f8009c77cbff11de8916a73bb9f830ff7ad4136411168393477af7cf4772251292333376fcea9c7e6eddc029a79ac36d4367465f4c9a56cd7d10f980a9978a33fb07fe7dea842e7c13a09c551a7f46cd5c9a3e7b02769edb9f47c6d7e422c44fb1d2e01e563aafe2adf1f1d4ae21ccbf9e4a63d1549177466da1b7dec33aaecc00d383b22df70832894af8395c68597ebc444a0dce8e1f12045d08f0200d3cfa65b3ce31270dd76d3046c61ca4c4a2d6e731eb0e2126da510ff0d8ae572a124cecf0b30b0d47570a2d27de634e30236b7e15d12e982f39799fb8cc3a965b0b8471f0ea8fad11f58966cc01dbb2e9b6b42b3c4b40303e936b62222193277b760c5049b1b22a53111dd0fb50271bd0b7697c64530386c091fa6c2753c585ec5a887267d75e156c3c0941e5e712881328c5263cb3027190a589a0c9a450d8348f16e98f7e3de935b533617769475aaa497fc18d0e4cc2ff9f4d82c3445880e4eb8d1dfe5774d44357c94c1c73c308fba30f5b0cb09038f989fd314c575e643f8a157d118a6baf01a8a888cc63da0c03e51f18cb03fa3055cc1ee9c007cfe9efa2a0edb1d0ac44b3f7d80f87838614e027f85da727785745a271de4ecaeeb8de3b686b9d80c7cb82d13c84d7e9c10e1a69f047eb64047f1461e0212481caf9eff59a6a3bae604bfb12cb288a7b5a2ce523c7ba66a0d83fea72a2b5ea40cfde913b667125feb5e8bc0df26541a8911c5512eb385035f7cda77e5534f74f9af29c373d188927400b06e9cb1e656658feac1a9c86a177445b4ce065a051b5f6baddfa48dbda3ea6e2f9b02349f04fcad5396672a2263de3922d0a59dbd0c596449f0530329b8b99cd517f1eb1fa2211ed356601f92361c8be127052ece356396d1ef053300f39e4bc8666e7028fe0e6def5d8fdd844c9c74a7530bf20862477d1e6c5f2d4dd05457be6f5290e412a503ba0ff13f9845a1b5918ed52da4329f951993dc7f9c72f25ad2bf26568e4017647efe8632c91b75be4195f68d34b7ec0b09c6460ecda998d89cae610cde81645c7a15a18f742cc671a6c065cd8463b63919bb2e11588c887fdd4dba74a51e09aa9fe6243a05b44a0e03be047083f80e4df386fbfc43b81dadc5504500ed2164b16145d1226013771ecbfd563207c5902494878a75e595cb72c23268d3103e7d961eaa460ab3d5a10cb4196572fc204b6d1a74f9f6b6bd1b83cbd9effe40092eec844ae857a42d49888ff6b2f6316f3b78b393516ff41d73abdf00caf3e56374bb2d3b7d420f060e2eba36427c5c0534377d7759927f3ec8cf23d2a3c4c8fc9a63b9e5a970db9ae381763ab7d507612bf3b93af55f2abd3cf5bb4b2bce6bebe9b361ca00b330ea839c8a8f67d44f9b4259f9a956aa76134cbcee71a490c1f5d77371367bc71ca41ed5b009d2055c13339a0fa697e456d124d4374d05bac091227879e8dabc390306f2f50d41905c3d4dd2804c32c074370227d73f66b728a08b22d4ffe122f2b133c4fe00c449dbe15041cf14088b5086860cd0af3b6e036c66095dd3a6519a837039222f108a59357601dfda6d9c1cdfe5ebb91dc4fd4fa21dbf0db47d5db79d7eeb9213d8610139abef0dd714fa5917dd93576ab4c2f539a31eb3f8a0fce5d7189af1a4499f29a0cd281845c046e20bdb7f981e5e418541bf1fe11f92f2d8f9c89cc0407cd9f6b70a048626ddbcddee1df07f3c3e8a28b354f63c26b0d68e8b34002bd3163f0f9b05024ede5a968e0468f81e42240ff3fc6708e276e534f61f4d853e25504cb522461019ec006d28e63420a5174d12ea7832b06a41396e22735485c90099123ae6a35ada86ed2a4cd8eae1f8199b443af320ab53d7778104670282c9cf3ac23bc662fb6897affa98d6cfbbc7b06c22b008ef116d24ab78ad74a1ddbcabb2219955be51433b1f1652e3266ef78df0b95c453b140036f652898e1c48dc118bb0a52dbbe80fd2c23793721b5b4bf1481404e7d788cb6b801707b024bc4a8ddd4566f1efbf449c67ab925a5c7823292d5b664ade0f71a0e200fa89be673f033192498d8ed06ad031fdf1059825c87b051487b98e11afe16afcbfd3f7b9311cfc091c2d8136880e64b74fa066919d4c1609600506a0dcf9f8e93e28984a4c5ec39e66cf591761a95c682f31b5753162c09320ad22f956563877f404f49183d0cd9f6ead6cfc0079b169f577200b2f3199397e6a78e39fbdcc84314ea0c896ea5d80f96e1aaa8f78055b91b945bc06a89b787847f6c96b398c5fee0d48246b544bba09363a97fc026d3f13e1df204174265566ce7fe5e3e02c25dd92426d49cc01890d5862cf7a2b9166ab55b0931c11c84d5f3521037dd612063b3224f01de5504daca23e3ec2e11060ea61ba0799575e9fcf492e9ad953633826fa8f6df8486ddc996d65686ab01fa8f63bb6dec4a8efc825bcc06b0d1c94eeddfaf2d2d47e72cab9862be3d5646aa278b7160a500b6acb03fc0bbc3576d14c379921fcbe74e9f6da531389a3c064d6e61b7ed844bbdd7b910500668e2523a10ef3c5920d71e7ca25d4978f1a4665f2bb5cbb34ea1b0289e5977adc48e855453ff4465d6ca5cef2a078adba0e4d67fc0e2cc33e7b4e5221fbeaf4e248d1ee0e98cb07a74de0d2590bd4f8a7a42beee91a9b517da19e39ebaed890cc8bcce092e6d8c5b55a16a68b6136da2277cae2dee9b9251e7666c9c5eb5d68f796dd679bc9619706696222a6de49443fedb0e9e356d419e5c00dfcf8ff384e1edd4c36cf31bd424dccdd87b35428b4a6b7fef6ccc6e8b84c2a9f0aed4b14949e842f8d8b8537c3492c237b84b1ee44499f1856fc3b43a573440532249fa918803c8e52602abd8a2fab73fac80dc966ef8ea7275c9754bfa891593b9eef2c567abb4282861135d934d4723d1471bad3f20b849d525727ec8bc685bc1852e25030ec1795075ea8fe9f9bcb6af6fdec4f6f7d31f738eba88ae3372968cfd825679b0b041e34b5e4420380f5fb1a13233bb04733dec54f40424d2a096bfa217537238f409dd07de3dfb196264c4ecdb181fabf27372a97b3689f001d4b0edbebb27ff47792ac4dcaa1d98928492aa1085822c9c2dfb7cc03ed5b1a4597861849f78d3e808b400f7843b798603e53abf958156c48c4c76423d24d3b1cee627f26fd30117ab948b2d37c25f6f0a68dcedb86a56d25317889b4d0c590a4e5d54759b66da4b7bcb5c55b93c8619765dcdb93f4cacc61ea508a8b7ddfabff3bac8d0d64956ae7dd4015dbceec85d3efb8adca8b6638872946f72b9e718f953b650766ea7ceba74f58994e8925c40520f8131a2d546e8e7668bbf0214ad629d7dda68ab9ecaf3f55d16c37f374b482b30864d789dcc1e1c0b2ec600e2eba763414d1ed6cce0678948316c69d6cbd16c9c766c42a1ac25fe97635c9e5e4ffad6e3af72ab5f81818c1167915d681309d8ec513cd61f02286ef3ade1234d8b3f729c61e06e93fd7eaaa780de784bec5a763148bed118eeabedd773531af8097509cbbbed0413113651f620118b158a4ec4672b023354c503e5aba6b636ecbd29cde7e2de182ed591e69c577f92c2c8aab7cf53516179f3812a1cb7d889cf953c216f624d749ae4cf978c5ee1c0e4457d4e93b7f167f0c9c2fef8242cfa57aff44737bc13f24a51f5a71d6032f31b108520ee1ac9278828732d0436563baf1ce34923d7b464ef934f90236f3c6957fbae45833e625cdfd0666ff41272dfa4f9b120b7c9ccb481ccad145cf153f281eccbdf0d4bbc06a9579ac78a16014bb18d9338f44152d9b154adbe44d11bc451f2bfab54a12adc119c9cfa5d32735170f8b7ea10960012642694a3fec6e546620a75300b22ce2a5e560aea431b550826196ba5d41d3810507861e01cfe5e6419c67b5f096d64a2537bb7743f1b47d5ae1e311cdca761199f9b873d82522716254a47c92477afa65ad827a55fd92b482362c49969ee2ed00729468ff3c42cb63d1ae18377fc7b56f1ac19973d2b70db4aeaea90bbc2c3068489e9c95233a8155a9d3493c7e31548350a39a1b7a84ed06e459cf97028a36fc657a5cfdfb9120945ae56c8bbb788077f6e36b1879dfd8ec0d15762af7567c2fe398ba2b104e574e6577d389cc6183a75e75075995ec8a8cf4e31fefe3f43eed0e50577c49bf1d36b0ef8b2119517caa0ebd701d0e9f311a86db1d90ff249fc40a5317556ee9f81105b059c3d854323e429f71a96f5e1b54d9ce531f86349140f92cb66dd72dd9c07156bf7afe06831d42628dca7380ad8738b18843c56d374ee8b24e95e85a4a3484ede323294e4abee3834316859592e1c9db2cdb2153c741508c19fc9ed2a333f4acf9059663df35ee0e622a25cf457971863de7add9c4db3fc7e5276c9504950805ee9b5d7529fcc60490251adaedda0080010141c7a4442beae6f32c9a0b901861e82a156437a604b6d62344ea1afd3e334b56f9663931528c35f5c5ee2b7b95b9e9e7bb71e6d778fc7be245917a2351062c7bf37b4193b639ea8236378e3c5838777d66880e746712a815538ac89463d10fe24c7ed60aac5a6ea68345392ad0c9dc91ff98a31841af9e80ee4e95b6cd721ec6b1a124e49ee4cf0de120e3a9706a7f6d0e35c3e77af4ca717d5da5149cc3a607e748a95e0fea052c59ba4fe9e606afc269c7003dba429ef7aefdb26f0d31f202629569d88f7df5eb747aa350dcfe49d2108ad51bfb33b3fbaa14486409594fa5640f5b36d0baee122f8e4e0efd913f288438da82c16d8569297a762f349db666eb00cc5e6eb861cec1a5a042c222003a6a6129046ff7ba9ac958716aa206e0d882acec62ca0ad44b3d513c0362a669cbeae0ac07b6813f927149ffdb4feba592ae5c6c9bb1edd2fc10929f41c7202f00bfb2575547c15f2213da1c62d5d47e1591c0ffbfc52144386573d819b504a7312c413774c755fa74a54f8b858b4accef679774f92a6b9a340d23c6b0fccb4017d4e632ec60e1db769098450e50956ce95d2c77acfd84659a9cdc7a3485c66c24dad125ac2062d50cd9ea2bbaeeef627b16ab21d328b9b75981df0003eec2afb7a48b9b0bf12cf23b3a7dcb404057781822e28c56471cfa8dd4810e9de5df0e4739d7a60d221a7d8b1fb4bcf5adbd119578583f718a78cbd9a62a9455bb935bb4fd4541647447c6f60c693e31db81205b208869ebfdd8a0d2587a39f9b1f40bc291b3647fd65ae9d6c654079e67652f29d11d57488e1bf0bdbb510846f0417dd2b062dae92af94a944806d29f403dcb1b998d205bf21abb5d4e93c919cc3aba572073e75b3eb74112c7ac38681c0e2dca810aeafad16a7dc59649cf39c2f0ded1eab37a1817b632f18a6e8762502019bf20ed4d6b5f79806c3379dafdcaf8c990dae682aaf77b204dc07d3932067bf5bab754870e6e8184f799f57dfb99c9c1f7a40a15e48a4e585921b931c682fea7e29ce9897b463efd0c41866e480a6730e4ad8b127f182d5371e9915c3e897f8b3c2bbe8712163318b54b3d7a24519f48134adfd2aa8c70cecb998955f7b6e12252ed9048ee5e14065605499b0c08b6ad40db07e9f3f773148523d0c75bb690add3f5652c2ccd427d707570fc1935c660197cf89a910192efa22de8e92a54526ee1ec5f8062a30b0eff06505bf75d9c048c58ac1a9e41c2e653d486044fdebaf49d8e60c98497249115a35e57be311abd9f3a325ac52884150af2787c281d950e19339f6cde88237b21b530fea56706bf63c43196b7b8d902570b51322afb2a842bd691e3a6616b27750d4ccb140e7239e883b5a71ab1e471d56e21c5738efb64bbb05e0095aa38b259d41c1c9411fb4e53aee022e991b75eaa484db5a77e0d04c0501df4339d473921bbdc9cc21a5e0b29e4ffbe6b9a89835dfa7c84cb3bd544e2c31513fa62617688b75f665915249883b97dcc05fd4456b520b919b2f5a562b4a7acb3e7a65cf3f57119bb4a289cc2d5d0e91501ffefbfebae8db56248de4676c65d75a6c3daa6e45243fafa073c52c4e2b4441a138ca7a036beaf9943477f1fedb9d2aa41e28b3567838eea69dc33d7a0a50156d4bfe62121806a0b4b991c30b321fc98d4472d4bcfbacc67ff46e530b4378cfcdd3e75ea597dd7ee0f73d0574a03d6632e59737b733760e63733b32b0cb4a6fd6bd8e5a7e91975e80677b08ff3f9a5f9010085a2fbe6b8eb4a55cf916e84ed5c30ac71f2b756acf5b386a2b27aa8027505b52219113c8b9bbabbd946db7d398e3e57a5e2afa04796c3630eb928e10ce71719e820973639824fa1d37757cf417a24fdc049df8cebaf1e0e0539513e1806145a4079582fc0312b5f6ecb0181a375bb4ffbe194c371a0658643f49df1a0103a1ffdfd2cf2f30d3fab8ce0ce1365958d6cce40ef3ad95cfb33027bb3fd1cd0f51d33b2454e9ec7cb7a67b899a08bce6490b247a33c2f54f6940eb65c8db940383f5e42372e3bbacbae14395c067c227f790117bc68e480e3f786c1498ec71c3bd179434e0d65390d1e71c32b7db8b3149ba4a718bfd3476bc4d1aa6d1e41cdbbc53ab9b6af858f51dbab5e4abf6f72569b6ce01f98672995d16f42f2d3f3ebfb60594b6f32c009eff2b76412d86809f6f0ca50f1116074c9a68d72cb36d0416448beeb7b3c8337b18bb6a3ebf51c8f3cdb8a3f12a34e88dd4c7ec431e7697d2b04ac18fd607aed5bda8014f2154da00d8faa1395fdcabeb91bb07d6948773a55491a05c29e14d3b095110151d7c3f9093b1e0371176b002ba2b4a3b9679c9e83ec024ed85e5a5ef861b118caebfc6d42a69bae887f20e9a6f73d148ade9522770e28e1ee4740b011031c00b4478769b680fd207c4552b9f8018c2ae1b71a624900717f69c17a7615ae47ba3e69d9e8f02dd658aa0b72f2975d6ac9dc64c4ecd5ba2df50bf7d0a79ceb1ede02bcabaeb5c60f77af03aaca497a5ea58a8c3779d269aa47d6c8d93e6bcd2c825efdc0b1539dabd0f2c1842e6f8d1f52327c16de73626404c7f5485390b1a635097993da7339cc55c56a26453b1c6f7b285af3cadee5487395387177bfae42ce12c3af8fd98a17d076f92bd5816ea96390503c884232dacfa8404ae11dc7ea04cf7d43bfe1cd9c48757e7e67534a6abe52abb4dd36fc42a8ff51772ab635e5ef32c4ea29699b4940bc0aa9261a799c4a9e882599bd3043961b34bcf4c5092865bbf5cf9bf375638fb8c59aabcba768c30f8fcfcf56d71f52e3e941eeb62d98233c53b2af85e00ff8d61a2eec3692ba4bf72fcaf78dd5c823a5488ee1042df78ab672f666e224e44b17d18a7e0431c8ea3b7ff29eb8683dfb72f53a71138aa3648480379a6b03607c6096c89205f42cadc868ea757efb216099103455d5e85373654c708cb4cba7534279c4fb356667c5ba2fdd58a2c4e59adbb174b0ab726dac57bc0df6f0d9fc349b5100ce20e7c199ab68a0d09eec9241f728ec21be10d25d6daba716c7e7e09a980ddca1ce02fbe45abeee51a2a9f3ea9c6fbd5846ce4a8eb106d077e7ebcc98ccd5a85adf98f6f6dad56c4fd069ef71abff0d0f2cf1c480aa2007ab2739b02d25aa2d43073a747ada9b22ce4d4ea7ff0117b3338e3ef8e883dc26f1cd2050b0b4a5dc9d4f44ceee34a38022b232cd5fa4c8ebac01a60c3097e2cc633cf6688e29756257d78f43633c85fff76480ee8756b65efc684add1b3b5d458d45fedbea4f4516a40f9c2e8cc4e9fbd82e0080727ca4b4150249b8009dc4d75b6fe6cf7571d11fc6b5cf1a5d6347461b3ce54f10808caee60181e34e61b8adc697654c381377f075d55d1f9cc3adcce13a2c149125fb806dcdbe44d222c986f0cadbc4d990a494623938e8bddc36860816b54a2ab67ec13b947bb8433027599a568fed599e7f874daad02260f7193cc56ab59a50f84c14fe6e91cb58eda7665371d1e1d00545076d25ddc5b0e7927957914179d684fc45f0aa105a089c2893ee58cd0d6673cba49a4d4818e13ee0cca272d8687d218543d1bbfec4ac37a98a7b26b34df7856b44342addcea9b1087276a065f2fe7958c3989e7f34d6dc4d3689c119c54c3f2bedc0dde16dd36ab44c3114c4d03b01feeb9666a699a12a2527f0834f89aa92daebde681bf86d21b2f76103a61efe7308e747f176a593be2fc4935d10f3dc686004c355ff974146779a8883cde3596437c4f3f1d54591d207a8f41357005b9dc1fd27da6c783adb315c48efd5e77ce39ca95dfa2c9b3756da3d053dabad542036e4123276df24191a64a17497ab9be515a4e242ace49ca3fc4b31140a8791ee2e1706f56a22b8347652d0186387937c169947d94d328e6841557f01ff7421095a4ed0b2d69c416deb6c2595b8c5eefff48c1c1fa847e0da642b9459ce159548664aa9d1d6813590b90a3fbb5dfcf53a233eedd76fbe7d746bda8c2247cd380544483b930967407de1f1c5f2873fdb6075e8ab40278b02ba03bf2a21ef96e24b6d424f50b445fd978d600812ab3ea97387d7295ba8a5e63f1acbb352f0a4a365b5880602889e76bd6d88c11ae3b432f4601db8a7372d75497f0908dbc8d0730e7a042ab69af3ae4dfeec48700d3daf1d6b8f69f42cb4810168229ac7082a7509ba2629ecaed642add4187f4cdb24de38a8b6635d4641756ae7143292217fe02fcb2e64c79cfef7ce586a7a3ed7f6da04e8a23457ae841c6a659e9373cf761cff11d5a2beb38b18d056a9fb1ddaafc197a64a3bad25b207cfda5590026acec8fea2140767f32c57b9c5303bdcc3178d9d9e3ac829199eac74ae3d9eb77580f504fcb08fbb446fe9093f7c2d0ab8dd0f3311f37e8feda634f66848d733cc4d4ccdac6c87a07a37c5ef268bcb470237f7fc6b1ed7a00f55319659a8bff7d32a0f660049a32774fbb13fa42e7d8b8d85bc504e17ee794431205e0b7bda1d150f9c420472b3aed6c21297d4ec607ff4ea691acc8b84b748282fbf8627e487d2f88fe386708c63234305a366adcb135c441a8a90fbd50bf183c745b56f58fee9e081b22ba64883ac0d4f272941cc7b285b45689c7d192734fe4c9122f87e326ee4f5088fffc5315a75fda782cbad02db35c1864eae29364b1f1a27306b17272b95128f96a344db3934d91afbdb98efcf2dcb52f7a66d2c6658c6276e330d11bc5a52ff7ed859f31ebc4cc966941f23c498db4ee1d492f7ae441480281b61754b11439602d2b1f526a2a95875762b2cefe9761fa70b2021dfbcaae68d7770279a3b1b4abc51f15f3257fb6e7084f9f9fc9981fab90ca5dab7df2ce7a186cc5edf55c47eb453fdad073ad4da6e83eb05767b4e78aa2b08d6b6ec10e183efe00334c81f4b8a882c5399eff82100fa2593f68d0916e2af076fb8949f924ab31530610bbf3db3e07124edabbb0bdd61cb8ab2c430414455ad7ca386725b76ad6de1ab571c86afab3a7393dd34ba7f6723880ffa9302807bcabaa3f912c7e091fba4a992d41c8583b9760d925fab47ace0052bb067f2eee1e10235f788710cd579b859a0dd39be26290d3b539c939e321949fe80358e325f7b2118b3050019d90a4647adf4f53795a8baa16fe5a58c8336264f821f3016aed3b957f4d0db688adda7774eca2baecb1e404adc7038f2cf07b23542fb3febb01e70ae4cb1faa8d1d7c9a4b397c44a32eeb8d435533906d7d24bfcc3a1ddbc58bb84d9056936bdbe8251348e312040bbbd605bd35008d166be6e865fbe2db15068184920a4aad2ae4b520dc3f75bbb6df01612f495a15058d35b196d43656c97b9079fae042e215e6cf2bdb623219fbf3513468865f2a6d13fe8685617a189cd451c080a7023ac239db6dae4834fa4a6a0c189af3e5c497d6e23c88b267b73a314fa42c17b332cabc25e9b1a41183c1b29d107b087e9363023ebeb0c5c1c1d8dc38cbdc318c6bfc5725c26670e872127283624b149a498d6067ab636028b29a5b5a325e6c3cb7d5ac762ac8638826f6ec519effd9ca51a9c5416314c3db4f4751c3a31396fa4d5aaf579e6abb64f61f75f4a373060c4b1f63ce8735167a4961ab0bef7aaa75da8a09bbaeec56f6459044da0fb47e911d7b141860824e0028b60d677e2f5eb1de0be491f1e911750a7c5d3a41b663ea47761bd7bfd0206d207f9b1d4ef8fa7d745dc92efe9efd8d52a999e67acef6a46a8785734c02ad8c5f6d5ff513966efaa49bd79b0d83c3417908298ab66cabf135e835348f3f806b01b76e8fb80c3ff598b79d755e7cfab9d8607fc6b40e0cb3bfd80d08ee6d4db16e8c6e4e81b670e4ae8a09dda095bbd8fb4d18dc1bc8d1d7c55ad0b52ddac57feb7625e67261c0d02630887ca1452fbbe19a414aa08effc7f040cf4766863e66c077f09f2af1c6037bf239f5f299f755d1053cac8f44b1cb32939f04c98db81ca6c9efbbcb19e6ab7363ee8cd4e2a79f7fa1b675f579dcb55ebe3952eeaa8da1fdca5261f229dd458eb4a5f266afb858f6951f2f7627319153792d70dc1f50d101d6df1123af8fbec152419c57cb433bc0fb0b35b9b907647a86c6ae632b2325a47fc41c1cfb96b8fb88a10de07b1cce1d3dd19cb099b4c99b9d34b6cadc48e29f4f0af6e5257af7c039a00f191eedd16f938441fb2a0c3c4f392ef6ce6f051222192a3d0d8cc48ea79fc60ddbc27d7ac08eefa9c83fa7156efe6d0c6a794008dffc66fcaf644ddb7736e7428953859e8a56acfe97f0d66dd94ec67274780a4574d5ac327da55cedb782d41db28770aa9d31c8a0dfe2eac12919d623537eeeb168deac9e26ee2ed67324afb87284dfbc0e4465cdd61d2d88151315591eef09cb6c71823b9ea0b84c27002580647dc5c29e0e5d9414c2eba1e3b089052b2eae8a0e7223a4f319dcc0006e99d0918eed1d782438b9fff876f0a64fb413078bfdf895d6d07236bbf455c5bb288c8986ab66a7a97bdda84836bca2949f6facdb5eab64aeee01bb27f8afd18841bd623b6cced86b7cf296d1681df2792d0c779b3351b0768b5d6f6931b9f9c67f1fd525d84941bd37369e7ff75035e19b821da309ed462a4a84ebe959008760d08bf102e2fb4dd7b719e0fb193fbb478c3f283d9c683395d806c9af75a8a16073fd9bd8ad7c1988857f82e5160df5f0afbd88c44c5d236783190de2c458aa0d827bb39a7ba6c2b03598d3e3c8c1b504ad859f3dd1f652eef823b6691846769650ea94bf70947b3f960c61273211026ac9825bc23dc16fb99eb6e088ae415fa830d709b30efafa205bd263b6d9664c353f11964109c8b30e14d6555360353335286d17ed6b7967d092e820f2a707898477132f6ec0e020a6afffc658384e81c92aaf858171b31fef7f81cc13e1d495bc193ce3c400ad26d58e0c6405afc981491e972638cd0702239cd8005f698213b5ea674960855faccab9ef4c164a42f3ced9bbc362f5c5f6ffd2bdb159a98d059845ec67a2ef756426e0d58d16fe96ef4caa4c89853b9ddcc70fd8c4a63967ffb20f87502a14bd7a6562a771347d90d509020a30624e8c22b04cf7ebd0d08e4ec9939403eea44328a9820e2727f42e131a083bc16549d6632ba3d7e47cba1db17f8e5ffcc928f0930aef11c27601704c2fcfdaaa15b5f32de75feee89c0d413a062182c310d98cd61b7ebb101f0b54b0961d406c595117fbefd35415ca8b4f03311f75e71ba03474bf1091b5c335e14b125a52ec283fa568b465c5414fa2a89280573447d3cf8b285cbe9ed9df83dfa14de8b34d5fb85e8c2c1d663d3924462ccb30de3fb909fe3faf6f949b0861c9f04819f003fa3cb898c3ac52a467c8ce6657c90e3f4697e8ecd1e903654d4ba70151d2632794fb6f1ec2354eef9b5fcc019329902b21d9f1943d62cc5ac21f57e3e83e9032038db71f44bb852295235608b7ee21758060c048e3d936eedaa4c8782969c30f33e1a6268f693a8db1746f5f4fda7f8cf97c6d9b8755c454a4c3624eb2af5f7b1a6c6fe5a0dc0521132fd2822badba1548a429380eeb64351e9783d79acb50dbb90dcb85e0070b1de3fc22743293b5531b56527a927b298481664a052a6c9ef27f0f1cd6bedf11029bb61c2548126ba68e9e70408260dbd5ad0b741a24131b5123c954f7be01cd5c0be05eb26a676f7508ef3031217eccd47e91464a471757e34d87cd586524733c1dcbc329c3d5799e85dcce06a8254cf096a8eaf5774139f49e4703a3db2f56965fddcb215ccbc9ccc8f5e0491c87f306fe3251f66ef92ea1c16330e8671c2f142b3c16bf3cbba984883e305eb0ac6572e42ad5176cde0446028e9b4aafaf46493e06315b6cbd47a05d765f02b9536e2ab767e3b264bf80eaa0a168037cb21ed99dee84c47cb32abc96671824d4c1031c3dca3aac624e9ffce121f52096cf8fec03299123a5c96ecdf84ba986c3d4a42974f99208fad5db423c0e4f30e3c7fcb2d2f94dce5d3ad3e136b8a8e7a4d5ff0feb6d89c52342134196fb8b6885ecd58b3411ce5a4feaa513c6a673599819577a7f7778b3d089b34ffb2b64d7f93ad0bc6529d163e98500c10e1c83fde315a6b9063b67fadbbafa172b63f53ce62d09fd04ffb9cdd9bd85311fdfa0fe475ef7d3e4245362d7a2adb3d1d8abbfd7c5862acbb6793850fde66e78b8589b34224187aacb3d91c9367d416e309462a8de10e3e0f44acb21a58401db22c75781c2d268ebb08ab172895f543565d682cc5dca80070de0a59e39922680c0e586db883fddcd5de803c06f4a5695bc6540d1739c50529a2ea49656b61fbb45921dcc4d9213e9d6f4aee3f3bb780e42447cbc9ee1cbbb3b577e4a4fb8d51c725d3c77f536578f45ec584fdf765468bcf1586151288f989ac4a7e66c762b404c8f40faf3ec4fe7fdb1f339dabb33842a2a21cac35559edb74879d1e59d737bf83988c5069ec223c3b2c328d15bf1173471dc0ad5ee0e03ce5afbf2eaf0fdf59dbbda6e28ff0de167bc1d40801111fd3534b386c61a0e46833393e80797cf90ae832e7a1878441a355af4fbdf44e0a5806f711883f9f9ed6b52e9a4784235916566268229d39e70bc587e75599c96501a75f7c0feb2ada4cb81e77e888c9d9770d22897d1398134685c197cbaf42c4c9f760c2abd3272b1544db9c1343cd09747f890bdb0ab4cd45e5d056a71a353f60cded0bafdd59527ae2197c0be17afd78d8c175a14f637bac69b04652381a7965f73f332e864460a829e3283e529c159d5458e8a55ca789a813fba69d919c1da7f542c47f143d535e103eda1a030e55fcbbd6a97c8fcef0229021ad2c0c0202123c3f4013df346e882042d74c018511b4d86a64191aad05222fd636b80de27fce61300c8bcfdf5ce6d6c9bd282b4d36055713d77133fc12c2be3f1dd5c5d10f710b1db7e4af12aa4879fe3e0c5541d9494eefa27ae53c5fd7dbc02a96a56404f823950f87d3d51ef5eae99491d13478f1edc2a19fa65ef53fa21542a7e2aca58a2d04c7505be509dac6a2b89c7fecf41083e361b3483cc76c957ac627076932dff35f9d0cfcd32422a77ae64fbbd73ae1180e7e33658168399dabcfaf81bfe224ff1617c830106390a110703b551eec16e62bd08dec8dc9a68bc265d0f52f43ab1d59ea1641c805c89d5b7addfb00d5b0176a37d6067c382ec2cdfa11032d214d6a10445299aa0781de6505e45a0eaee3fefca97e68d600ef66da0a68c1c7d4838fe358c744e564420ace3e3c267d6d3a3e54068e5cd09b82b8829732b57bf5c35f1d9c5c383bda58fd5cb8a8e7177bc3e8e486d5c46c7e67660b4658f7595cd44f476842350dfd7200305c3ff1c08c17b999a22fe3afc232c60369834ad885e670c81b53eda46c72f061475ab3480c3455fcc846bb20599698aac3f2381a48e366dc61d72e6534987cd70447707877360c15e26d7480d4fc0d15c9913f1bc21080d2cae56bab7df8e5d0bfd4e1436f512a4dfe0007c1899bce6cee347ad5c130fb0f75b566eadd0cfedbd50080096874c0dea3ec45dbea8d6233fc77ac8c7bfcec7d939f8558528e00523142a1a6831a8998a185d5200fbad238a49a3cfe95a9cd43d18b18aea4550d3a18ace42abbad6a2305904966a0feba298ab4a91c801b81d0de98acd22639b22063a6806a354b72f45aa3833e69855fa8679ea4f8f78332fc08ce9c8fa221dd6a03b3f0a5c2b15fb50785086d3ee4d1b7b210866d27d2cab55854b8232029bee0e2c1ffe1792e7c58a89d4b2ad5859319296a431022f49e868aeb27679a3ddf02d1235717c1cb40b8a9f0e7a5cc9d5857ed16ca494af63e3e15c7b2ac59544d3012cd907c006d97d6c9645a31411c27a98ea7ccbbda40c86aa6986dc651a1f727d871276c8103230b9c1fcefd99d87753019cca8ce960162324394cd8f456432fafa393fb40008c496d4a478c5e1de24ceaa68ce8ec6856279921e4d5ac2eb2c0d92cbc389f9f39e281be9fcaa1627c0ee3663b75ef7b29aef7e5d3af720f3627a85326ea9235b1fc5b6fd982f5e84190976d6fb24d9892f600bf1fabef73415befb72a00013986f136f110a059f688b7c54c8f29c84b3edb13f260e97606f2501cc451d26ff4b93996ff6deb80effc851f640a4097440e60e45f2177227a44a44dc1a78abfab594afc0bf7ca52f03431fb7abde325f4085b89e83950aa441cd43999f48b847915b2a972fd81aad6cc5033b57d1ed90c9ef690e31e081c93902ad65fa78bdcfdba6fd64d166d5f0a8eba79973eebfaae1f30aa14c89e8fbd832c4c1b843786f452586b2fd508ff88ae866d40554d1c6fcd6b6b70ddd77f7a810b846912f4f41ded927d72f3077da617bb8f789bdcba331efc399eed75fb72000dc54ae90f4a722f025fd673880157551902316cd481406a2fb8b66911d8013aee7b385da43ac8c72950cd5af0106d8b34f8b624860cc248284721bba8309aa1d298b3e9fac173b708e342a094f519d4b6b41bcb56801479320507c571d296b0796d8208184bd58a97bf51efde246d55a1b5668652e0a58fc30b73839964360ebe743d480b1b4f38df95eed0219d261cc0dd2aa5b850cfbaacdfd01254b047df59d6b31c88f1b937a29682f47cced252759c15c7d24ef8ee2eeb14d53bc96e08fbd15a55ae0a9090c5bfdb876acca8ee0d62e5b26ceb8d7f81f8995494036e65180a3eac63b548403c764151758057ac388bfb77268d53b63fdd6a2ef1a486e3ce2fc7751823dc7f307a6e2a5344cab1243498b87f4357450ba27ca99539ce2148140a32440db3ffbea35bc95a2c307eb4cd8bfd4ad0d7887bd6b1761df50f63a23ddb4d03abc2cec30579d5588af26e42522f0d4f6fe69f5fe8c265225f40767a2f6d143e8fb00cf45b7f860313c78fac477ac2d499b1aa91970ffad6addc64958383b8a1c3114d509dc9d7d4c523418fc6f571b6b35218e48ed53f1efb4ba3bea34158313e2f2c495cd6babfffd30fba278427efe32f9d4589b5af85890845e880cfa37f0b8daac3d250f8cdc0b836f0484fdd3389bd0c7adcf961324c977aca08d286b56c933378015ddcd53df31b638bd08a26c7bcd585641b15b75143c9a26bcab38d22e910d13dfab6617b7f1e07747c00beb610fee1759a5651d4d8ef7c7ce2300445adbe7fa26c06cea6e0d70e8f1aaca79210df3fcfd5bbe16a9d78cdaef90d123fa891cc9748d5c1264b144e91ecce352318033f8b14da57bb752dcbde96e3cbd3b1f83d6a59bb57b4e97c25f0cc2158353e3d770ff54a0ca1b06425934c80ff1362ece73d7e0df796d4481403fa78d08a3e11d8db97d82db8a6dcdb15145ecfdfe36e4c09d62b477dd303d2221f2a497d60afb36bdfafc859133e415bb44ddd0963a5d56134281375c10b8169fb49f5255a6f2822aea9800cac594385ce4594f4ffb538b104370726a02ed902cd819993faee2e4e05878e0daa51a06503770124d1db68e199a97bbff9f2d5365b5a3f6b76e4fb31c564f0774ff0bdd98f9630f185086719e9ae20d38ca1b1b8a6867aebd05e7c2c973fdcef063e9e8bbf54b729bda54824e7ca814775039ecf126616bf02fa279417634d97d25735e8bf803219c72e49b85fe22e814ce4ab9d47afadb5fd229310e1945f7a8972235bb9a65588b43d209a815e1e51ec0ac4a841df94870010ac0713b5bfbbbd5a49118c62cda51edec6f23a279c46cbc25f1bcd7fff3ee795591d7aa8c4ed3963278b858b6a127e8f006f676d549d34d5fb1d16b32a147d66f6f324aa158ef81f84a369bbb1020a3e6cde789a6681089e8b9d5b8bf09d1d690a83da886e8ea4dcf1de2a1d12cad63602ad02a5a3ca03688dbbe1e0ccc38d9082a573c3debcb0f8239e5a51bfa13147703de8a5cda84f9421ad180971e491c5bc634cf54aa43e30ccd0a87890dea9899c9e20bf8ecac5fc1d5aaed254c2d9acd99d2ff48b16468758ee07822ab4601c8db5237e28e52d1d65f640451a4d848dec050c537ecb165f753221f622a8018d187ec15f00c11501336bd509123485bc789729efa1384fe092e067f05ddfcb7787cd0266e7d6d67770b5e2b73097c1261c1340d6cdb406d24758f26d66ec2fd0967b657d8a81284cd31b74054d0b58defa61c432ec5b481dc980627c207c03d4d318fdc131cb8a10abeae0b25fc728dc2be2816b979734e84ad996c4b15c28fd1b2b1e6b5de40c2d1040bac7f127ea40b5ebc9df8de52773268a598b5054e99b7e0a18f7f8672a003cc9553b3ef78a35466341b0c1190b6fb8bc17d993bace6cc3948eb61cab9f32f7e97cd12af95d5d43581b9707bd0ae685114de74a4993a6d49b4b8a63b2ebf47d21fb15fa5f6b4c8c7858c7928a2e96e5816ec647e737f4af1ec896494d55341dfa5a5c77d1fc9610774df29cb69f227d1b3483159bdaf3d36511de13d68e765881a5511ffe0376e3481cf8d0df965c001c6b9ebef9d93d383a39b2bae8a59fd7dbb45dc5140ddcf29d188a26a7fbb345e659b6c257181726a9495351cfee07b7ca71d123233aa3c112637d18c2d1b549c97aa225005b424fdd46c09a1952b1fe3a13233f63b86019fda810d03f1feb7aac732b7fcba07bc0140830aa6cd34647ca039c1ce8fcdfc6dae677176b32da852a8c9456401e0e02a8ce5b80bfbf926607f81611d877d40be3693f2bea250897d20e03449014326e103c8fadace2176bf9842f840221f393d72994333aec49cdc57e4e7dceb2e493ff6d4c75c9083b65300397f428136eabfa2b8ec7324e545974a2586d13f0cd6e64022173b903cf6d342c9ed0de24b67f7b65d5833ed456e197b665c69494bbaf655314cb37d89eda7e5aeb895c12fe885f9f6de95a1eeb34c1fb1b2eaaaf96f37ac3b13f6c7b3f6d12e59e4ecd85c382a848fa87d4bc0f5bdd4c206d66100d58e90100154f117c68bb01c7790dbb9bd664af40e589fc63239099004267fdb1e464fa49bc9746e16d1ab5fbac4132389e10b7c7fd3ed8985c037324adc570ad7c095eb23c4bb50cfd981e070ee0e180aa8add2cc43ecc138559079a85875abc39b37b04b5cc2d0c9c825cceac36aa1dc4ba29d5622e73fad810a499d8328da667a47b5b542601bb216015e4d5af3fc1c775302909f51a2c23b36981ea09ce6ff9e20b507673abd4c05b91a364b8660e345e6e38c739d08c4efeaad7dd2824a5768b0bbe384af9d4ccdb86f5eeac297c4e020455b95900270d57597746dba25c077e1815f31a02147722edc13301ea3722d89166aff3ca263997e3752261d51181d28c708a187d3e3bd30f813bf319034ef52c5fb57f93f1353c4bd18558e9a2d99e47b5c398213686f411667f1a030deafd07f335daf0742c2951c07f6235829b7c831fb2e0884f19f67636ccd03c3fbbb92690623e0496b5e598e1ec3ca4108078dd2bd33f875c2ccdab36d1e22d4dfc82a01ad0755b4c4512dee8b24feae993d54ec133fe090d4bf84cc6a0361520ae98dc2b97208f412dd6a11c91684ccc3f599d3a5d62cae8c9b59572cb4a0bb218318f7220f16acf0ad9c92969fb45f98ddf8ef1f77531fee4205414e1f1021d3eacfbeb6d94944e3fb912230430e3827d5fe172b68aaea553bf9542c73a678b368f06d6d68cf07dc31d1314199bf658eb1c9fa9da40f8300dd3fb9e519c00da3fcec8e66e80df4f2b5ced862f051574c0dcf22ec0f592f6e92916e1a67ae8d7452e0ce71fe627c9af880884578ab9c1926b3711f400c653f4e8f96168a796699ad3e25388288501ac46b82f0510a6da599432ffb1251ecf731eb85514e39b1688caa66b1980b1591cc79170106b4c7e35fa8e3a033608de39665f1323dcc97421d184648ad5a6d19a93b61f98a47c60a8d70d569fcc0b8f6db9c962354ec42ea155140eeff96087c52b6db07fd8ea5c5d9b952347bd3018ef26f9a20d8e2b7c3519bc79a2f61679a2c768fd532827e5debff557f2622775f54373cd71ab15591440b29b1ad07183fd7770fbebb3e4679edc225240505f90d68125c0b0cfd452c44f21780935b1f5ff14fa932caf1315aea34003aefecbf45818d219a48f4927ad9a393ff69462c4bfd67f6f39a4d343c5672a1582bfb96706dbaee6d0e0828877753affc96757279a81826d162dd9ba1eb7bd5c17afdf0edd3322e4d4653ec078e00f95982ec2cfc64e3e7f2fddcddf28a83254de702362e39eb1a5bc8a3b3d1d2b8f162e797b2f0fd7a6f7c34ab5117f123c888a88ddb1c36f469aed8946ab9b94df140dae647a7680c1e9156756d00c47908bb955e0c00eaa30e81ebc05ba7a3a87ecacdeea8b121a29e782bfd27fc410f30d474b79511b3f2341bfc8a485dd77c67b6a62bf6160e99b3fa00a446eea49ad73bc5f945fb389e9da6922fcce6649b99afc80a76daf25d25d1df12772e672e10ed51f5a1040235c6ad832b06289af94c5152b001214e54578affbb9700f2912ab03506227fba3d3a0c72db9ac501b54db58d19c58088e0eda4082778514706e912d1c8534bbeee085adc1b7b59b26d21b87f5d9eb2eb330b98a1efa81b267bef53672a6d664b91cc4ebf7fdbf490fa9c9f905f308f7ab5970d1d832362e20ec147e1d49bebf165296858714f8514b3d4dd1f42fff6446790e9d11cf3738b9110cf2cfa970601ce4cf4209f9ba3e2f708edc86eb35af4cfcaf7f79d6f25e1631e23f34ffc7eac1210bf9883336d5831507c797a851f7e3d1a330f51709291</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好, 这里需要密码.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">有东西被加密了, 请输入密码查看.</summary>
    
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/categories/Linux/"/>
    
    
    <category term="VPS" scheme="https://pawswrite.xyz/tags/VPS/"/>
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="科学上网" scheme="https://pawswrite.xyz/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
    <category term="Notes" scheme="https://pawswrite.xyz/tags/Notes/"/>
    
  </entry>
  
  <entry>
    <title>脚本生成仅允许cloudflare访问80 443端口的iptables规则</title>
    <link href="https://pawswrite.xyz/posts/10938.html"/>
    <id>https://pawswrite.xyz/posts/10938.html</id>
    <published>2022-06-28T06:29:18.000Z</published>
    <updated>2022-10-04T15:51:38.627Z</updated>
    
    <content type="html"><![CDATA[<p>Cloudflare是一家提供网站安全管理、性能优化等相关技术的跨国科技企业，Cloudflare可以帮助受保护站点抵御包括分布式拒绝服务攻击(DDoS, Distributed Denial of Service)在内的大多数网络攻击，确保该网站长期在线，阻止网络攻击、垃圾邮件等，同时提升网站的性能、访问速度以改善访客体验。Cloudflare提供用户免费使用，是防御DDos的最佳解决方案之一。</p><p>本文讲了如何用脚本设置防火墙 80 443 端口仅对Cloudflare CDN的IP开放。</p><blockquote><p>如果不懂iptables或者ip6tables的话最好别用，免得失联</p></blockquote><span id="more"></span><h1 id="说在前面"><a href="#说在前面" class="headerlink" title="说在前面"></a>说在前面</h1><ul><li>服务器。作者使用的是Ubuntu 20.04，关闭ufw</li><li>服务器已经配置iptables 【ip6tables可选】</li><li>实在失联了作者不负责</li><li>作者的服务器具有ipv4和ipv6，所以服务器已经配置iptables 和 ip6tables都是同步讲解，如果你只有其中一个，可以自行更改处理。</li></ul><ol><li><p>项目仓库地址<br><a href="https://github.com/tech-fever/cloudflare_ips_only_iptables">https://github.com/tech-fever/cloudflare_ips_only_iptables</a></p></li><li><p>原理<br>新建 iptables 链 CLOUDFLARE 并插入引用到 INPUT 的80 443 端口，对Cloudflare的ip采用的数据包控制方式是 RETURN，丢弃其他网络数据包。就是说如果Cloudflare的IP访问80 443，会先从CLOUDFLARE中匹配，匹配到以后就会返回INPUT链，所以需要之前INPUT链中就有对80 443端口的放行规则，如果之前没有，可以加入<code>iptables -A INPUT -p tcp -m multiport --dports http,https -j ACCEPT</code>，或者把所有的 <code>RETURN</code> 改成 <code>ACCEPT</code> 。如果非Cloudflare的IP访问80和443，在CLOUDFLARE中会匹配到最后两条规则，被记录并丢弃。</p></li><li><p>ip来源<br>脚本使用的所有ip来自Cloudflare官方给的api：</p></li></ol><ul><li><a href="https://www.cloudflare.com/ips-v4">https://www.cloudflare.com/ips-v4</a></li><li><a href="https://www.cloudflare.com/ips-v6">https://www.cloudflare.com/ips-v6</a></li></ul><ol start="4"><li>日志<br>日志文件保存在 <code>/var/log/messages</code> ，高版本默认没有这个文件，因为 <code>/etc/rsyslog.d/50-default.conf</code> 将其注释掉了，想看日志的话可以谷歌一下解决办法。<br>被DROP掉的连接会被记录，以下面两行开头：<br>对于ipv4： <code>IPTABLES_CLOUDFLARE_ONLY_BANNED: </code><br>对于ipv6： <code>IP6TABLES_CLOUDFLARE_ONLY_BANNED: </code></li></ol><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><ol><li>官方 <a href="https://developers.cloudflare.com/fundamentals/get-started/setup/allow-cloudflare-ip-addresses/">Allow Cloudflare IP addresses</a></li><li>论坛帖子 《<a href="https://hostloc.com/thread-1007211-1-1.html">小鸡iptables只允许cloudflareip</a>》</li></ol><h1 id="预处理【必须】"><a href="#预处理【必须】" class="headerlink" title="预处理【必须】"></a>预处理【必须】</h1><p>如果重启服务器，所有的规则都丢失了。所以要保存规则，使其持久化。安装iptables-persistent包：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install iptables-persistent<br></code></pre></td></tr></table></figure><p>为了防止你改出问题，先保存当前的iptables规则：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#保存规则</span><br><span class="hljs-comment"># mkdir -p /etc/iptables/</span><br>iptables-save &gt; /etc/iptables/rules.v4<br>ip6tables-save &gt; /etc/iptables/rules.v6<br></code></pre></td></tr></table></figure><p>查看规则编号。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># for ipv4</span><br>iptables -nvL --line-numbers<br><span class="hljs-comment"># for ipv6</span><br>ip6tables -nvL --line-numbers<br></code></pre></td></tr></table></figure><div class='note info'>在运行脚本之前先手动试试是否可行，如果出现问题可以随时reboot或强制断电重启，只要没有规则持久化（存入/etc/iptables/rules.v4 和 rules.v6 ），重启就会返回之前状态。</div><h1 id="iptables新建链【必须】"><a href="#iptables新建链【必须】" class="headerlink" title="iptables新建链【必须】"></a>iptables新建链【必须】</h1><p><font color='red'>只有ipv4的话直接跳到后面两节（不过这里有命令的详细解释）</font></p><p>创建一个链，命名为 CLOUDFLARE</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables -N CLOUDFLARE<br>ip6tables -N CLOUDFLARE<br></code></pre></td></tr></table></figure><p>让INPUT引用（<strong>下面两种选一种</strong>）<br>插入引用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 适合于已经有其他iptables规则，默认让CLOUDFLARE插入到第一行，优先其他规则生效</span><br>iptables  -I INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br>ip6tables -I INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br></code></pre></td></tr></table></figure><p>附加引用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># CLOUDFLARE，附加到最后一条，优先级最低</span><br>iptables  -A INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br>ip6tables -A INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br></code></pre></td></tr></table></figure><h1 id="命令行添加IP"><a href="#命令行添加IP" class="headerlink" title="命令行添加IP"></a>命令行添加IP</h1><p>然后把CF的IP加进链里</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v4`; <span class="hljs-keyword">do</span><br>        iptables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v6`; <span class="hljs-keyword">do</span><br>        ip6tables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><p>不允许其他</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 记录并丢弃网络数据包</span><br>iptables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IPTABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br>ip6tables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IP6TABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br><br>iptables -A CLOUDFLARE -j DROP<br>ip6tables -A CLOUDFLARE -j DROP<br></code></pre></td></tr></table></figure><h1 id="如果你只有ipv4"><a href="#如果你只有ipv4" class="headerlink" title="如果你只有ipv4"></a>如果你只有ipv4</h1><p>如果你只有ipv4但上面的你看不懂不会改，可以直接执行这里。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables -N CLOUDFLARE<br>iptables  -I INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v4`; <span class="hljs-keyword">do</span><br>        iptables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br>iptables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IPTABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br>iptables -A CLOUDFLARE -j DROP<br></code></pre></td></tr></table></figure><p>iptables持久化一定要做，不然重启就没了<br>比如ubuntu可以安装iptables-persistent，规则保存在(默认)&#x2F;etc&#x2F;iptables&#x2F;rules.v4<br>centos不知道，好像自带吧，执行service iptables save</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo apt install iptables-persistent<br>iptables-save &gt; /etc/iptables/rules.v4<br></code></pre></td></tr></table></figure><h1 id="脚本时间"><a href="#脚本时间" class="headerlink" title="脚本时间"></a>脚本时间</h1><h2 id="创建规则脚本"><a href="#创建规则脚本" class="headerlink" title="创建规则脚本"></a>创建规则脚本</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># !/bin/bash</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Configure your iptables to allow IPs from Cloudflare only.</span><br><span class="hljs-comment"># For users whose HTTP server is directly exposed to the host 80/443.</span><br><br>iptables -N CLOUDFLARE<br>ip6tables -N CLOUDFLARE<br><br><span class="hljs-comment"># 可以换成 -A</span><br>iptables  -I INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br>ip6tables -I INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v4`; <span class="hljs-keyword">do</span><br>        iptables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v6`; <span class="hljs-keyword">do</span><br>        ip6tables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br><br>iptables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IPTABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br>ip6tables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IP6TABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br><br>iptables -A CLOUDFLARE -j DROP<br>ip6tables -A CLOUDFLARE -j DROP<br></code></pre></td></tr></table></figure><h2 id="更新脚本"><a href="#更新脚本" class="headerlink" title="更新脚本"></a>更新脚本</h2><p>这里带ipv4和ipv6：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/bash</span><br><br><span class="hljs-comment">#先删掉&quot;不允许所有&quot;，避免在下面命令执行期间GG</span><br>iptables -D CLOUDFLARE -j DROP<br>ip6tables -D CLOUDFLARE -j DROP<br><br><span class="hljs-comment">#清除规则(旧的CF IP)</span><br>iptables -F CLOUDFLARE<br>ip6tables -F CLOUDFLARE<br><span class="hljs-comment">#添加CF IP，下面可以对curl的结果做一次判断，可以避免网络问题可能出现的问题，自己写</span><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v4`; <span class="hljs-keyword">do</span><br>        iptables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br><br><span class="hljs-keyword">for</span> ip <span class="hljs-keyword">in</span> `curl https://www.cloudflare.com/ips-v6`; <span class="hljs-keyword">do</span><br>        ip6tables -A CLOUDFLARE -s <span class="hljs-variable">$ip</span> -j RETURN;<br><span class="hljs-keyword">done</span><br><br><span class="hljs-comment"># 自己判断是否要保存，个人觉得可以手动执行脚本，之后看要不要保存</span><br><span class="hljs-comment">#mkdir -p /etc/iptables/</span><br><span class="hljs-comment"># iptables-save &gt; /etc/iptables/rules.v4</span><br><span class="hljs-comment"># ip6tables-save &gt; /etc/iptables/rules.v6</span><br><br><span class="hljs-comment"># 记录并禁用其他IP</span><br>iptables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IPTABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br>ip6tables -A CLOUDFLARE -j LOG --log-prefix <span class="hljs-string">&quot;IP6TABLES_CLOUDFLARE_ONLY_BANNED: &quot;</span><br><br>iptables -A CLOUDFLARE -j DROP<br>ip6tables -A CLOUDFLARE -j DROP<br></code></pre></td></tr></table></figure><h2 id="清除规则脚本【包售后】"><a href="#清除规则脚本【包售后】" class="headerlink" title="清除规则脚本【包售后】"></a>清除规则脚本【包售后】</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables  -F CLOUDFLARE<br>ip6tables -F CLOUDFLARE<br>iptables  -D INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br>ip6tables -D INPUT -p tcp -m multiport --dports http,https -j CLOUDFLARE<br>iptables  -X CLOUDFLARE<br>ip6tables -X CLOUDFLARE<br><span class="hljs-comment"># 删除保存的规则并存入最新的（自己判断要不要去掉注释）</span><br><span class="hljs-comment">#&gt; /etc/iptables/rules.v4</span><br><span class="hljs-comment">#&gt; /etc/iptables/rules.v6</span><br><span class="hljs-comment"># iptables-save &gt; /etc/iptables/rules.v4</span><br><span class="hljs-comment"># ip6tables-save &gt; /etc/iptables/rules.v6</span><br></code></pre></td></tr></table></figure><h1 id="测试【重要】"><a href="#测试【重要】" class="headerlink" title="测试【重要】"></a>测试【重要】</h1><p>先看看网页能不能用域名正常访问。<br>使用下面命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -k -v 你的IP<br></code></pre></td></tr></table></figure><p>出现类似下面报错：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@host2:~<span class="hljs-comment"># curl -k -v `curl -4 ip.sb`</span><br>*   Trying 你的IP:80...<br>* connect to 你的IP port 80 failed: Connection timed out<br>* Failed to connect to 你的IP port 80: Connection timed out<br>* Closing connection 0<br>curl: (28) Failed to connect to 你的IP port 80: Connection timed out<br></code></pre></td></tr></table></figure><p>说明成功！</p><h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h2 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#保存规则</span><br><span class="hljs-comment"># mkdir -p /etc/iptables/</span><br>iptables-save &gt; /etc/iptables/rules.v4<br>ip6tables-save &gt; /etc/iptables/rules.v6<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#引用规则</span><br>iptables-restore &lt; /etc/iptables/rules.v4<br>ip6tables-restore &lt; /etc/iptables/rules.v6<br></code></pre></td></tr></table></figure><h2 id="iptables和ip6tables仅开放22-80-443-端口和ping"><a href="#iptables和ip6tables仅开放22-80-443-端口和ping" class="headerlink" title="iptables和ip6tables仅开放22 80 443 端口和ping"></a>iptables和ip6tables仅开放22 80 443 端口和ping</h2><p>前提是安装iptables-persistent</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">apt install -y iptables-persistent<br></code></pre></td></tr></table></figure><div class='note info'>直接修改/etc/iptables/rules.v4 v6 文件的时候如果不保留别的规则，会导致别的规则丢失！比如docker的和ufw的和fail2ban的。有时候可以通过重启解决。</div><h3 id="iptables白名单-22-80-443-端口和允许ping"><a href="#iptables白名单-22-80-443-端口和允许ping" class="headerlink" title="iptables白名单 22 80 443 端口和允许ping"></a>iptables白名单 22 80 443 端口和允许ping</h3><p>编辑<code>/etc/iptables/rules.v4</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">*filter<br><br><span class="hljs-comment">#  Allow all loopback (lo0) traffic and drop all traffic to 127/8 that doesn&#x27;t use lo0</span><br>-A INPUT -i lo -j ACCEPT<br>-A INPUT ! -i lo -d 127.0.0.0/8 -j REJECT<br><br><span class="hljs-comment">#  Accept all established inbound connections</span><br>-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT<br><br><span class="hljs-comment">#  Allow all outbound traffic - you can modify this to only allow certain traffic</span><br>-A OUTPUT -j ACCEPT<br><br><span class="hljs-comment">#  Allow HTTP and HTTPS connections from anywhere (the normal ports for websites and SSL).</span><br>-A INPUT -p tcp --dport 80 -j ACCEPT<br>-A INPUT -p tcp --dport 443 -j ACCEPT<br><br><span class="hljs-comment">#  Allow SSH connections</span><br><span class="hljs-comment">#  The -dport number should be the same port number you set in sshd_config</span><br>-A INPUT -p tcp -m state --state NEW --dport 22 -j ACCEPT<br><br><span class="hljs-comment">#  Allow ping</span><br>-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT<br><br><span class="hljs-comment">#  Log iptables denied calls</span><br>-A INPUT -m <span class="hljs-built_in">limit</span> --<span class="hljs-built_in">limit</span> 5/min -j LOG --log-prefix <span class="hljs-string">&quot;iptables denied: &quot;</span> --log-level 7<br><br><span class="hljs-comment">#  Reject all other inbound - default deny unless explicitly allowed policy</span><br>-A INPUT -j REJECT<br>-A FORWARD -j REJECT<br><br>COMMIT<br></code></pre></td></tr></table></figure><p>持久化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">iptables-restore &lt; /etc/iptables/rules.v4<br></code></pre></td></tr></table></figure><h3 id="ip6tables白名单-22-80-443-端口和允许ping"><a href="#ip6tables白名单-22-80-443-端口和允许ping" class="headerlink" title="ip6tables白名单 22 80 443 端口和允许ping"></a>ip6tables白名单 22 80 443 端口和允许ping</h3><p>编辑<code>/etc/iptables/rules.v6</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">*filter<br><br><span class="hljs-comment">#  Allow all loopback (lo0) traffic and drop all traffic to 127/8 that doesn&#x27;t use lo0</span><br>-A INPUT -i lo -j ACCEPT<br>-A INPUT ! -i lo -d ::1/128 -j REJECT<br><br><span class="hljs-comment">#  Accept all established inbound connections</span><br>-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT<br><br><span class="hljs-comment">#  Allow all outbound traffic - you can modify this to only allow certain traffic</span><br>-A OUTPUT -j ACCEPT<br><br><span class="hljs-comment">#  Allow HTTP and HTTPS connections from anywhere (the normal ports for websites and SSL).</span><br>-A INPUT -p tcp --dport 80 -j ACCEPT<br>-A INPUT -p tcp --dport 443 -j ACCEPT<br><br><span class="hljs-comment">#  Allow SSH connections</span><br><span class="hljs-comment">#  The -dport number should be the same port number you set in sshd_config</span><br>-A INPUT -p tcp -m state --state NEW --dport 22 -j ACCEPT<br><br><span class="hljs-comment">#  Allow ping</span><br>-A INPUT -p icmpv6 -j ACCEPT<br><br><span class="hljs-comment">#  Log iptables denied calls</span><br>-A INPUT -m <span class="hljs-built_in">limit</span> --<span class="hljs-built_in">limit</span> 5/min -j LOG --log-prefix <span class="hljs-string">&quot;iptables denied: &quot;</span> --log-level 7<br><br><span class="hljs-comment">#  Reject all other inbound - default deny unless explicitly allowed policy</span><br>-A INPUT -j REJECT<br>-A FORWARD -j REJECT<br><br>COMMIT<br></code></pre></td></tr></table></figure><p>持久化</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ip6tables-save &gt; /etc/iptables/rules.v6<br></code></pre></td></tr></table></figure><h2 id="其他运维规则脚本"><a href="#其他运维规则脚本" class="headerlink" title="其他运维规则脚本"></a>其他运维规则脚本</h2><blockquote><p><a href="https://hostloc.com/forum.php?mod=viewthread&tid=1007102&highlight=%E8%A7%84%E5%88%99">仅允许cloudflare ip访问nginx的规则的生成脚本</a><br><a href="https://pawswrite.xyz/2022/06/15/Restoring-original-visitor-IPs-From-CLoudFlare/">使用脚本编写Nginx规则恢复CloudFlare原始访问者 IP</a></p></blockquote><p>其他参考（还没看，做个记录）：<br><a href="https://github.com/drvy/ufw-cloudflare">https://github.com/drvy/ufw-cloudflare</a><br><a href="https://github.com/kingcc/cloudflare-ips-only">https://github.com/kingcc/cloudflare-ips-only</a></p>]]></content>
    
    
    <summary type="html">&lt;p&gt;Cloudflare是一家提供网站安全管理、性能优化等相关技术的跨国科技企业，Cloudflare可以帮助受保护站点抵御包括分布式拒绝服务攻击(DDoS, Distributed Denial of Service)在内的大多数网络攻击，确保该网站长期在线，阻止网络攻击、垃圾邮件等，同时提升网站的性能、访问速度以改善访客体验。Cloudflare提供用户免费使用，是防御DDos的最佳解决方案之一。&lt;/p&gt;
&lt;p&gt;本文讲了如何用脚本设置防火墙 80 443 端口仅对Cloudflare CDN的IP开放。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;如果不懂iptables或者ip6tables的话最好别用，免得失联&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Linux" scheme="https://pawswrite.xyz/categories/Linux/"/>
    
    
    <category term="VPS" scheme="https://pawswrite.xyz/tags/VPS/"/>
    
    <category term="Linux" scheme="https://pawswrite.xyz/tags/Linux/"/>
    
    <category term="长毛象运维" scheme="https://pawswrite.xyz/tags/%E9%95%BF%E6%AF%9B%E8%B1%A1%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
</feed>
